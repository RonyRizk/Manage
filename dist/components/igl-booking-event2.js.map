{"file":"igl-booking-event2.js","mappings":"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","names":["moment","BookingService"],"sources":["src/utils/booking.ts","src/services/events.service.ts","src/components/igloo-calendar/igl-booking-event/igl-booking-event.css?tag=igl-booking-event&encapsulation=scoped","src/components/igloo-calendar/igl-booking-event/igl-booking-event.tsx"],"sourcesContent":["import moment from 'moment';\r\nimport { PhysicalRoomType, MonthType, CellType, STATUS, RoomBookingDetails, RoomBlockDetails } from '../models/IBooking';\r\nimport { dateDifference, isBlockUnit } from './utils';\r\nimport axios from 'axios';\r\nimport locales from '@/stores/locales.store';\r\nimport calendar_data from '@/stores/calendar-data';\r\n\r\nexport async function getMyBookings(months: MonthType[]): Promise<any[]> {\r\n  const myBookings: any[] = [];\r\n  const stayStatus = await getStayStatus();\r\n  for (const month of months) {\r\n    for (const day of month.days) {\r\n      for (const room of day.room_types) {\r\n        assignBooking(room.physicalrooms, myBookings, stayStatus);\r\n      }\r\n    }\r\n  }\r\n\r\n  return myBookings;\r\n}\r\n\r\nfunction assignBooking(physicalRoom: PhysicalRoomType[], myBookings: any[], stayStatus: { code: string; value: string }[]): void {\r\n  for (const room of physicalRoom) {\r\n    for (const key in room.calendar_cell) {\r\n      if (room.calendar_cell[key].Is_Available === false) {\r\n        addOrUpdateBooking(room.calendar_cell[key], myBookings, stayStatus);\r\n      }\r\n    }\r\n  }\r\n}\r\nconst status: Record<string, STATUS> = {\r\n  '004': 'BLOCKED',\r\n  '003': 'BLOCKED-WITH-DATES',\r\n  '002': 'BLOCKED',\r\n};\r\nexport const bookingStatus: Record<string, STATUS> = {\r\n  '000': 'IN-HOUSE',\r\n  '001': 'PENDING-CONFIRMATION',\r\n  '002': 'CONFIRMED',\r\n  '003': 'CHECKED-OUT',\r\n};\r\n\r\nexport function formatName(firstName: string | null, lastName: string | null) {\r\n  if (firstName === null && lastName === null) return '';\r\n  if (lastName !== null) {\r\n    return `${firstName ?? ''} , ${lastName ?? ''}`;\r\n  }\r\n  return firstName;\r\n}\r\nasync function getStayStatus() {\r\n  try {\r\n    const token = calendar_data.token;\r\n    if (token) {\r\n      const { data } = await axios.post(`/Get_Setup_Entries_By_TBL_NAME_Multi?Ticket=${token}`, {\r\n        TBL_NAMES: ['_STAY_STATUS'],\r\n      });\r\n      return data.My_Result.map(d => ({\r\n        code: d.CODE_NAME,\r\n        value: d.CODE_VALUE_EN,\r\n      }));\r\n    } else {\r\n      throw new Error('Invalid Token');\r\n    }\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n}\r\nfunction renderBlock003Date(date, hour, minute) {\r\n  const dt = new Date(date);\r\n  dt.setHours(hour);\r\n  dt.setMinutes(minute);\r\n  return `${locales.entries.Lcz_BlockedTill} ${moment(dt).format('MMM DD, HH:mm')}`;\r\n}\r\nfunction getDefaultData(cell: CellType, stayStatus: { code: string; value: string }[]): any {\r\n  if (isBlockUnit(cell.STAY_STATUS_CODE)) {\r\n    return {\r\n      ID: cell.POOL,\r\n      NOTES: '',\r\n      BALANCE: '',\r\n      NAME:\r\n        cell.My_Block_Info.NOTES !== ''\r\n          ? cell.My_Block_Info.NOTES\r\n          : cell.STAY_STATUS_CODE === '003'\r\n          ? renderBlock003Date(cell.My_Block_Info.BLOCKED_TILL_DATE, cell.My_Block_Info.BLOCKED_TILL_HOUR, cell.My_Block_Info.BLOCKED_TILL_MINUTE)\r\n          : stayStatus.find(st => st.code === cell.STAY_STATUS_CODE).value || '',\r\n      RELEASE_AFTER_HOURS: cell.My_Block_Info.DESCRIPTION,\r\n      PR_ID: cell.My_Block_Info.pr_id,\r\n      ENTRY_DATE: cell.My_Block_Info.BLOCKED_TILL_DATE,\r\n      ENTRY_HOUR: cell.My_Block_Info.BLOCKED_TILL_HOUR,\r\n      ENTRY_MINUTE: cell.My_Block_Info.BLOCKED_TILL_MINUTE,\r\n      OPTIONAL_REASON: cell.My_Block_Info.NOTES,\r\n      FROM_DATE: cell.DATE,\r\n      TO_DATE: cell.DATE,\r\n      NO_OF_DAYS: 1,\r\n      STATUS: status[cell.STAY_STATUS_CODE],\r\n      POOL: cell.POOL,\r\n      STATUS_CODE: cell.STAY_STATUS_CODE,\r\n      OUT_OF_SERVICE: cell.STAY_STATUS_CODE === '004',\r\n      FROM_DATE_STR: cell.My_Block_Info.format.from_date,\r\n      TO_DATE_STR: cell.My_Block_Info.format.to_date,\r\n    };\r\n  }\r\n  //console.log('booking', cell);\r\n  return {\r\n    ID: cell.POOL,\r\n    TO_DATE: cell.DATE,\r\n    FROM_DATE: cell.DATE,\r\n    NO_OF_DAYS: 1,\r\n    STATUS: bookingStatus[cell.booking?.status.code],\r\n    NAME: formatName(cell.room.guest.first_name, cell.room.guest.last_name),\r\n    IDENTIFIER: cell.room.identifier,\r\n    PR_ID: cell.pr_id,\r\n    POOL: cell.POOL,\r\n    BOOKING_NUMBER: cell.booking.booking_nbr,\r\n    NOTES: cell.booking.remark,\r\n    is_direct: cell.booking.is_direct,\r\n    BALANCE: cell.booking.financial?.due_amount,\r\n    channel_booking_nbr: cell.booking.channel_booking_nbr,\r\n    ///from here\r\n    //ENTRY_DATE: cell.booking.booked_on.date,\r\n    // IS_EDITABLE: cell.booking.is_editable,\r\n    // ARRIVAL: cell.booking.arrival,\r\n    // PHONE: cell.booking.guest.mobile ?? '',\r\n    // RATE: cell.room.total,\r\n    // RATE_PLAN: cell.room.rateplan.name,\r\n    // SPLIT_BOOKING: false,\r\n    // RATE_PLAN_ID: cell.room.rateplan.id,\r\n    // RATE_TYPE: 1,\r\n    // ADULTS_COUNT: cell.room.occupancy.adult_nbr,\r\n    // CHILDREN_COUNT: cell.room.occupancy.children_nbr,\r\n    // origin: cell.booking.origin,\r\n    // GUEST: cell.booking.guest,\r\n    // ROOMS: cell.booking.rooms,\r\n    // cancelation: cell.room.rateplan.cancelation,\r\n    // guarantee: cell.room.rateplan.guarantee,\r\n    // TOTAL_PRICE: cell.room.total,\r\n    // COUNTRY: cell.booking.guest.country_id,\r\n    // FROM_DATE_STR: cell.booking.format.from_date,\r\n    // TO_DATE_STR: cell.booking.format.to_date,\r\n    // adult_child_offering: cell.room.rateplan.selected_variation.adult_child_offering,\r\n    // SOURCE: { code: cell.booking.source.code, description: cell.booking.source.description, tag: cell.booking.source.tag },\r\n  };\r\n}\r\n\r\nfunction updateBookingWithStayData(data: any, cell: CellType): any {\r\n  data.NO_OF_DAYS = dateDifference(data.FROM_DATE, cell.DATE);\r\n  data.TO_DATE = cell.DATE;\r\n  if (cell.booking) {\r\n    const { arrival } = cell.booking;\r\n    Object.assign(data, {\r\n      ARRIVAL_TIME: arrival.description,\r\n    });\r\n  }\r\n  return data;\r\n}\r\n\r\nfunction addOrUpdateBooking(cell: CellType, myBookings: any[], stayStatus: { code: string; value: string }[]): void {\r\n  const index = myBookings.findIndex(booking => booking.POOL === cell.POOL);\r\n\r\n  if (index === -1) {\r\n    const newData = getDefaultData(cell, stayStatus);\r\n    myBookings.push(newData);\r\n  } else {\r\n    const updatedData = updateBookingWithStayData(myBookings[index], cell);\r\n    myBookings[index] = updatedData;\r\n  }\r\n}\r\nexport function transformNewBooking(data: any): RoomBookingDetails[] {\r\n  let bookings: RoomBookingDetails[] = [];\r\n  //console.log(data);\r\n  const renderStatus = room => {\r\n    const now = moment();\r\n    const toDate = moment(room.to_date, 'YYYY-MM-DD');\r\n    const fromDate = moment(room.from_date, 'YYYY-MM-DD');\r\n\r\n    if (fromDate.isSame(now, 'day') && now.hour() >= 12) {\r\n      return bookingStatus['000'];\r\n    } else if (now.isAfter(fromDate, 'day') && now.isBefore(toDate, 'day')) {\r\n      return bookingStatus['000'];\r\n    } else if (toDate.isSame(now, 'day') && now.hour() < 12) {\r\n      return bookingStatus['000'];\r\n    } else if ((toDate.isSame(now, 'day') && now.hour() >= 12) || toDate.isBefore(now, 'day')) {\r\n      return bookingStatus['003'];\r\n    } else {\r\n      return bookingStatus[data?.status.code || '001'];\r\n    }\r\n    // if (toDate.isBefore(now, 'day') || (toDate.isSame(now, 'day') && now.hour() >= 12)) {\r\n    //   return bookingStatus['003'];\r\n    // } else {\r\n    //   return bookingStatus[fromDate.isSameOrBefore(now, 'day') ? '000' : data?.status.code || '001'];\r\n    // }\r\n  };\r\n  const rooms = data.rooms.filter(room => !!room['assigned_units_pool']);\r\n  rooms.forEach(room => {\r\n    bookings.push({\r\n      ID: room['assigned_units_pool'],\r\n      TO_DATE: room.to_date,\r\n      FROM_DATE: room.from_date,\r\n      NO_OF_DAYS: room.days.length,\r\n      ARRIVAL: data.arrival,\r\n      IS_EDITABLE: true,\r\n      BALANCE: data.financial?.due_amount,\r\n      STATUS: renderStatus(room),\r\n      NAME: formatName(room.guest.first_name, room.guest.last_name),\r\n      PHONE: data.guest.mobile ?? '',\r\n      ENTRY_DATE: '12-12-2023',\r\n      RATE: room.total,\r\n      RATE_PLAN: room.rateplan.name,\r\n      SPLIT_BOOKING: false,\r\n      RATE_PLAN_ID: room.rateplan.id,\r\n      IDENTIFIER: room.identifier,\r\n      RATE_TYPE: room.roomtype.id,\r\n      ADULTS_COUNT: room.occupancy.adult_nbr,\r\n      CHILDREN_COUNT: room.occupancy.children_nbr,\r\n      PR_ID: +room.unit.id,\r\n      POOL: room['assigned_units_pool'],\r\n      GUEST: data.guest,\r\n      ROOMS: data.rooms,\r\n      BOOKING_NUMBER: data.booking_nbr,\r\n      cancelation: room.rateplan.cancelation,\r\n      guarantee: room.rateplan.guarantee,\r\n      TOTAL_PRICE: room.total,\r\n      COUNTRY: data.guest.country_id,\r\n      FROM_DATE_STR: data.format.from_date,\r\n      TO_DATE_STR: data.format.to_date,\r\n      adult_child_offering: room.rateplan.selected_variation.adult_child_offering,\r\n      ARRIVAL_TIME: data.arrival.description,\r\n      origin: data.origin,\r\n      channel_booking_nbr: data.channel_booking_nbr,\r\n      is_direct: data.is_direct,\r\n      NOTES: data.remark,\r\n      SOURCE: { code: data.source.code, description: data.source.description, tag: data.source.tag },\r\n    });\r\n  });\r\n\r\n  return bookings;\r\n}\r\nexport async function transformNewBLockedRooms(data: any): Promise<RoomBlockDetails> {\r\n  const stayStatus = await getStayStatus();\r\n  return {\r\n    ID: data.POOL,\r\n    NOTES: '',\r\n    BALANCE: '',\r\n    NAME:\r\n      data.NOTES !== ''\r\n        ? data.NOTES\r\n        : data.STAY_STATUS_CODE === '003'\r\n        ? renderBlock003Date(data.BLOCKED_TILL_DATE, data.BLOCKED_TILL_HOUR, data.BLOCKED_TILL_MINUTE)\r\n        : stayStatus.find(st => st.code === data.STAY_STATUS_CODE).value || '',\r\n    RELEASE_AFTER_HOURS: data.DESCRIPTION,\r\n    PR_ID: data.pr_id,\r\n    ENTRY_DATE: data.BLOCKED_TILL_DATE,\r\n    ENTRY_HOUR: data.BLOCKED_TILL_HOUR,\r\n    ENTRY_MINUTE: data.BLOCKED_TILL_MINUTE,\r\n    OPTIONAL_REASON: data.NOTES,\r\n    FROM_DATE: data.from_date,\r\n    TO_DATE: data.to_date,\r\n    NO_OF_DAYS: calculateDaysBetweenDates(data.from_date, data.to_date),\r\n    STATUS: status[data.STAY_STATUS_CODE],\r\n    POOL: data.POOL,\r\n    STATUS_CODE: data.STAY_STATUS_CODE,\r\n    OUT_OF_SERVICE: data.STAY_STATUS_CODE === '004',\r\n    FROM_DATE_STR: data.format.from_date,\r\n    TO_DATE_STR: data.format.to_date,\r\n  };\r\n}\r\nexport function calculateDaysBetweenDates(from_date: string, to_date: string) {\r\n  const startDate = moment(from_date, 'YYYY-MM-DD');\r\n  const endDate = moment(to_date, 'YYYY-MM-DD');\r\n  const daysDiff = endDate.diff(startDate, 'days');\r\n  return daysDiff;\r\n}\r\n","import axios from 'axios';\r\nimport { BookingService } from './booking.service';\r\nimport { getReleaseHoursString } from '../utils/utils';\r\nimport { Token } from '@/models/Token';\r\n\r\nexport class EventsService extends Token {\r\n  private readonly bookingService: BookingService = new BookingService();\r\n\r\n  async reallocateEvent(pool: string, destination_pr_id: number, from_date: string, to_date: string) {\r\n    try {\r\n      const token = this.getToken();\r\n      if (token) {\r\n        console.log(pool, destination_pr_id, from_date, to_date);\r\n        const { data } = await axios.post(`/ReAllocate_Exposed_Room?Ticket=${token}`, { pool, destination_pr_id, from_date, to_date });\r\n        if (data.ExceptionMsg !== '') {\r\n          throw new Error(data.ExceptionMsg);\r\n        }\r\n        console.log(data);\r\n        return data;\r\n      } else {\r\n        throw new Error('Invalid Token');\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  public async deleteEvent(POOL: string) {\r\n    try {\r\n      const token = this.getToken();\r\n      if (token) {\r\n        const { data } = await axios.post(`/UnBlock_Exposed_Unit?Ticket=${token}`, {\r\n          POOL,\r\n        });\r\n        if (data.ExceptionMsg !== '') {\r\n          throw new Error(data.ExceptionMsg);\r\n        }\r\n        return data.My_Result;\r\n      } else {\r\n        throw new Error('Invalid Token');\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n\r\n  public async updateBlockedEvent(bookingEvent: any) {\r\n    try {\r\n      const token = this.getToken();\r\n      if (token) {\r\n        const releaseData = getReleaseHoursString(+bookingEvent.RELEASE_AFTER_HOURS);\r\n        await this.deleteEvent(bookingEvent.POOL);\r\n        const result = await this.bookingService.blockUnit({\r\n          from_date: this.formatDate(bookingEvent.FROM_DATE),\r\n          to_date: this.formatDate(bookingEvent.TO_DATE),\r\n          pr_id: bookingEvent.PR_ID,\r\n          STAY_STATUS_CODE: bookingEvent.OUT_OF_SERVICE ? '004' : bookingEvent.RELEASE_AFTER_HOURS === 0 ? '002' : '003',\r\n          DESCRIPTION: bookingEvent.RELEASE_AFTER_HOURS || '',\r\n          NOTES: bookingEvent.OPTIONAL_REASON || '',\r\n          ...releaseData,\r\n        });\r\n        return result;\r\n      } else {\r\n        throw new Error('Invalid Token');\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  private formatDate(date: string) {\r\n    return date.split('/').join('-');\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n  position: absolute;\r\n}\r\n\r\n.bookingEventBase {\r\n  position: absolute;\r\n  background-color: rgb(49, 190, 241);\r\n  width: 100%;\r\n  height: 100%;\r\n  transform: skewX(-22deg);\r\n}\r\n\r\n.bookingEventHiddenBase {\r\n  position: absolute;\r\n  top: 0;\r\n  left: -4px;\r\n  width: calc(100% + 8);\r\n}\r\n\r\n.bookingEventDragHandle {\r\n  position: absolute;\r\n  top: 0;\r\n  width: 15px;\r\n  height: 100%;\r\n  opacity: 0.1;\r\n  background-color: rgba(0, 0, 0, 0.15);\r\n  transform: skewX(-22deg);\r\n  /* display: none; */\r\n  cursor: pointer;\r\n}\r\n\r\n.splitBooking {\r\n  border-right: 2px solid #000000;\r\n}\r\n\r\n:host:hover .bookingEventDragHandle {\r\n  display: block;\r\n  opacity: 1;\r\n}\r\n\r\n:host.newEvent:hover .bookingEventDragHandle {\r\n  display: none;\r\n  opacity: 1;\r\n}\r\n\r\n.leftSide {\r\n  left: 0;\r\n}\r\n\r\n.rightSide {\r\n  right: 0;\r\n}\r\n\r\n.bookingEventTitle {\r\n  color: #fff;\r\n  font-size: 0.8em;\r\n  position: relative;\r\n  max-width: calc(100% - 10px);\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  top: 2px;\r\n  left: 5px;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n\r\n.legend_circle {\r\n  border-radius: 100%;\r\n  width: 10px;\r\n  height: 10px;\r\n  margin: 3px 3px 3px 2px;\r\n  border: 1px solid #fff;\r\n}\r\n\r\n.noteIcon {\r\n  position: absolute;\r\n  bottom: -8px;\r\n  left: 2px;\r\n}\r\n\r\n.balanceIcon {\r\n  position: absolute;\r\n  top: -8px;\r\n  right: 2px;\r\n}\r\n","import { Component, Element, Event, EventEmitter, Fragment, Host, Listen, Prop, State, h } from '@stencil/core';\r\nimport { BookingService } from '@/services/booking.service';\r\nimport { transformNewBooking } from '@/utils/booking';\r\nimport { isBlockUnit } from '@/utils/utils';\r\nimport { IReallocationPayload, IRoomNightsData } from '@/models/property-types';\r\nimport moment from 'moment';\r\nimport { IToast } from '@components/ir-toast/toast';\r\nimport { EventsService } from '@/services/events.service';\r\nimport locales from '@/stores/locales.store';\r\nimport calendar_data from '@/stores/calendar-data';\r\n\r\n@Component({\r\n  tag: 'igl-booking-event',\r\n  styleUrl: 'igl-booking-event.css',\r\n  scoped: true,\r\n})\r\nexport class IglBookingEvent {\r\n  @Element() private element: HTMLElement;\r\n\r\n  @Prop() currency;\r\n  @Prop() is_vacation_rental: boolean = false;\r\n  @Prop() language: string;\r\n  @Prop({ mutable: true }) bookingEvent: { [key: string]: any };\r\n  @Prop() allBookingEvents: { [key: string]: any } = [];\r\n  @Prop() countryNodeList;\r\n\r\n  @Event({ bubbles: true, composed: true }) hideBubbleInfo: EventEmitter;\r\n  @Event() updateEventData: EventEmitter;\r\n  @Event() dragOverEventData: EventEmitter;\r\n  @Event() showRoomNightsDialog: EventEmitter<IRoomNightsData>;\r\n  @Event() showDialog: EventEmitter<IReallocationPayload>;\r\n  @Event() resetStreachedBooking: EventEmitter<string>;\r\n  @Event() toast: EventEmitter<IToast>;\r\n\r\n  @State() renderElement: boolean = false;\r\n  @State() position: { [key: string]: any };\r\n  @State() isShrinking: boolean | null = null;\r\n\r\n  dayWidth: number = 0;\r\n  eventSpace: number = 8;\r\n\r\n  vertSpace: number = 10;\r\n\r\n  /* show bubble */\r\n  private showInfoPopup: boolean = false;\r\n  private bubbleInfoTopSide: boolean = false;\r\n  private isStreatch = false;\r\n  /*Services */\r\n  private eventsService = new EventsService();\r\n  private bookingService = new BookingService();\r\n  /* Resize props */\r\n  resizeSide: string = '';\r\n  isDragging: boolean = false;\r\n  initialX: number;\r\n  initialY: number;\r\n  currentX: number;\r\n  currentY: number;\r\n  initialWidth: number;\r\n  initialLeft: number;\r\n  finalWidth: number;\r\n  dragInitPos: { [key: string]: any };\r\n  dragEndPos: { [key: string]: any };\r\n  elementRect: { [key: string]: any };\r\n  isTouchStart: boolean;\r\n  moveDiffereneX: number;\r\n  moveDiffereneY: number;\r\n  private animationFrameId: number | null = null;\r\n\r\n  handleMouseMoveBind = this.handleMouseMove.bind(this);\r\n  handleMouseUpBind = this.handleMouseUp.bind(this);\r\n  handleClickOutsideBind = this.handleClickOutside.bind(this);\r\n\r\n  componentWillLoad() {\r\n    this.bookingService.setToken(calendar_data.token);\r\n    this.eventsService.setToken(calendar_data.token);\r\n\r\n    window.addEventListener('click', this.handleClickOutsideBind);\r\n  }\r\n\r\n  async fetchAndAssignBookingData() {\r\n    try {\r\n      console.log('clicked on book#', this.bookingEvent.BOOKING_NUMBER);\r\n      if (['IN-HOUSE', 'CONFIRMED', 'PENDING-CONFIRMATION', 'CHECKED-OUT'].includes(this.bookingEvent.STATUS)) {\r\n        const data = await this.bookingService.getExposedBooking(this.bookingEvent.BOOKING_NUMBER, 'en');\r\n        let dataForTransformation = data.rooms.filter(d => d['assigned_units_pool'] === this.bookingEvent.ID);\r\n        data.rooms = dataForTransformation;\r\n        if (data.rooms.length === 0) {\r\n          throw new Error(`\"booking#${this.bookingEvent.BOOKING_NUMBER} have empty array\"`);\r\n        } else {\r\n          if (data.rooms.some(r => r['assigned_units_pool'] === null)) {\r\n            throw new Error(`\"booking#${this.bookingEvent.BOOKING_NUMBER} have empty pool\"`);\r\n          }\r\n        }\r\n        const { ID, TO_DATE, FROM_DATE, NO_OF_DAYS, STATUS, NAME, IDENTIFIER, PR_ID, POOL, BOOKING_NUMBER, NOTES, is_direct, BALANCE, ...others } = transformNewBooking(data)[0];\r\n\r\n        this.bookingEvent = { ...this.bookingEvent, ...others };\r\n        this.showEventInfo(true);\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n  componentDidLoad() {\r\n    if (this.isNewEvent()) {\r\n      if (!this.bookingEvent.hideBubble) {\r\n        /* auto matically open the popup, calling the method shows bubble either top or bottom based on available space. */\r\n        setTimeout(async () => {\r\n          if (['003', '002', '004'].includes(this.bookingEvent.STATUS_CODE)) {\r\n            this.showEventInfo(true);\r\n          } else if (['IN-HOUSE', 'CONFIRMED', 'PENDING-CONFIRMATION', 'CHECKED-OUT'].includes(this.bookingEvent.STATUS)) {\r\n            await this.fetchAndAssignBookingData();\r\n          } else {\r\n            this.showEventInfo(true);\r\n          }\r\n          this.renderAgain();\r\n        }, 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    window.removeEventListener('click', this.handleClickOutsideBind);\r\n    if (this.animationFrameId) {\r\n      cancelAnimationFrame(this.animationFrameId);\r\n    }\r\n  }\r\n\r\n  @Listen('click', { target: 'window' })\r\n  handleClickOutside(event: Event) {\r\n    const clickedElement = event.target as HTMLElement;\r\n    // Check if the clicked element is not within the target div\r\n    if (!this.element.contains(clickedElement)) {\r\n      // The click occurred outside the target div\r\n      this.showEventInfo(false);\r\n    }\r\n  }\r\n\r\n  @Listen('hideBubbleInfo', { target: 'window' })\r\n  hideBubbleInfoPopup(event: CustomEvent) {\r\n    if (event.detail.currentInfoBubbleId != this.getBookingId() || (event.detail.key === 'hidebubble' && event.detail.currentInfoBubbleId === this.getBookingId())) {\r\n      this.showInfoPopup = false;\r\n      this.renderAgain();\r\n    }\r\n  }\r\n\r\n  @Listen('moveBookingTo', { target: 'window' })\r\n  async moveBookingToHandler(event: CustomEvent) {\r\n    try {\r\n      if (event.detail.bookingId !== this.getBookingId()) {\r\n        this.showEventInfo(false);\r\n        return;\r\n      }\r\n\r\n      if (event.detail.moveToDay === 'revert' || event.detail.toRoomId === 'revert') {\r\n        event.detail.moveToDay = this.bookingEvent.FROM_DATE;\r\n        event.detail.toRoomId = event.detail.fromRoomId;\r\n        if (this.isTouchStart && this.moveDiffereneX <= 5 && this.moveDiffereneY <= 5 && !this.isStreatch) {\r\n          if (isBlockUnit(this.bookingEvent.STATUS_CODE)) {\r\n            this.showEventInfo(true);\r\n          } else if (['IN-HOUSE', 'CONFIRMED', 'PENDING-CONFIRMATION', 'CHECKED-OUT'].includes(this.bookingEvent.STATUS)) {\r\n            await this.fetchAndAssignBookingData();\r\n          }\r\n        } else {\r\n          this.animationFrameId = requestAnimationFrame(() => {\r\n            this.resetBookingToInitialPosition();\r\n          });\r\n        }\r\n      } else {\r\n        if (this.isTouchStart && this.moveDiffereneX <= 5 && this.moveDiffereneY <= 5 && !this.isStreatch) {\r\n          if (isBlockUnit(this.bookingEvent.STATUS_CODE)) {\r\n            this.showEventInfo(true);\r\n          } else if (['IN-HOUSE', 'CONFIRMED', 'PENDING-CONFIRMATION', 'CHECKED-OUT'].includes(this.bookingEvent.STATUS)) {\r\n            await this.fetchAndAssignBookingData();\r\n          }\r\n        } else {\r\n          const { pool, to_date, from_date, toRoomId } = event.detail as any;\r\n          if (pool) {\r\n            if (isBlockUnit(this.bookingEvent.STATUS_CODE)) {\r\n              await this.eventsService.reallocateEvent(pool, toRoomId, from_date, to_date).catch(() => {\r\n                this.resetBookingToInitialPosition();\r\n              });\r\n            } else {\r\n              if (this.isShrinking || !this.isStreatch) {\r\n                const { description, status } = this.setModalDescription(toRoomId, from_date, to_date);\r\n                let hideConfirmButton = false;\r\n                if (status === '400') {\r\n                  hideConfirmButton = true;\r\n                }\r\n                this.showDialog.emit({ ...event.detail, description, title: '', hideConfirmButton });\r\n              } else {\r\n                if (this.checkIfSlotOccupied(toRoomId, from_date, to_date)) {\r\n                  this.animationFrameId = requestAnimationFrame(() => {\r\n                    this.resetBookingToInitialPosition();\r\n                  });\r\n                  throw new Error('Overlapping Dates');\r\n                } else {\r\n                  this.showRoomNightsDialog.emit({ bookingNumber: this.bookingEvent.BOOKING_NUMBER, identifier: this.bookingEvent.IDENTIFIER, to_date, pool, from_date });\r\n                }\r\n              }\r\n            }\r\n            this.isShrinking = null;\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      this.toast.emit({\r\n        position: 'top-right',\r\n        title: error.message,\r\n        description: '',\r\n        type: 'error',\r\n      });\r\n      console.log('something went wrong');\r\n    }\r\n  }\r\n  private setModalDescription(toRoomId: number, from_date, to_date): { status: '200' | '400'; description: string } {\r\n    const findRoomType = (roomId: number) => {\r\n      let roomType = this.bookingEvent.roomsInfo.filter(room => room.physicalrooms.some(r => r.id === +roomId));\r\n      if (roomType.length) {\r\n        return roomType[0].id;\r\n      }\r\n      return null;\r\n    };\r\n    if (!this.bookingEvent.is_direct) {\r\n      if (this.isShrinking) {\r\n        return {\r\n          description: `${locales.entries.Lcz_YouWillLoseFutureUpdates}.`,\r\n          status: '200',\r\n        };\r\n      } else {\r\n        if (\r\n          moment(from_date, 'YYYY-MM-DD').isSame(moment(this.bookingEvent.FROM_DATE, 'YYYY-MM-DD')) &&\r\n          moment(to_date, 'YYYY-MM-DD').isSame(moment(this.bookingEvent.TO_DATE, 'YYYY-MM-DD'))\r\n        ) {\r\n          const initialRT = findRoomType(this.bookingEvent.PR_ID);\r\n          const targetRT = findRoomType(toRoomId);\r\n          if (initialRT === targetRT) {\r\n            return { description: `${locales.entries.Lcz_AreYouSureWantToMoveAnotherUnit}?`, status: '200' };\r\n          } else {\r\n            return {\r\n              description: `${locales.entries.Lcz_YouWillLoseFutureUpdates} ${this.bookingEvent.origin ? this.bookingEvent.origin.Label : ''}. ${\r\n                locales.entries.Lcz_SameRatesWillBeKept\r\n              }`,\r\n              status: '200',\r\n            };\r\n          }\r\n        }\r\n        return { description: locales.entries.Lcz_CannotChangeCHBookings, status: '400' };\r\n      }\r\n    } else {\r\n      if (!this.isShrinking) {\r\n        const initialRT = findRoomType(this.bookingEvent.PR_ID);\r\n        const targetRT = findRoomType(toRoomId);\r\n        if (initialRT === targetRT) {\r\n          console.log('same rt');\r\n          return { description: `${locales.entries.Lcz_AreYouSureWantToMoveAnotherUnit}?`, status: '200' };\r\n        } else {\r\n          return {\r\n            description: locales.entries.Lcz_SameRatesWillBeKept,\r\n            status: '200',\r\n          };\r\n        }\r\n      }\r\n      return { description: locales.entries.Lcz_BalanceWillBeCalculated, status: '200' };\r\n    }\r\n  }\r\n  private resetBookingToInitialPosition() {\r\n    if (this.isStreatch) {\r\n      this.element.style.left = `${this.initialLeft}px`;\r\n      this.element.style.width = `${this.initialWidth}px`;\r\n      this.isStreatch = false;\r\n      this.finalWidth = this.initialWidth;\r\n      this.isShrinking = null;\r\n    } else {\r\n      this.element.style.top = `${this.dragInitPos.top}px`;\r\n      this.element.style.left = `${this.dragInitPos.left}px`;\r\n    }\r\n  }\r\n  @Listen('revertBooking', { target: 'window' })\r\n  handleRevertBooking(event: CustomEvent<string>) {\r\n    if (this.bookingEvent.POOL === event.detail) {\r\n      this.resetBookingToInitialPosition();\r\n    }\r\n  }\r\n  checkIfSlotOccupied(toRoomId, from_date, to_date) {\r\n    const fromTime = moment(from_date, 'YYYY-MM-DD');\r\n    const toTime = moment(to_date, 'YYYY-MM-DD');\r\n    const isOccupied = this.allBookingEvents.some(event => {\r\n      if (event.POOL === this.bookingEvent.POOL) {\r\n        return false;\r\n      }\r\n      const eventFromTime = moment(event.FROM_DATE, 'YYYY-MM-DD').add(1, 'days');\r\n      const eventToTime = moment(event.TO_DATE, 'YYYY-MM-DD');\r\n      return event.PR_ID === +toRoomId && toTime.isSameOrAfter(eventFromTime) && fromTime.isBefore(eventToTime);\r\n    });\r\n    return isOccupied;\r\n  }\r\n\r\n  renderAgain() {\r\n    this.renderElement = !this.renderElement;\r\n  }\r\n\r\n  getUniqueId() {\r\n    return new Date().getTime();\r\n  }\r\n\r\n  isSplitBooking() {\r\n    return !!this.bookingEvent.SPLIT_BOOKING;\r\n  }\r\n\r\n  isNewEvent() {\r\n    return this.getBookingId() === 'NEW_TEMP_EVENT';\r\n  }\r\n\r\n  isHighlightEventType() {\r\n    return this.getEventType() === 'HIGH_LIGHT';\r\n  }\r\n\r\n  getBookingId() {\r\n    return this.bookingEvent.ID;\r\n  }\r\n\r\n  getBookingStatus() {\r\n    return this.bookingEvent.STATUS;\r\n  }\r\n\r\n  getBookedBy() {\r\n    return this.bookingEvent.NAME;\r\n  }\r\n\r\n  getBookedRoomId() {\r\n    return this.bookingEvent.PR_ID;\r\n  }\r\n\r\n  getEventStartingDate() {\r\n    return new Date(this.bookingEvent.FROM_DATE);\r\n  }\r\n\r\n  getEventEndingDate() {\r\n    return new Date(this.bookingEvent.TO_DATE);\r\n  }\r\n\r\n  getEventType() {\r\n    return this.bookingEvent.event_type;\r\n  }\r\n\r\n  getEventLegend() {\r\n    // console.log(this.getBookingStatus());\r\n    let status = this.bookingEvent?.legendData.statusId[this.getBookingStatus()];\r\n    let orderRide = this.isNewEvent() ? { color: '#f9f9c9' } : {};\r\n    return {\r\n      ...this.bookingEvent?.legendData[status.id],\r\n      ...status,\r\n      ...orderRide,\r\n    };\r\n  }\r\n\r\n  getLegendOfStatus(aStatusId) {\r\n    // console.log(aStatusId);\r\n    let status = this.bookingEvent?.legendData.statusId[aStatusId];\r\n    return { ...this.bookingEvent.legendData[status.id], ...status };\r\n  }\r\n\r\n  getNoteNode() {\r\n    if (this.bookingEvent.NOTES || this.bookingEvent.INTERNAL_NOTE) {\r\n      return this.getLegendOfStatus('NOTES');\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getBalanceNode() {\r\n    if (this.bookingEvent.BALANCE !== null && this.bookingEvent.BALANCE > 0) {\r\n      return this.getLegendOfStatus('OUTSTANDING-BALANCE');\r\n    }\r\n    return null;\r\n  }\r\n\r\n  setStayDays(aStayDays: number) {\r\n    this.bookingEvent.NO_OF_DAYS = aStayDays;\r\n    this.renderAgain();\r\n    // this.updateData({id: this.getBookedRoomId(), data: { NO_OF_DAYS: aStayDays }});\r\n  }\r\n\r\n  getStayDays() {\r\n    return this.bookingEvent.NO_OF_DAYS;\r\n  }\r\n\r\n  getPosition() {\r\n    let startingDate = this.getEventStartingDate();\r\n    let startingCellClass = '.room_' + this.getBookedRoomId() + '_' + startingDate.getDate() + '_' + (startingDate.getMonth() + 1) + '_' + startingDate.getFullYear();\r\n    let bodyContainer = document.querySelector('.bodyContainer');\r\n    let startingCell = document.querySelector(startingCellClass);\r\n    let pos = { top: '0', left: '0', width: '0', height: '20px' };\r\n    if (startingCell && bodyContainer && startingCell.getBoundingClientRect() && bodyContainer.getBoundingClientRect()) {\r\n      let bodyContainerRect = bodyContainer.getBoundingClientRect();\r\n      let boundingRect = startingCell.getBoundingClientRect();\r\n      this.dayWidth = this.dayWidth || boundingRect.width;\r\n      pos.top = boundingRect.top + boundingRect.height / 2 - this.vertSpace - bodyContainerRect.top + 'px';\r\n      pos.left = boundingRect.left + this.dayWidth / 2 + this.eventSpace / 2 - bodyContainerRect.left + 'px';\r\n      pos.width = this.getStayDays() * this.dayWidth - this.eventSpace + 'px';\r\n    } else {\r\n      console.log('Locating event cell failed ', startingCellClass);\r\n    }\r\n    //console.log(pos);\r\n    return pos;\r\n  }\r\n\r\n  getNumber(aData) {\r\n    return aData ? parseFloat(aData) : 0;\r\n  }\r\n\r\n  startDragging(event: any, side: string) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    event.stopImmediatePropagation();\r\n\r\n    if (this.isNewEvent() || this.isHighlightEventType()) {\r\n      return null;\r\n    }\r\n\r\n    this.resizeSide = side;\r\n    this.isDragging = true;\r\n\r\n    this.showEventInfo(false); // Hide bubble;\r\n    this.isStreatch = side !== 'move';\r\n    if (side === 'move') {\r\n      this.initialX = event.clientX || event.touches[0].clientX;\r\n      this.initialY = event.clientY || event.touches[0].clientY;\r\n      this.elementRect = this.element.getBoundingClientRect();\r\n      const offsetX = 0; //this.initialX - this.elementRect.left - 18;\r\n      const offsetY = 0; // this.initialY - this.elementRect.top - (this.elementRect.height/2);\r\n      this.dragInitPos = {\r\n        id: this.getBookingId(),\r\n        fromRoomId: this.getBookedRoomId(),\r\n        top: this.getNumber(this.element.style.top) + offsetY,\r\n        left: this.getNumber(this.element.style.left) + offsetX,\r\n      };\r\n      this.dragInitPos.x = this.dragInitPos.left; // + 18;\r\n      this.dragInitPos.y = this.dragInitPos.top; // + (this.elementRect.height/2);\r\n      this.dragEndPos = { ...this.dragInitPos };\r\n      this.element.style.top = `${this.dragInitPos.top}px`;\r\n      this.element.style.left = `${this.dragInitPos.left}px`;\r\n      this.isTouchStart = true; // !!(event.touches && event.touches.length);\r\n      this.dragOverEventData.emit({\r\n        id: 'CALCULATE_DRAG_OVER_BOUNDS',\r\n        data: this.dragInitPos,\r\n      });\r\n    } else {\r\n      this.initialWidth = this.element.offsetWidth;\r\n      this.initialLeft = this.element.offsetLeft;\r\n      this.initialX = event.clientX || event.touches[0].clientX;\r\n      this.dragOverEventData.emit({\r\n        id: 'CALCULATE_DRAG_OVER_BOUNDS',\r\n        data: {\r\n          id: this.getBookingId(),\r\n          fromRoomId: this.getBookedRoomId(),\r\n          top: this.getNumber(this.element.style.top),\r\n          left: this.initialLeft,\r\n          x: this.initialX,\r\n          y: event.clientY || event.touches[0].clientY,\r\n        },\r\n      });\r\n    }\r\n\r\n    document.addEventListener('mousemove', this.handleMouseMoveBind);\r\n    document.addEventListener('touchmove', this.handleMouseMoveBind);\r\n    document.addEventListener('pointermove', this.handleMouseMoveBind);\r\n\r\n    document.addEventListener('mouseup', this.handleMouseUpBind);\r\n    document.addEventListener('touchup', this.handleMouseUpBind);\r\n    document.addEventListener('pointerup', this.handleMouseUpBind);\r\n  }\r\n\r\n  handleMouseMove(event: any) {\r\n    if (this.isDragging) {\r\n      this.currentX = event.clientX || event.touches[0].clientX;\r\n      let distanceX = this.currentX - this.initialX;\r\n      if (this.resizeSide === 'move') {\r\n        this.currentY = event.clientY || event.touches[0].clientY;\r\n        let distanceY = this.currentY - this.initialY;\r\n        this.element.style.top = `${this.dragInitPos.top + distanceY}px`;\r\n        this.element.style.left = `${this.dragInitPos.left + distanceX}px`;\r\n        this.dragEndPos = {\r\n          id: this.getBookingId(),\r\n          fromRoomId: this.getBookedRoomId(),\r\n          top: this.dragInitPos.top + distanceY,\r\n          left: this.dragInitPos.left + distanceX,\r\n        };\r\n        this.dragEndPos.x = this.dragEndPos.left; // + 18;\r\n        this.dragEndPos.y = this.dragEndPos.top; // + (this.elementRect.height/2);\r\n        this.dragOverEventData.emit({ id: 'DRAG_OVER', data: this.dragEndPos });\r\n      } else {\r\n        if (!this.bookingEvent.is_direct && !isBlockUnit(this.bookingEvent.STATUS_CODE)) {\r\n          return;\r\n        }\r\n        let newWidth = this.initialWidth;\r\n        if (this.resizeSide == 'rightSide') {\r\n          newWidth = this.initialWidth + distanceX;\r\n          newWidth = Math.min(newWidth, this.initialX + this.element.offsetWidth);\r\n          newWidth = Math.max(this.dayWidth - this.eventSpace, newWidth);\r\n          this.element.style.width = `${newWidth}px`;\r\n          this.isShrinking = distanceX < 0;\r\n        } else if (this.resizeSide == 'leftSide') {\r\n          this.isShrinking = distanceX > 0;\r\n          newWidth = Math.max(this.dayWidth - this.eventSpace, this.initialWidth - distanceX);\r\n          let newLeft = this.initialLeft + (this.initialWidth - newWidth);\r\n          this.element.style.left = `${newLeft}px`;\r\n          this.element.style.width = `${newWidth}px`;\r\n        }\r\n        this.finalWidth = newWidth;\r\n      }\r\n    } else {\r\n      console.log('still mouse move listening...');\r\n    }\r\n  }\r\n\r\n  handleMouseUp() {\r\n    if (this.isDragging) {\r\n      if (this.resizeSide === 'move') {\r\n        // console.log(\"Initial X::\"+this.dragInitPos.x);\r\n        // console.log(\"Initial Y::\"+this.dragInitPos.y);\r\n        // console.log(\"End X::\"+this.dragEndPos.x);\r\n        // console.log(\"End Y::\"+this.dragEndPos.y);\r\n        if (this.isTouchStart) {\r\n          this.moveDiffereneX = Math.abs(this.dragEndPos.x - this.dragInitPos.x);\r\n          this.moveDiffereneY = Math.abs(this.dragEndPos.y - this.dragInitPos.y);\r\n        }\r\n        this.dragOverEventData.emit({\r\n          id: 'DRAG_OVER_END',\r\n          data: {\r\n            ...this.dragEndPos,\r\n            pool: this.bookingEvent.POOL,\r\n            nbOfDays: this.bookingEvent.NO_OF_DAYS,\r\n          },\r\n        });\r\n      } else {\r\n        let numberOfDays = Math.round(this.finalWidth / this.dayWidth);\r\n        let initialStayDays = this.getStayDays();\r\n        if (initialStayDays != numberOfDays && !isNaN(numberOfDays)) {\r\n          //this.setStayDays(numberOfDays);\r\n          if (this.resizeSide == 'leftSide') {\r\n            this.element.style.left = `${this.initialLeft + (initialStayDays - numberOfDays) * this.dayWidth}px`;\r\n            // set FROM_DATE = TO_DATE - numberOfDays\r\n          } else {\r\n            if (numberOfDays < initialStayDays) {\r\n              this.isShrinking = true;\r\n            }\r\n            // set TO_DATE = FROM_DATE + numberOfDays\r\n          }\r\n          this.dragOverEventData.emit({\r\n            id: 'STRETCH_OVER_END',\r\n            data: {\r\n              id: this.getBookingId(),\r\n              fromRoomId: +this.getBookedRoomId(),\r\n              x: +this.element.style.left.replace('px', ''),\r\n              y: +this.element.style.top.replace('px', ''),\r\n              pool: this.bookingEvent.POOL,\r\n              nbOfDays: numberOfDays,\r\n            },\r\n          });\r\n\r\n          this.element.style.width = `${numberOfDays * this.dayWidth - this.eventSpace}px`;\r\n        } else {\r\n          this.element.style.left = `${this.initialLeft}px`;\r\n          this.element.style.width = `${numberOfDays * this.dayWidth - this.eventSpace}px`;\r\n        }\r\n      }\r\n    } else {\r\n      console.log('still mouse up listening...');\r\n    }\r\n    this.isDragging = false;\r\n\r\n    document.removeEventListener('mousemove', this.handleMouseMoveBind);\r\n    document.removeEventListener('touchmove', this.handleMouseMoveBind);\r\n    document.removeEventListener('pointermove', this.handleMouseMoveBind);\r\n\r\n    document.removeEventListener('mouseup', this.handleMouseUpBind);\r\n    document.removeEventListener('touchup', this.handleMouseUpBind);\r\n    document.removeEventListener('pointerup', this.handleMouseUpBind);\r\n  }\r\n\r\n  updateData(data: any) {\r\n    this.updateEventData.emit(data);\r\n  }\r\n  renderEventBookingNumber() {\r\n    if (this.bookingEvent.STATUS === 'TEMP-EVENT' || this.bookingEvent.ID === 'NEW_TEMP_EVENT') {\r\n      return '';\r\n    }\r\n    if (isBlockUnit(this.bookingEvent.STATUS_CODE)) {\r\n      return '';\r\n    }\r\n    if (!this.bookingEvent.is_direct) {\r\n      return ` - ${this.bookingEvent.channel_booking_nbr}`;\r\n    }\r\n    return ` - ${this.bookingEvent.BOOKING_NUMBER}`;\r\n  }\r\n  showEventInfo(showInfo) {\r\n    if (this.isHighlightEventType() || this.bookingEvent.hideBubble) {\r\n      return null;\r\n    }\r\n\r\n    if (showInfo) {\r\n      // Calculate which side we need to show the bubble, top side or bottom.\r\n      let bodyContainer = document.querySelector('.calendarScrollContainer');\r\n      let bodyContainerRect: { [key: string]: any } = bodyContainer.getBoundingClientRect();\r\n      let elementRect: { [key: string]: any } = this.element.getBoundingClientRect();\r\n      let midPoint = bodyContainerRect.height / 2 + bodyContainerRect.top + 50;\r\n      // let topDifference = elementRect.top - bodyContainerRect.top;\r\n      // let bottomDifference = bodyContainerRect.bottom - elementRect.bottom;\r\n\r\n      if (elementRect.top < midPoint) {\r\n        this.bubbleInfoTopSide = false;\r\n      } else {\r\n        this.bubbleInfoTopSide = true;\r\n      }\r\n    }\r\n\r\n    // showInfo = true;\r\n    if (showInfo) {\r\n      this.hideBubbleInfo.emit({\r\n        key: 'hidePopup',\r\n        currentInfoBubbleId: this.getBookingId(),\r\n      });\r\n    }\r\n    this.showInfoPopup = showInfo;\r\n    this.renderAgain();\r\n  }\r\n\r\n  render() {\r\n    // onMouseLeave={()=>this.showEventInfo(false)}\r\n    let legend = this.getEventLegend();\r\n    let noteNode = this.getNoteNode();\r\n    let balanceNode = this.getBalanceNode();\r\n\r\n    return (\r\n      <Host\r\n        class={`bookingEvent ${this.isNewEvent() || this.isHighlightEventType() ? 'newEvent' : ''} ${legend.clsName} `}\r\n        style={this.getPosition()}\r\n        id={'event_' + this.getBookingId()}\r\n      >\r\n        {/* onMouseOver={() =>this.showEventInfo(true)}  */}\r\n        <div\r\n          class={`bookingEventBase ${\r\n            !this.bookingEvent.is_direct &&\r\n            !isBlockUnit(this.bookingEvent.STATUS_CODE) &&\r\n            this.bookingEvent.STATUS !== 'TEMP-EVENT' &&\r\n            this.bookingEvent.ID !== 'NEW_TEMP_EVENT' &&\r\n            'border border-dark'\r\n          }  ${this.isSplitBooking() ? 'splitBooking' : ''}`}\r\n          style={{ backgroundColor: legend.color }}\r\n          onTouchStart={event => this.startDragging(event, 'move')}\r\n          onMouseDown={event => this.startDragging(event, 'move')}\r\n        ></div>\r\n        {noteNode ? <div class=\"legend_circle noteIcon\" style={{ backgroundColor: noteNode.color }}></div> : null}\r\n        {balanceNode ? <div class=\"legend_circle balanceIcon\" style={{ backgroundColor: balanceNode.color }}></div> : null}\r\n        {/* onMouseOver={() => this.showEventInfo(true)}  */}\r\n        <div class=\"bookingEventTitle\" onTouchStart={event => this.startDragging(event, 'move')} onMouseDown={event => this.startDragging(event, 'move')}>\r\n          {this.getBookedBy()}\r\n          {this.renderEventBookingNumber()}\r\n        </div>\r\n\r\n        <Fragment>\r\n          <div\r\n            class=\"bookingEventDragHandle leftSide\"\r\n            onTouchStart={event => this.startDragging(event, 'leftSide')}\r\n            onMouseDown={event => this.startDragging(event, 'leftSide')}\r\n          ></div>\r\n          <div\r\n            class=\"bookingEventDragHandle rightSide\"\r\n            onTouchStart={event => this.startDragging(event, 'rightSide')}\r\n            onMouseDown={event => this.startDragging(event, 'rightSide')}\r\n          ></div>\r\n        </Fragment>\r\n\r\n        {this.showInfoPopup ? (\r\n          <igl-booking-event-hover\r\n            is_vacation_rental={this.is_vacation_rental}\r\n            countryNodeList={this.countryNodeList}\r\n            currency={this.currency}\r\n            class=\"top\"\r\n            bookingEvent={this.bookingEvent}\r\n            bubbleInfoTop={this.bubbleInfoTopSide}\r\n          ></igl-booking-event-hover>\r\n        ) : null}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}