{"file":"ir-channel-mapping2.js","mappings":"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","names":[],"sources":["src/components/ir-channel/ir-channel-mapping/ir-mapping.service.ts","src/components/ir-channel/ir-channel-mapping/ir-channel-mapping.css?tag=ir-channel-mapping&encapsulation=scoped","src/components/ir-channel/ir-channel-mapping/ir-channel-mapping.tsx"],"sourcesContent":["import calendar_data from '@/stores/calendar-data';\r\nimport channels_data from '@/stores/channel.store';\r\n\r\nexport class IrMappingService {\r\n  public checkMappingExists(id: string, isRoomType: boolean, roomTypeId?: string) {\r\n    const mapped_id = channels_data.mappedChannel.find(m => m.channel_id === id);\r\n    if (!mapped_id) {\r\n      return undefined;\r\n    }\r\n    if (!isRoomType) {\r\n      console.log('object');\r\n      return undefined;\r\n    }\r\n    if (isRoomType) {\r\n      return calendar_data.roomsInfo.find(room => room.id.toString() === mapped_id.ir_id);\r\n    }\r\n    if (!roomTypeId) {\r\n      throw new Error('Missing room type id');\r\n    }\r\n    const room_type = calendar_data.roomsInfo.find(room => room.id.toString() === roomTypeId);\r\n    console.log(room_type);\r\n    if (!room_type) {\r\n      throw new Error('Invalid Room type');\r\n    }\r\n    console.log(room_type);\r\n    return room_type.rateplans.find(r => r.id.toString() === mapped_id.ir_id);\r\n  }\r\n  public getAppropriateRooms(isRoomType: boolean, roomTypeId?: string) {\r\n    if (isRoomType) {\r\n      const filteredRoomTypes = calendar_data.roomsInfo.filter(\r\n        room => channels_data.mappedChannel.find(m => m.ir_id.toString() === room.id.toString()) === undefined && room.is_active,\r\n      );\r\n      return filteredRoomTypes.map(room => ({ id: room.id.toString(), name: room.name }));\r\n    }\r\n    if (!roomTypeId) {\r\n      throw new Error('Missing roomType id');\r\n    }\r\n    console.log(roomTypeId);\r\n    const selectedRoomType = calendar_data.roomsInfo.filter(room => channels_data.mappedChannel.find(m => m.channel_id.toString() === roomTypeId) && room.is_active);\r\n    console.log(selectedRoomType);\r\n\r\n    // console.log(filteredRoomTypes);\r\n    //filter all the room types that are taken\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n  box-sizing: border-box;\r\n}\r\n.map-row {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n.map-row span {\r\n  width: 49%;\r\n}\r\n\r\n.submap-text {\r\n  padding-left: 10px;\r\n}\r\n.text-blue {\r\n  color: var(--blue);\r\n}\r\n.text-red {\r\n  color: var(--red);\r\n}\r\n.refresh-btn {\r\n  all: unset;\r\n  color: var(--blue);\r\n  cursor: pointer;\r\n}\r\n","import { Component, Host, State, h } from '@stencil/core';\r\nimport { IrMappingService } from './ir-mapping.service';\r\nimport channels_data, { addMapping, removedMapping, setMappedChannel } from '@/stores/channel.store';\r\n\r\n@Component({\r\n  tag: 'ir-channel-mapping',\r\n  styleUrl: 'ir-channel-mapping.css',\r\n  scoped: true,\r\n})\r\nexport class IrChannelMapping {\r\n  @State() activeMapField = '';\r\n  @State() availableRooms: { id: string; name: string }[] = [];\r\n\r\n  private mappingService = new IrMappingService();\r\n\r\n  setActiveField(id: string, isRoomType: boolean, roomTypeId?: string) {\r\n    const availableRooms = this.mappingService.getAppropriateRooms(isRoomType, roomTypeId);\r\n    if (availableRooms) {\r\n      this.availableRooms = availableRooms;\r\n    }\r\n    this.activeMapField = id;\r\n  }\r\n\r\n  renderMappingStatus(id: string, isRoomType: boolean, roomTypeId?: string) {\r\n    const mappedField = this.mappingService.checkMappingExists(id, isRoomType, roomTypeId);\r\n    if (mappedField) {\r\n      return (\r\n        <span class=\"px-2 text-blue d-flex align-items-center\">\r\n          <span class=\"m-0 p-0 flex-fill\">{mappedField.name}</span>\r\n          <ir-icon class=\"m-0 p-0\" onIconClickHandler={() => removedMapping(mappedField.id.toString())}>\r\n            <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" height=\"14\" width=\"12.25\" viewBox=\"0 0 448 512\">\r\n              <path\r\n                fill={'var(--blue)'}\r\n                d=\"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z\"\r\n              />\r\n            </svg>\r\n          </ir-icon>\r\n        </span>\r\n      );\r\n    }\r\n    return (\r\n      <span class=\"px-2\">\r\n        {this.activeMapField === id ? (\r\n          <ir-combobox\r\n            autoFocus\r\n            placeholder=\"Not mapped\"\r\n            data={this.availableRooms}\r\n            onComboboxValueChange={e => {\r\n              console.log(e.detail.data);\r\n              addMapping(e.detail.data as string, this.activeMapField);\r\n              this.activeMapField = '';\r\n            }}\r\n          ></ir-combobox>\r\n        ) : (\r\n          <span class=\"cursor-pointer text-danger\" onClick={() => this.setActiveField(id, isRoomType, roomTypeId)}>\r\n            Not mapped\r\n          </span>\r\n        )}\r\n      </span>\r\n    );\r\n  }\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div class=\"d-flex w-100 justify-content-end\">\r\n          <button\r\n            onClick={() => {\r\n              setMappedChannel();\r\n            }}\r\n            class=\"btn refresh-btn\"\r\n          >\r\n            Refresh\r\n          </button>\r\n        </div>\r\n        <ul class=\"m-0 p-0\">\r\n          <li class=\"map-row my-1\">\r\n            <span class=\"font-weight-bold\">{channels_data.selectedChannel.name}</span>\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"14\" width=\"12.25\" viewBox=\"0 0 448 512\">\r\n              <path d=\"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z\" />\r\n            </svg>\r\n            <span class=\"font-weight-bold px-2\">Igloorooms</span>\r\n          </li>\r\n          {channels_data.selectedChannel.property.room_types.map(room_type => (\r\n            <li key={room_type.id} class=\"mb-1\">\r\n              <div class=\"map-row\">\r\n                <span>{room_type.name}</span>\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"14\" width=\"12.25\" viewBox=\"0 0 448 512\">\r\n                  <path d=\"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z\" />\r\n                </svg>\r\n                {this.renderMappingStatus(room_type.id, true)}\r\n              </div>\r\n              <ul class=\"m-0 p-0\">\r\n                {room_type.rate_plans.map(rate_plan => (\r\n                  <li class=\"map-row\" key={rate_plan.id}>\r\n                    <span class=\"submap-text\">{rate_plan.name}</span>\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"14\" width=\"12.25\" viewBox=\"0 0 448 512\">\r\n                      <path\r\n                        fill=\"currentColor\"\r\n                        d=\"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z\"\r\n                      />\r\n                    </svg>\r\n                    {this.renderMappingStatus(rate_plan.id, false, room_type.id)}\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}