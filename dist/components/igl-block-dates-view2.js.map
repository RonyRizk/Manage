{"file":"igl-block-dates-view2.js","mappings":"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","names":[],"sources":["src/components/igloo-calendar/igl-block-dates-view/igl-block-dates-view.css?tag=igl-block-dates-view&encapsulation=scoped","src/components/igloo-calendar/igl-block-dates-view/igl-block-dates-view.tsx"],"sourcesContent":["@import url('../../../assets/feather/style.min.css');\r\n@import url('../../../assets/fontawesome/css/all.css');\r\n@import url('../../../assets/line-awesome/css/line-awesome.min.css');\r\n:host {\r\n  display: block;\r\n}\r\n\r\n:host .controlContainer {\r\n  width: 24px;\r\n}\r\n\r\n:host .checkBoxContainer input {\r\n  height: 1.2rem !important;\r\n  width: 30px;\r\n}\r\n\r\n.releaseTime {\r\n  padding-left: 5px;\r\n}\r\n","import { Component, Host, h, Prop, State, Event, EventEmitter } from '@stencil/core';\r\nimport { BookingService } from '../../../services/booking.service';\r\nimport { IEntries } from '../../../models/IBooking';\r\nimport { formatDate } from '../../../utils/utils';\r\n\r\n@Component({\r\n  tag: 'igl-block-dates-view',\r\n  styleUrl: 'igl-block-dates-view.css',\r\n  scoped: true,\r\n})\r\nexport class IglBlockDatesView {\r\n  @Prop() defaultData: { [key: string]: any };\r\n  @Prop() fromDate: string;\r\n  @Prop() toDate: string;\r\n  @Prop({ mutable: true }) entryDate: string;\r\n  @Prop() entryHour: number;\r\n  @Prop() isEventHover: boolean = false;\r\n  @Prop() entryMinute: number;\r\n  @State() renderAgain: boolean = false;\r\n  @Event() dataUpdateEvent: EventEmitter<{ [key: string]: any }>;\r\n\r\n  private blockDatesData: { [key: string]: any } = {\r\n    RELEASE_AFTER_HOURS: 0,\r\n    OPTIONAL_REASON: '',\r\n    OUT_OF_SERVICE: false,\r\n  }; // Change of property name might require updates in booking-event-hover\r\n  private releaseList: IEntries[] = [];\r\n  private bookingService: BookingService = new BookingService();\r\n  async componentWillLoad() {\r\n    try {\r\n      this.releaseList = await this.bookingService.getBlockedInfo();\r\n      if (this.defaultData) {\r\n        this.blockDatesData = { ...this.defaultData };\r\n      } else {\r\n        this.blockDatesData.RELEASE_AFTER_HOURS = parseInt(this.releaseList[0].CODE_NAME);\r\n        this.emitData();\r\n      }\r\n    } catch (error) {\r\n      // toastr.error(error);\r\n    }\r\n  }\r\n\r\n  handleOptionalReason(event) {\r\n    this.blockDatesData.OPTIONAL_REASON = event.target.value;\r\n    this.emitData();\r\n  }\r\n\r\n  handleReleaseAfterChange(evt) {\r\n    if (this.entryDate) this.entryDate = undefined;\r\n    this.blockDatesData.RELEASE_AFTER_HOURS = parseInt(evt.target.value);\r\n    this.renderPage();\r\n    this.emitData();\r\n  }\r\n\r\n  emitData() {\r\n    this.dataUpdateEvent.emit({\r\n      key: 'blockDatesData',\r\n      data: { ...this.blockDatesData },\r\n    });\r\n  }\r\n\r\n  getReleaseHoursString() {\r\n    // console.log(\"entry date\", this.entryDate);\r\n    // console.log(\"blocked date data\", this.blockDatesData);\r\n    let dt = this.entryDate ? new Date(this.entryDate) : new Date();\r\n    if (this.entryDate && this.entryHour && this.entryMinute) {\r\n      dt.setHours(this.entryHour, this.entryMinute, 0, 0);\r\n    } else {\r\n      dt.setHours(dt.getHours() + this.blockDatesData.RELEASE_AFTER_HOURS, dt.getMinutes(), 0, 0);\r\n    }\r\n\r\n    return dt.toLocaleString('default', { month: 'short' }) + ' ' + dt.getDate() + ', ' + this.formatNumber(dt.getHours()) + ':' + this.formatNumber(dt.getMinutes());\r\n  }\r\n  formatNumber(value: number) {\r\n    return value < 10 ? `0${value}` : value;\r\n  }\r\n  handleOutOfService(evt) {\r\n    this.blockDatesData.OUT_OF_SERVICE = evt.target.checked;\r\n    if (this.blockDatesData.OUT_OF_SERVICE) {\r\n      this.blockDatesData.OPTIONAL_REASON = '';\r\n      this.blockDatesData.RELEASE_AFTER_HOURS = 0;\r\n    }\r\n    this.renderPage();\r\n    this.emitData();\r\n  }\r\n\r\n  renderPage() {\r\n    this.renderAgain = !this.renderAgain;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div class={`m-0 p-0 mb-1`}>\r\n          <div class=\"text-left p-0\">\r\n            <span class=\"pr-1\">\r\n              <span class=\"text-bold-700 font-medium-1\">From: </span>\r\n              {formatDate(this.fromDate)}\r\n            </span>\r\n            <span class=\"text-bold-700 font-medium-1\">To: </span>\r\n            {formatDate(this.toDate)}\r\n          </div>\r\n        </div>\r\n        <div class={` mb-1 text-left ${this.isEventHover && 'p-0'}`}>\r\n          <div class=\"mb-1 \">\r\n            <label class=\"p-0 text-bold-700 font-medium-1 m-0 align-middle\">Reason:</label>\r\n            <div class=\"p-0 m-0 pr-1 controlContainer checkBoxContainer d-inline-block align-middle\">\r\n              <input class=\"form-control\" type=\"checkbox\" checked={this.blockDatesData.OUT_OF_SERVICE} id=\"userinput6\" onChange={event => this.handleOutOfService(event)} />\r\n            </div>\r\n            <span class=\"align-middle\">Out of service</span>\r\n          </div>\r\n          {!this.blockDatesData.OUT_OF_SERVICE ? (\r\n            <div>\r\n              <div class=\"mb-1 d-flex  align-items-center\">\r\n                <span class=\"align-middle\">or </span>\r\n                <div class=\"d-inline-flex col pr-0 align-middle\">\r\n                  <input\r\n                    class=\"form-control\"\r\n                    type=\"text\"\r\n                    placeholder=\"Optional reason\"\r\n                    id=\"optReason\"\r\n                    value={this.blockDatesData.OPTIONAL_REASON}\r\n                    onInput={event => this.handleOptionalReason(event)}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div class=\"mb-1 w-100 pr-0 \">\r\n                <span class=\"text-bold-700 font-medium-1\">Automatic release in: </span>\r\n                <div class=\"d-inline-block\">\r\n                  <select class=\"form-control input-sm\" id=\"zSmallSelect\" onChange={evt => this.handleReleaseAfterChange(evt)}>\r\n                    {this.releaseList.map(releaseItem => (\r\n                      <option value={+releaseItem.CODE_NAME} selected={this.blockDatesData.RELEASE_AFTER_HOURS == +releaseItem.CODE_NAME}>\r\n                        {releaseItem.CODE_VALUE_EN}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n                {this.blockDatesData.RELEASE_AFTER_HOURS ? (\r\n                  <div class=\"d-inline-block releaseTime\">\r\n                    <em>on {this.getReleaseHoursString()}</em>\r\n                  </div>\r\n                ) : null}\r\n              </div>\r\n            </div>\r\n          ) : null}\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"version":3}