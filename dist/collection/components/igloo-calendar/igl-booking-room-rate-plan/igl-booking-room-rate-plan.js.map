{"version":3,"file":"igl-booking-room-rate-plan.js","sourceRoot":"","sources":["../../../../src/components/igloo-calendar/igl-booking-room-rate-plan/igl-booking-room-rate-plan.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, Prop, h, State, Event, EventEmitter, Watch } from '@stencil/core';\r\nimport { v4 } from 'uuid';\r\nimport { getCurrencySymbol } from '../../../utils/utils';\r\n@Component({\r\n  tag: 'igl-booking-room-rate-plan',\r\n  styleUrl: 'igl-booking-room-rate-plan.css',\r\n  scoped: true,\r\n})\r\nexport class IglBookingRoomRatePlan {\r\n  @Prop() defaultData: { [key: string]: any };\r\n  @Prop({ mutable: true }) ratePlanData: { [key: string]: any };\r\n  @Prop() totalAvailableRooms: number;\r\n  @Prop() ratePricingMode = [];\r\n  @Prop() currency: any;\r\n  @Prop({ reflect: true }) dateDifference: number;\r\n  @Prop() bookingType: string = 'PLUS_BOOKING';\r\n  @State() sourceOption: number;\r\n  @Event() dataUpdateEvent: EventEmitter<{ [key: string]: any }>;\r\n  @Event() gotoSplitPageTwoEvent: EventEmitter<{ [key: string]: any }>;\r\n  @State() selectedData: { [key: string]: any };\r\n  @State() plan: { [key: string]: any };\r\n  componentWillLoad() {\r\n    this.selectedData = {\r\n      ratePlanId: this.ratePlanData.id,\r\n      adult_child_offering: this.ratePlanData.variations[0].adult_child_offering,\r\n      rateType: 1,\r\n      totalRooms: 0,\r\n      rate: this.ratePlanData.variations[0].amount,\r\n      ratePlanName: this.ratePlanData.name,\r\n      adultCount: this.ratePlanData.variations[0].adult_nbr,\r\n      childrenCount: this.ratePlanData.variations[0].child_nbr,\r\n      cancelation: this.ratePlanData.cancelation,\r\n      guarantee: this.ratePlanData.guarantee,\r\n      isRateModified: false,\r\n      defaultSelectedRate: 0,\r\n    };\r\n    if (this.defaultData) {\r\n      for (const [key, value] of Object.entries(this.defaultData)) {\r\n        this.selectedData[key] = value;\r\n      }\r\n    }\r\n  }\r\n\r\n  getSelectedOffering(value: any) {\r\n    return this.ratePlanData.variations.find(variation => variation.adult_child_offering === value);\r\n  }\r\n  @Watch('ratePlanData')\r\n  async ratePlanDataChanged() {\r\n    this.selectedData = {\r\n      ...this.selectedData,\r\n      rate: this.handleRateDaysUpdate(),\r\n    };\r\n    this.dataUpdateEvent.emit({\r\n      key: 'roomRatePlanUpdate',\r\n      changedKey: 'rate',\r\n      data: this.selectedData,\r\n    });\r\n  }\r\n\r\n  handleRateDaysUpdate() {\r\n    let rate = this.selectedData.defaultSelectedRate;\r\n    if (this.selectedData.isRateModified) {\r\n      return this.selectedData.rateType === 1 ? rate * this.dateDifference : rate;\r\n    }\r\n    return this.getSelectedOffering(this.selectedData.adult_child_offering).amount;\r\n  }\r\n\r\n  handleInput(event: InputEvent) {\r\n    this.selectedData.isRateModified = true;\r\n    const inputElement = event.target as HTMLInputElement;\r\n    let inputValue = inputElement.value;\r\n    const numericRegex = /^[0-9]+$/;\r\n    if (!numericRegex.test(inputValue)) {\r\n      inputValue = inputValue.replace(/[^0-9]/g, '');\r\n      inputElement.value = inputValue;\r\n    }\r\n    if (inputValue === inputElement.value) {\r\n      this.handleDataChange('rate', event);\r\n    }\r\n  }\r\n\r\n  handleDataChange(key, evt) {\r\n    if (key === 'adult_child_offering') {\r\n      const offering = this.getSelectedOffering(evt.target.value);\r\n      this.selectedData = {\r\n        ...this.selectedData,\r\n        [key]: evt.target.value,\r\n        adultCount: offering.adult_nbr,\r\n        childrenCount: offering.child_nbr,\r\n        rate: offering.amount,\r\n      };\r\n    } else {\r\n      this.selectedData = {\r\n        ...this.selectedData,\r\n        [key]: evt.target.value === '' ? 0 : parseInt(evt.target.value),\r\n      };\r\n    }\r\n    if (key === 'rate' && evt.target.value === '') {\r\n      this.selectedData = {\r\n        ...this.selectedData,\r\n        totalRooms: 0,\r\n      };\r\n    }\r\n    if (key === 'rate') {\r\n      this.selectedData.defaultSelectedRate = this.selectedData.rateType === 1 ? parseInt(evt.target.value) / this.dateDifference : parseInt(evt.target.value);\r\n    }\r\n    this.dataUpdateEvent.emit({\r\n      key: 'roomRatePlanUpdate',\r\n      changedKey: key,\r\n      data: this.selectedData,\r\n    });\r\n  }\r\n\r\n  bookProperty() {\r\n    this.dataUpdateEvent.emit({ key: 'clearData', data: this.selectedData });\r\n    this.handleDataChange('totalRooms', { target: { value: '1' } });\r\n    this.gotoSplitPageTwoEvent.emit({ key: 'gotoSplitPage', data: '' });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div class=\"row m-0 p-0\">\r\n          <div class=\"col-md-6 col-sm-12 p-0 align-self-center\">\r\n            <span>{this.ratePlanData.name}</span>\r\n            <ir-tooltip message={this.ratePlanData.cancelation + this.ratePlanData.guarantee}></ir-tooltip>\r\n          </div>\r\n          <div class=\"col-md-6 col-sm-12 row pr-0\">\r\n            <div class=\"col-4\">\r\n              <fieldset class=\"position-relative\">\r\n                <select class=\"form-control input-sm\" id={v4()} onChange={evt => this.handleDataChange('adult_child_offering', evt)}>\r\n                  {this.ratePlanData.variations.map(variation => (\r\n                    <option value={variation.adult_child_offering} selected={this.selectedData.adult_child_offering === variation.adult_child_offering}>\r\n                      {variation.adult_child_offering}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </fieldset>\r\n            </div>\r\n            <div class=\"row col-6 m-0 p-0\">\r\n              <fieldset class=\"position-relative has-icon-left col-6 m-0 p-0\">\r\n                <input\r\n                  type=\"text\"\r\n                  class=\"form-control input-sm\"\r\n                  value={this.selectedData.rateType === 1 ? this.selectedData.rate : this.selectedData.rate / this.dateDifference}\r\n                  id={v4()}\r\n                  placeholder=\"Rate\"\r\n                  onInput={(event: InputEvent) => this.handleInput(event)}\r\n                />\r\n                <span class=\"form-control-position\">{getCurrencySymbol(this.currency.code)}</span>\r\n              </fieldset>\r\n              <fieldset class=\"position-relative m-0 p-0\">\r\n                <select class=\"form-control input-sm\" id={v4()} onChange={evt => this.handleDataChange('rateType', evt)}>\r\n                  {this.ratePricingMode.map(data => (\r\n                    <option value={data.CODE_NAME} selected={this.selectedData.rateType === +data.CODE_NAME}>\r\n                      {data.CODE_VALUE_EN}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </fieldset>\r\n            </div>\r\n\r\n            {this.bookingType === 'PLUS_BOOKING' || this.bookingType === 'ADD_ROOM' ? (\r\n              <div class=\"col-2 m-0 p-0\">\r\n                <fieldset class=\"position-relative\">\r\n                  <select disabled={this.selectedData.rate === 0} class=\"form-control input-sm\" id={v4()} onChange={evt => this.handleDataChange('totalRooms', evt)}>\r\n                    {Array.from({ length: this.totalAvailableRooms + 1 }, (_, i) => i).map(i => (\r\n                      <option value={i} selected={this.selectedData.totalRooms === i}>\r\n                        {i}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </fieldset>\r\n              </div>\r\n            ) : null}\r\n\r\n            {this.bookingType === 'EDIT_BOOKING' ? (\r\n              <div class=\"col-2 m-0 p-0 align-self-center\">\r\n                <fieldset class=\"position-relative\">\r\n                  <input type=\"radio\" name=\"ratePlanGroup\" value=\"1\" onChange={evt => this.handleDataChange('totalRooms', evt)} checked={this.selectedData.totalRooms === 1} />\r\n                </fieldset>\r\n              </div>\r\n            ) : null}\r\n\r\n            {this.bookingType === 'BAR_BOOKING' || this.bookingType === 'SPLIT_BOOKING' ? (\r\n              <button disabled={this.selectedData.rate === 0} type=\"button\" class=\"btn mb-1 btn-primary btn-sm\" onClick={() => this.bookProperty()}>\r\n                Book\r\n              </button>\r\n            ) : null}\r\n          </div>\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"]}