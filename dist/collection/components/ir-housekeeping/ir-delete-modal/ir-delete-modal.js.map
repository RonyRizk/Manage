{"version":3,"file":"ir-delete-modal.js","sourceRoot":"","sources":["../../../../src/components/ir-housekeeping/ir-delete-modal/ir-delete-modal.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, EventEmitter, Listen, Method, Prop, State, h, Event } from '@stencil/core';\r\nimport housekeeping_store from '@/stores/housekeeping.store';\r\nimport { HouseKeepingService } from '@/services/housekeeping.service';\r\nimport { IHouseKeepers } from '@/models/housekeeping';\r\nimport locales from '@/stores/locales.store';\r\n\r\n@Component({\r\n  tag: 'ir-delete-modal',\r\n  styleUrl: 'ir-delete-modal.css',\r\n  scoped: true,\r\n})\r\nexport class IrDeleteModal {\r\n  @Prop() user: IHouseKeepers;\r\n\r\n  @State() isOpen: boolean = false;\r\n  @State() selectedId: string = '';\r\n  @State() loadingBtn: 'confirm' | null = null;\r\n\r\n  @Event() modalClosed: EventEmitter<null>;\r\n  @Event() resetData: EventEmitter<string>;\r\n\r\n  private housekeepingService = new HouseKeepingService();\r\n\r\n  componentWillLoad() {\r\n    this.housekeepingService.setToken(housekeeping_store.default_properties.token);\r\n  }\r\n\r\n  @Method()\r\n  async closeModal() {\r\n    this.isOpen = false;\r\n    this.modalClosed.emit(null);\r\n  }\r\n  @Method()\r\n  async openModal() {\r\n    this.isOpen = true;\r\n  }\r\n\r\n  @Listen('clickHanlder')\r\n  async btnClickHandler(event: CustomEvent) {\r\n    let target = event.target as HTMLInputElement;\r\n    let name = target.name;\r\n    try {\r\n      if (name === 'confirm') {\r\n        this.loadingBtn = 'confirm';\r\n        if (this.selectedId === '') {\r\n          await this.housekeepingService.editExposedHKM(this.user, true);\r\n        } else {\r\n          const newAssignedUnits = this.user.assigned_units.map(u => ({ hkm_id: +this.selectedId, is_to_assign: true, unit_id: u.id }));\r\n          await this.housekeepingService.manageExposedAssignedUnitToHKM(housekeeping_store.default_properties.property_id, newAssignedUnits);\r\n          const { assigned_units, is_soft_deleted, is_active, ...user } = this.user;\r\n          await this.housekeepingService.editExposedHKM(user, true);\r\n        }\r\n        this.resetData.emit(null);\r\n      }\r\n      if (name === 'cancel') {\r\n        this.closeModal();\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      if (this.loadingBtn) {\r\n        this.loadingBtn = null;\r\n        this.closeModal();\r\n      }\r\n    }\r\n  }\r\n  render() {\r\n    if (!this.user) {\r\n      return null;\r\n    }\r\n    return [\r\n      <div\r\n        class={`backdropModal ${this.isOpen ? 'active' : ''}`}\r\n        onClick={() => {\r\n          this.closeModal();\r\n        }}\r\n      ></div>,\r\n      <div data-state={this.isOpen ? 'opened' : 'closed'} class={`ir-modal`} tabindex=\"-1\">\r\n        {this.isOpen && (\r\n          <div class={`ir-alert-content p-2`}>\r\n            <div class={`ir-alert-header align-items-center border-0 py-0 m-0 `}>\r\n              <p class=\"p-0 my-0 mb-1\">{this.user.assigned_units.length > 0 ? locales.entries.Lcz_AssignUnitsTo : locales.entries.Lcz_ConfirmDeletion}</p>\r\n              <ir-icon\r\n                class=\"exit-icon\"\r\n                style={{ cursor: 'pointer' }}\r\n                onClick={() => {\r\n                  this.closeModal();\r\n                }}\r\n              >\r\n                <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" height=\"14\" width=\"10.5\" viewBox=\"0 0 384 512\">\r\n                  <path\r\n                    fill=\"currentColor\"\r\n                    d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"\r\n                  />\r\n                </svg>\r\n              </ir-icon>\r\n            </div>\r\n            {this.user.assigned_units.length > 0 && (\r\n              <div class=\"modal-body text-left p-0 mb-2\">\r\n                <ir-select\r\n                  firstOption={locales.entries.Lcz_nobody}\r\n                  selectedValue={this.selectedId}\r\n                  onSelectChange={e => (this.selectedId = e.detail)}\r\n                  LabelAvailable={false}\r\n                  data={housekeeping_store.hk_criteria.housekeepers\r\n                    .filter(hk => hk.id !== this.user.id)\r\n                    .map(m => ({\r\n                      value: m.id.toString(),\r\n                      text: m.name,\r\n                    }))}\r\n                ></ir-select>\r\n              </div>\r\n            )}\r\n\r\n            <div class={`ir-alert-footer border-0 d-flex justify-content-end`}>\r\n              <ir-button icon={''} btn_color={'secondary'} btn_block text={locales.entries.Lcz_Cancel} name={'cancel'}></ir-button>\r\n              <ir-button isLoading={this.loadingBtn === 'confirm'} icon={''} btn_color={'primary'} btn_block text={locales.entries.Lcz_Confirm} name={'confirm'}></ir-button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>,\r\n    ];\r\n  }\r\n}\r\n"]}