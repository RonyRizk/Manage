import{r as t,h as i,H as s}from"./p-05195efb.js";import{B as e}from"./p-40d4f5422.js";import{R as o}from"./p-2f9bae702.js";import{l as n}from"./p-dda5a727.js";import{a}from"./p-539b691e.js";import"./p-34fcab72.js";import"./p-eaccab4c.js";import"./p-ed91ab97.js";import"./p-7cd9c724.js";const r=".sc-igl-book-property-container-h{display:block;margin:0;padding:0}.book-container.sc-igl-book-property-container{width:min-content;margin:0;padding:0}";const h=class{constructor(i){t(this,i);this.bookingService=new e;this.roomService=new o;this.language="";this.ticket="";this.baseurl="";this.propertyid=undefined;this.from_date=undefined;this.to_date=undefined;this.bookingItem=undefined;this.showPaymentDetails=undefined;this.countryNodeList=undefined;this.calendarData={}}setRoomsData(t){var i,s;let e=new Array;if((s=(i=t.My_Result)===null||i===void 0?void 0:i.roomtypes)===null||s===void 0?void 0:s.length){e=t.My_Result.roomtypes;t.My_Result.roomtypes.forEach((t=>{t.expanded=true}))}this.calendarData.roomsInfo=e}async initializeApp(){try{const[t,i,s]=await Promise.all([this.roomService.fetchData(this.propertyid,this.language),this.roomService.fetchLanguage(this.language),this.bookingService.getCountries(this.language)]);console.log(i);if(!n.entries){n.entries=i.entries;n.direction=i.direction}this.countryNodeList=s;const{allowed_payment_methods:e,currency:o,allowed_booking_sources:a,adult_child_constraints:r,calendar_legends:h}=t["My_Result"];this.calendarData={currency:o,allowed_booking_sources:a,adult_child_constraints:r,legendData:h};this.setRoomsData(t);const c=["001","004"];this.showPaymentDetails=e.some((t=>c.includes(t.code)))}catch(t){console.error("Error initializing app:",t)}}componentDidLoad(){if(this.baseurl){a.defaults.baseURL=this.baseurl}if(this.ticket!==""){this.initializeApp()}}async ticketChanged(){sessionStorage.setItem("token",JSON.stringify(this.ticket));this.initializeApp()}handleCloseBookingWindow(){this.bookingItem=null}handleTriggerClicked(){const t=new Date;t.setDate(t.getDate()+1);this.bookingItem={FROM_DATE:this.from_date,defaultDateRange:{fromDate:new Date,fromDateStr:"",toDate:t,toDateStr:"",dateDifference:0,message:""},TO_DATE:this.to_date,EMAIL:"",event_type:"PLUS_BOOKING",ID:"",NAME:"",PHONE:"",REFERENCE_TYPE:"",TITLE:n.entries.Lcz_NewBooking}}render(){return i(s,null,i("ir-toast",null),i("ir-interceptor",null),i("div",{class:"book-container",onClick:this.handleTriggerClicked.bind(this)},i("slot",{name:"trigger"})),this.bookingItem&&i("igl-book-property",{allowedBookingSources:this.calendarData.allowed_booking_sources,adultChildConstraints:this.calendarData.adult_child_constraints,showPaymentDetails:this.showPaymentDetails,countryNodeList:this.countryNodeList,currency:this.calendarData.currency,language:this.language,propertyid:this.propertyid,bookingData:this.bookingItem,onCloseBookingWindow:()=>this.handleCloseBookingWindow()}))}static get watchers(){return{ticket:["ticketChanged"]}}};h.style=r;export{h as igl_book_property_container};
//# sourceMappingURL=p-f5fb3f70.entry.js.map