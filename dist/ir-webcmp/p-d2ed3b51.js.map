{"version":3,"names":["EventsService","constructor","this","bookingService","BookingService","reallocateEvent","pool","destination_pr_id","from_date","to_date","token","JSON","parse","sessionStorage","getItem","console","log","data","axios","post","ExceptionMsg","Error","error","deleteEvent","POOL","My_Result","updateBlockedEvent","bookingEvent","releaseData","getReleaseHoursString","RELEASE_AFTER_HOURS","result","blockUnit","Object","assign","formatDate","FROM_DATE","TO_DATE","pr_id","PR_ID","STAY_STATUS_CODE","OUT_OF_SERVICE","DESCRIPTION","NOTES","OPTIONAL_REASON","date","split","join"],"sources":["src/services/events.service.ts"],"sourcesContent":["import axios from 'axios';\r\nimport { BookingService } from './booking.service';\r\nimport { getReleaseHoursString } from '../utils/utils';\r\n\r\nexport class EventsService {\r\n  private readonly bookingService: BookingService = new BookingService();\r\n\r\n  async reallocateEvent(pool: string, destination_pr_id: number, from_date: string, to_date: string) {\r\n    try {\r\n      const token = JSON.parse(sessionStorage.getItem('token'));\r\n      if (token) {\r\n        console.log(pool, destination_pr_id, from_date, to_date);\r\n        const { data } = await axios.post(`/ReAllocate_Exposed_Room?Ticket=${token}`, { pool, destination_pr_id, from_date, to_date });\r\n        if (data.ExceptionMsg !== '') {\r\n          throw new Error(data.ExceptionMsg);\r\n        }\r\n        console.log(data);\r\n        return data;\r\n      } else {\r\n        throw new Error('Invalid Token');\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  public async deleteEvent(POOL: string) {\r\n    try {\r\n      const token = JSON.parse(sessionStorage.getItem('token'));\r\n      if (token) {\r\n        const { data } = await axios.post(`/UnBlock_Exposed_Unit?Ticket=${token}`, {\r\n          POOL,\r\n        });\r\n        if (data.ExceptionMsg !== '') {\r\n          throw new Error(data.ExceptionMsg);\r\n        }\r\n        return data.My_Result;\r\n      } else {\r\n        throw new Error('Invalid Token');\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n\r\n  public async updateBlockedEvent(bookingEvent: any) {\r\n    try {\r\n      const token = JSON.parse(sessionStorage.getItem('token'));\r\n      if (token) {\r\n        const releaseData = getReleaseHoursString(+bookingEvent.RELEASE_AFTER_HOURS);\r\n        await this.deleteEvent(bookingEvent.POOL);\r\n        const result = await this.bookingService.blockUnit({\r\n          from_date: this.formatDate(bookingEvent.FROM_DATE),\r\n          to_date: this.formatDate(bookingEvent.TO_DATE),\r\n          pr_id: bookingEvent.PR_ID,\r\n          STAY_STATUS_CODE: bookingEvent.OUT_OF_SERVICE ? '004' : bookingEvent.RELEASE_AFTER_HOURS === 0 ? '002' : '003',\r\n          DESCRIPTION: bookingEvent.RELEASE_AFTER_HOURS || '',\r\n          NOTES: bookingEvent.OPTIONAL_REASON || '',\r\n          ...releaseData,\r\n        });\r\n        return result;\r\n      } else {\r\n        throw new Error('Invalid Token');\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  private formatDate(date: string) {\r\n    return date.split('/').join('-');\r\n  }\r\n}\r\n"],"mappings":"mHAIaA,EAAb,WAAAC,GACmBC,KAAAC,eAAiC,IAAIC,C,CAEtD,qBAAMC,CAAgBC,EAAcC,EAA2BC,EAAmBC,GAChF,IACE,MAAMC,EAAQC,KAAKC,MAAMC,eAAeC,QAAQ,UAChD,GAAIJ,EAAO,CACTK,QAAQC,IAAIV,EAAMC,EAAmBC,EAAWC,GAChD,MAAMQ,KAAEA,SAAeC,EAAMC,KAAK,mCAAmCT,IAAS,CAAEJ,OAAMC,oBAAmBC,YAAWC,YACpH,GAAIQ,EAAKG,eAAiB,GAAI,CAC5B,MAAM,IAAIC,MAAMJ,EAAKG,a,CAEvBL,QAAQC,IAAIC,GACZ,OAAOA,C,KACF,CACL,MAAM,IAAII,MAAM,gB,EAElB,MAAOC,GACPP,QAAQO,MAAMA,GACd,MAAM,IAAID,MAAMC,E,EAGb,iBAAMC,CAAYC,GACvB,IACE,MAAMd,EAAQC,KAAKC,MAAMC,eAAeC,QAAQ,UAChD,GAAIJ,EAAO,CACT,MAAMO,KAAEA,SAAeC,EAAMC,KAAK,gCAAgCT,IAAS,CACzEc,SAEF,GAAIP,EAAKG,eAAiB,GAAI,CAC5B,MAAM,IAAIC,MAAMJ,EAAKG,a,CAEvB,OAAOH,EAAKQ,S,KACP,CACL,MAAM,IAAIJ,MAAM,gB,EAElB,MAAOC,GACPP,QAAQC,IAAIM,GACZ,MAAM,IAAID,MAAMC,E,EAIb,wBAAMI,CAAmBC,GAC9B,IACE,MAAMjB,EAAQC,KAAKC,MAAMC,eAAeC,QAAQ,UAChD,GAAIJ,EAAO,CACT,MAAMkB,EAAcC,GAAuBF,EAAaG,2BAClD5B,KAAKqB,YAAYI,EAAaH,MACpC,MAAMO,QAAe7B,KAAKC,eAAe6B,UAASC,OAAAC,OAAA,CAChD1B,UAAWN,KAAKiC,WAAWR,EAAaS,WACxC3B,QAASP,KAAKiC,WAAWR,EAAaU,SACtCC,MAAOX,EAAaY,MACpBC,iBAAkBb,EAAac,eAAiB,MAAQd,EAAaG,sBAAwB,EAAI,MAAQ,MACzGY,YAAaf,EAAaG,qBAAuB,GACjDa,MAAOhB,EAAaiB,iBAAmB,IACpChB,IAEL,OAAOG,C,KACF,CACL,MAAM,IAAIV,MAAM,gB,EAElB,MAAOC,GACPP,QAAQO,MAAMA,GACd,MAAM,IAAID,MAAMC,E,EAGZ,UAAAa,CAAWU,GACjB,OAAOA,EAAKC,MAAM,KAAKC,KAAK,I"}