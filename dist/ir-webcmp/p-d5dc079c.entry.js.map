{"version":3,"names":["irHousekeepingCss","IrHousekeeping","this","roomService","RoomService","houseKeepingService","HouseKeepingService","componentWillLoad","baseurl","axios","defaults","baseURL","ticket","setToken","updateHKStore","token","property_id","propertyid","language","initializeApp","handleResetData","e","stopImmediatePropagation","stopPropagation","getExposedHKSetup","ticketChanged","newValue","oldValue","isLoading","Promise","all","fetchData","fetchLanguage","error","console","render","h","Host","class"],"sources":["src/components/ir-housekeeping/ir-housekeeping.css?tag=ir-housekeeping&encapsulation=scoped","src/components/ir-housekeeping/ir-housekeeping.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n}\r\n","import { HouseKeepingService } from '@/services/housekeeping.service';\r\nimport { RoomService } from '@/services/room.service';\r\nimport { updateHKStore } from '@/stores/housekeeping.store';\r\nimport { Component, Host, Listen, Prop, State, Watch, h } from '@stencil/core';\r\nimport axios from 'axios';\r\n\r\n@Component({\r\n  tag: 'ir-housekeeping',\r\n  styleUrl: 'ir-housekeeping.css',\r\n  scoped: true,\r\n})\r\nexport class IrHousekeeping {\r\n  @Prop() language: string = '';\r\n  @Prop() ticket: string = '';\r\n  @Prop() baseurl: string = '';\r\n  @Prop() propertyid: number;\r\n\r\n  @State() isLoading = false;\r\n\r\n  private roomService = new RoomService();\r\n  private houseKeepingService = new HouseKeepingService();\r\n\r\n  componentWillLoad() {\r\n    if (this.baseurl) {\r\n      axios.defaults.baseURL = this.baseurl;\r\n    }\r\n    if (this.ticket !== '') {\r\n      this.roomService.setToken(this.ticket);\r\n      this.houseKeepingService.setToken(this.ticket);\r\n      updateHKStore('default_properties', { token: this.ticket, property_id: this.propertyid, language: this.language });\r\n      this.initializeApp();\r\n    }\r\n  }\r\n  @Listen('resetData')\r\n  async handleResetData(e: CustomEvent) {\r\n    e.stopImmediatePropagation();\r\n    e.stopPropagation();\r\n    await this.houseKeepingService.getExposedHKSetup(this.propertyid);\r\n  }\r\n  @Watch('ticket')\r\n  async ticketChanged(newValue: string, oldValue: string) {\r\n    if (newValue !== oldValue) {\r\n      this.roomService.setToken(this.ticket);\r\n      this.houseKeepingService.setToken(this.ticket);\r\n      updateHKStore('default_properties', { token: this.ticket, property_id: this.propertyid, language: this.language });\r\n      this.initializeApp();\r\n    }\r\n  }\r\n\r\n  async initializeApp() {\r\n    try {\r\n      this.isLoading = true;\r\n      await Promise.all([\r\n        this.houseKeepingService.getExposedHKSetup(this.propertyid),\r\n        this.roomService.fetchData(this.propertyid, this.language),\r\n        this.roomService.fetchLanguage(this.language, ['_HK_FRONT']),\r\n      ]);\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  render() {\r\n    if (this.isLoading) {\r\n      return <ir-loading-screen></ir-loading-screen>;\r\n    }\r\n    return (\r\n      <Host>\r\n        <ir-interceptor></ir-interceptor>\r\n        <ir-toast></ir-toast>\r\n        <section class=\"p-1\">\r\n          <ir-unit-status class=\"mb-1\"></ir-unit-status>\r\n          <ir-hk-team class=\"mb-1\"></ir-hk-team>\r\n        </section>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"6OAAA,MAAMA,EAAoB,uC,MCWbC,EAAc,M,yBAQjBC,KAAAC,YAAc,IAAIC,EAClBF,KAAAG,oBAAsB,IAAIC,E,cARP,G,YACF,G,aACC,G,yCAGL,K,CAKrB,iBAAAC,GACE,GAAIL,KAAKM,QAAS,CAChBC,EAAMC,SAASC,QAAUT,KAAKM,O,CAEhC,GAAIN,KAAKU,SAAW,GAAI,CACtBV,KAAKC,YAAYU,SAASX,KAAKU,QAC/BV,KAAKG,oBAAoBQ,SAASX,KAAKU,QACvCE,EAAc,qBAAsB,CAAEC,MAAOb,KAAKU,OAAQI,YAAad,KAAKe,WAAYC,SAAUhB,KAAKgB,WACvGhB,KAAKiB,e,EAIT,qBAAMC,CAAgBC,GACpBA,EAAEC,2BACFD,EAAEE,wBACIrB,KAAKG,oBAAoBmB,kBAAkBtB,KAAKe,W,CAGxD,mBAAMQ,CAAcC,EAAkBC,GACpC,GAAID,IAAaC,EAAU,CACzBzB,KAAKC,YAAYU,SAASX,KAAKU,QAC/BV,KAAKG,oBAAoBQ,SAASX,KAAKU,QACvCE,EAAc,qBAAsB,CAAEC,MAAOb,KAAKU,OAAQI,YAAad,KAAKe,WAAYC,SAAUhB,KAAKgB,WACvGhB,KAAKiB,e,EAIT,mBAAMA,GACJ,IACEjB,KAAK0B,UAAY,WACXC,QAAQC,IAAI,CAChB5B,KAAKG,oBAAoBmB,kBAAkBtB,KAAKe,YAChDf,KAAKC,YAAY4B,UAAU7B,KAAKe,WAAYf,KAAKgB,UACjDhB,KAAKC,YAAY6B,cAAc9B,KAAKgB,SAAU,CAAC,e,CAEjD,MAAOe,GACPC,QAAQD,MAAMA,E,SAEd/B,KAAK0B,UAAY,K,EAGrB,MAAAO,GACE,GAAIjC,KAAK0B,UAAW,CAClB,OAAOQ,EAAA,yB,CAET,OACEA,EAACC,EAAI,KACHD,EAAA,uBACAA,EAAA,iBACAA,EAAA,WAASE,MAAM,OACbF,EAAA,kBAAgBE,MAAM,SACtBF,EAAA,cAAYE,MAAM,U"}