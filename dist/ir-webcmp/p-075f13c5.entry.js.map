{"version":3,"names":["iglCalBodyCss","IglCalBody","this","selectedRooms","fromRoomId","currentDate","Date","componentWillLoad","setHours","dragOverHighlightElementHandler","event","dragOverElement","detail","gotoRoom","roomId","category","getRoomCategoryByRoomId","expanded","toggleCategory","setTimeout","scrollToRoom","addToBeAssignedEvents","addBookingDatas","data","renderElement","scrollPageToRoom","emit","key","id","refClass","calendarData","roomsInfo","find","roomCategory","getCategoryRooms","room","getRoomId","getCategoryName","name","getCategoryId","getTotalPhysicalRooms","length","physicalrooms","getRoomName","roomInfo","getRoomById","physicalRooms","physical_room","getBookingData","bookingEvents","aData","addBookingDatasEvent","getSelectedCellRefName","selectedDay","getSplitBookingEvents","newEvent","console","log","FROM_DATE","some","bookingEvent","includes","STATUS_CODE","getTime","TO_DATE","closeWindow","ind","findIndex","ev","ID","splice","addNewEvent","keys","Object","startDate","endDate","NAME","h","EMAIL","PHONE","convertBooking","REFERENCE_TYPE","getFullYear","getTwoDigitNumStr","getMonth","getDate","BALANCE","NOTES","RELEASE_AFTER_HOURS","PR_ID","ENTRY_DATE","NO_OF_DAYS","ADULTS_COUNT","COUNTRY","INTERNAL_NOTE","RATE","TOTAL_PRICE","RATE_PLAN","ARRIVAL_TIME","TITLE","locales","entries","Lcz_NewBookingFor","CATEGORY","event_type","STATUS","defaultDateRange","fromDate","fromDateStr","toDate","toDateStr","dateDifference","editable","message","popupTitle","BLOCK_DATES_TITLE","Lcz_BlockDatesFor","getDateStr","toISOString","legendData","formattedLegendData","splitBookingEvents","push","num","date","locale","toLocaleString","month","removeNewEvent","filter","events","clickCell","isScrollViewDragging","refKey","hasOwnProperty","assign","showNewBookingPopup","renderAgain","getGeneralCategoryDayColumns","addClass","isCategory","index","calendar_dates","days","map","dayInfo","class","day","today","rate","exposed_inventory","rts","getGeneralRoomDayColumns","onClick","getRoomCategoryRow","xmlns","viewBox","height","width","fill","d","getRoomsByCategory","_a","getRoomRows","is_active","render","Host","language","is_vacation_rental","countryNodeList","currency","allBookingEvents","iglCalFooterCss","IglCalFooter","handleOptionEvent","optionEvent","Lcz_Legend","dayDisplayName","iglCalHeaderCss","IglCalHeader","searchValue","searchList","roomsList","toBeAssignedService","ToBeAssignedService","initializeRoomsList","unassignedDates","fetchAndAssignUnassignedRooms","error","handleCalendarDataChanged","forEach","concat","assignRoomsToDate","dt","setMinutes","setSeconds","selectedDate","moment","format","result","getUnassignedRooms","propertyid","dateToFormattedString","unassignedRoomsNumber","add","renderView","handleReduceAvailableUnitEvent","stopImmediatePropagation","stopPropagation","showToBeAssigned","gotoToBeAssignedDate","handleDateSelect","handleClearSearch","handleFilterRooms","inputElement","target","value","trim","toLowerCase","toLocaleLowerCase","indexOf","handleScrollToRoom","gotoRoomEvent","getStringDateFormat","getNewBookingModel","from_date","setDate","to_date","Lcz_NewBooking","editabled","title","Lcz_UnassignedUnitsTooltip","Lcz_Navigate","minDate","startOf","autoApply","singleDatePicker","onDateChanged","evt","Lcz_Today","Lcz_CreateNewBooking","type","placeholder","Lcz_FindUnit","onInput","monthsInfo","monthInfo","style","daysCount","monthName","unassigned_units_nbr","occupancy","iglLegendsCss","IglLegends","legendInfo","design","backgroundColor","color","Lcz_MonthAndYear","Lcz_UnassignedUnits","Lcz_Date","Lcz_Occupancy","Lcz_TotalAvailability","iglToBeAssignedCss","IglToBeAssigned","isGotoToBeAssignedDate","isLoading","categoriesData","reArrangeData","loadingMessage","Lcz_FetchingUnAssignedUnits","handleUnassignedDatesToBeAssignedChange","newValue","orderedDatesList","sort","a","b","parseInt","showForDate","handleAssignUnit","opt","categories","RT_ID","eventData","assignEvent","updateCategories","categorisedRooms","roomIds","getUnassignedDates","componentDidLoad","firstKey","gotoDate","showDatesList","dateStamp","withLoading","showUnassignedDate","addToBeAssignedEvent","showBookingPopup","getDay","dayOfWeek","getLocalizedDayOfWeek","options","weekday","toLocaleDateString","highlightToBeAssignedBookingEvent","bookingId","getToBeAssignedEntities","getCategoryView","eventDatas","categoryId","categoryIndex","onAssignUnitEvent","Lcz_Assignments","onIconClickHandler","slot","Lcz_AllBookingsAreAssigned","Fragment","dateStr","ordDate","Lcz_AllAssignForThisDay","irBookingDetailsCss","IrBookingDetails","bookingService","BookingService","roomService","RoomService","baseurl","axios","defaults","baseURL","ticket","initializeApp","ticketChanged","sessionStorage","setItem","JSON","stringify","setRoomsData","roomServiceResp","roomsData","Array","_b","My_Result","roomtypes","roomResponse","languageTexts","countriesList","bookingDetails","Promise","all","fetchData","fetchLanguage","getCountries","getExposedBooking","bookingNumber","direction","defaultTexts","allowed_payment_methods","paymentMethods","allowed_booking_sources","adult_child_constraints","calendar_legends","paymentCodesToShow","showPaymentDetails","method","code","guestData","guest","bookingData","rerenderFlag","handleIconClick","e","sidebarState","window","open","system_id","location","href","bookingItem","last_name","email","mobile","ARRIVAL","arrival","Lcz_AddingUnitToBooking","booking_nbr","BOOKING_NUMBER","ADD_ROOM_TO_BOOKING","GUEST","remark","SOURCE","source","ROOMS","rooms","handleEditSidebar","handleSelectChange","tempStatus","selectedValue","handleClick","targetID","updateStatus","resetBookingData","openEditSidebar","sidebar","document","querySelector","_calculateNights","diff","isUpdateClicked","post","book_nbr","status","toast","description","Lcz_StatusUpdatedSuccessfully","position","Lcz_SelectStatus","handleEditInitiated","handleCloseBookingWindow","handleDeleteFinish","identifier","booking","handleResetBookingData","confirmationBG","Lcz_Booking","_formatDate","booked_on","_formatTime","hour","toString","minute","allowed_actions","selectContainerStyle","selectStyles","firstOption","Lcz_Select","size","text","textSize","btn_styles","btn_disabled","hasReceipt","stroke","hasPrint","icon","hasDelete","hasMenu","property","label","Lcz_Source","origin","Label","imageSrc","Icon","Lcz_BookedBy","first_name","iconShown","Lcz_Phone","Lcz_Email","alternative_email","Lcz_AlternativeEmail","Lcz_Address","address","Lcz_ArrivalTime","Lcz_Note","Lcz_Nights","Lcz_Night","hasRoomAdd","is_direct","mealCodeName","rateplan","myRoomTypeFoodCat","roomtype","hasRoomEdit","hasRoomDelete","hasCheckIn","hasCheckOut","bookingIndex","onDeleteFinished","bind","calendar_data","pickup_service","is_enabled","Lcz_Pickup","pickup_info","Lcz_Time","Lcz_DueUponBooking","symbol","total","Lcz_FlightDetails","details","selected_option","vehicle","Lcz_NbrOfVehicles","nbr_of_units","pickup_instruction","pickup_cancelation_prepayment","side","onIrSidebarToggle","showCloseButton","onCloseSideBar","defaultPickupData","numberOfPersons","adult_nbr","children_nbr","onCloseModal","allowedBookingSources","adultChildConstraints","onCloseBookingWindow","irInterceptorCss","IrInterceptor","errorMessage","setupAxiosInterceptors","interceptors","request","use","handleRequest","handleError","response","handleResponse","extractEndpoint","url","split","isHandledEndpoint","handledEndpoints","config","fetchingIrInterceptorDataStatus","defaultMessage","isUnassignedUnit","showToast","ExceptionMsg","Error","hideToastAfterDelay","reject","isShown","isSuccess","delay","renderMessage","irRoomNightsCss","IrRoomNights","baseUrl","init","isButtonDisabled","rates","amount","inventory","filteredRooms","selectedRoom","lastDay","isSame","fetchBookingAvailability","selected_variation","adult_child_offering","newDatesArr","getDaysArray","isEndDateBeforeFromDate","defaultTotalNights","handleInput","inputValue","replace","decimalCheck","substring","isNaN","Number","rate_plan_id","initialLoading","bookingAvailability","getBookingAvailability","propertyId","adult","child","child_nbr","rate_plan_index","rateplans","variations","variation","renderInputField","currency_symbol","disabled","v4","Lcz_Rate","renderReadOnlyField","toFixed","renderRateFields","renderDates","getCurrencySymbol","convertDatePrice","handleRoomConfirmation","oldRooms","selectedRoomIndex","body","assign_units","check_in","is_pms","closeRoomNightsDialog","pool","Lcz_Loading","Lcz_AddingRoomNightsTo","_c","unit","formatDate","is_non_refundable","Lcz_NonRefundable","Lcz_NoAvailabilityForAdditionalNights","custom_text","Lcz_Cancel","Lcz_Confirm","irToastCss","IrToast","duration","toastBody","applyStyles","toastRef","onToast","setToastTimeout","showToastTimeOut","hideToast","clearToastTimeout","clearTimeout","undefined","setAttribute","opacity","isVisible","disconnectedCallback","renderIcon","role","ref","el"],"sources":["src/components/igloo-calendar/igl-cal-body/igl-cal-body.css?tag=igl-cal-body&encapsulation=scoped","src/components/igloo-calendar/igl-cal-body/igl-cal-body.tsx","src/components/igloo-calendar/igl-cal-footer/igl-cal-footer.css?tag=igl-cal-footer&encapsulation=scoped","src/components/igloo-calendar/igl-cal-footer/igl-cal-footer.tsx","src/components/igloo-calendar/igl-cal-header/igl-cal-header.css?tag=igl-cal-header&encapsulation=scoped","src/components/igloo-calendar/igl-cal-header/igl-cal-header.tsx","src/components/igloo-calendar/igl-legends/igl-legends.css?tag=igl-legends&encapsulation=scoped","src/components/igloo-calendar/igl-legends/igl-legends.tsx","src/components/igloo-calendar/igl-to-be-assigned/igl-to-be-assigned.css?tag=igl-to-be-assigned&encapsulation=scoped","src/components/igloo-calendar/igl-to-be-assigned/igl-to-be-assigned.tsx","src/components/ir-booking-details/ir-booking-details.css?tag=ir-booking-details&encapsulation=scoped","src/components/ir-booking-details/ir-booking-details.tsx","src/components/ir-interceptor/ir-interceptor.css?tag=ir-interceptor&encapsulation=scoped","src/components/ir-interceptor/ir-interceptor.tsx","src/components/ir-room-nights/ir-room-nights.css?tag=ir-room-nights&encapsulation=scoped","src/components/ir-room-nights/ir-room-nights.tsx","src/components/ir-toast/ir-toast.css?tag=ir-toast&encapsulation=scoped","src/components/ir-toast/ir-toast.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n}\r\n\r\n.bodyContainer {\r\n  position: relative;\r\n}\r\n\r\n.roomRow {\r\n  width: max-content;\r\n}\r\n\r\n.roomRow:first-child {\r\n  margin-top: 80px;\r\n}\r\n.categoryName {\r\n  font-weight: bold;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n\r\n.cellData {\r\n  width: 70px;\r\n  height: 30px;\r\n  display: inline-grid;\r\n  border-top: 1px solid #e0e0e0;\r\n  border-left: 1px solid #e0e0e0;\r\n  vertical-align: top;\r\n}\r\n\r\n.cellData:nth-child(2) {\r\n  border-left: 0px;\r\n}\r\n\r\n.cellData:last-child {\r\n  border-right: 1px solid #e0e0e0;\r\n}\r\n\r\n.roomHeaderCell {\r\n  position: -webkit-sticky;\r\n  position: sticky;\r\n  left: 0;\r\n  background: #fff;\r\n  border-right: 1px solid #ccc;\r\n  width: 170px;\r\n  z-index: 1;\r\n}\r\n\r\n.currentDay {\r\n  background-color: #e3f3fa;\r\n}\r\n\r\n.dragOverHighlight {\r\n  background-color: #f5f5dc !important;\r\n}\r\n\r\n.selectedDay {\r\n  background-color: #f9f9c9 !important;\r\n}\r\n\r\n.categoryTitle {\r\n  grid-template-columns: 1fr 20px;\r\n  padding-left: 10px;\r\n  cursor: pointer;\r\n  height: 40px;\r\n  font-size: 0.9em;\r\n}\r\n.categoryTitle > :nth-child(1) {\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n.roomTitle {\r\n  padding-left: 20px;\r\n  font-size: 0.9em;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n\r\n.roomTitle > :nth-child(1) {\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n.roomTitle.pl10 {\r\n  padding-left: 10px;\r\n}\r\n\r\n.categoryPriceColumn {\r\n  align-items: center;\r\n  height: 40px;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n}\r\n\r\n/* BOOKING EVENT */\r\n.bookingEventsContainer {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n}\r\n","import { Component, Host, Listen, Prop, State, h, Event, EventEmitter } from '@stencil/core';\r\nimport calendar_dates from '@/stores/calendar-dates.store';\r\nimport locales from '@/stores/locales.store';\r\n@Component({\r\n  tag: 'igl-cal-body',\r\n  styleUrl: 'igl-cal-body.css',\r\n  scoped: true,\r\n})\r\nexport class IglCalBody {\r\n  @Event() showBookingPopup: EventEmitter;\r\n  @Event({ bubbles: true, composed: true }) scrollPageToRoom: EventEmitter;\r\n  @Prop() isScrollViewDragging: boolean;\r\n  @Prop() calendarData: { [key: string]: any };\r\n  @Prop() today: String;\r\n  @Prop() currency;\r\n  @Prop() language: string;\r\n  @Prop() countryNodeList;\r\n  @State() dragOverElement: string = '';\r\n  @State() renderAgain: boolean = false;\r\n  @Event() addBookingDatasEvent: EventEmitter<any[]>;\r\n\r\n  private selectedRooms: { [key: string]: any } = {};\r\n  private fromRoomId: number = -1;\r\n  private newEvent: { [key: string]: any };\r\n  private currentDate = new Date();\r\n\r\n  componentWillLoad() {\r\n    this.currentDate.setHours(0, 0, 0, 0);\r\n  }\r\n\r\n  @Listen('dragOverHighlightElement', { target: 'window' })\r\n  dragOverHighlightElementHandler(event: CustomEvent) {\r\n    this.dragOverElement = event.detail.dragOverElement;\r\n  }\r\n\r\n  @Listen('gotoRoomEvent', { target: 'window' })\r\n  gotoRoom(event: CustomEvent) {\r\n    let roomId = event.detail.roomId;\r\n    let category = this.getRoomCategoryByRoomId(roomId);\r\n    if (!category.expanded) {\r\n      this.toggleCategory(category);\r\n      setTimeout(() => {\r\n        this.scrollToRoom(roomId);\r\n      }, 10);\r\n    } else {\r\n      this.scrollToRoom(roomId);\r\n    }\r\n  }\r\n\r\n  @Listen('addToBeAssignedEvent', { target: 'window' })\r\n  addToBeAssignedEvents(event: CustomEvent) {\r\n    // let roomId = event.detail.roomId;\r\n    this.addBookingDatas(event.detail.data);\r\n    this.renderElement();\r\n  }\r\n\r\n  scrollToRoom(roomId) {\r\n    this.scrollPageToRoom.emit({\r\n      key: 'scrollPageToRoom',\r\n      id: roomId,\r\n      refClass: 'room_' + roomId,\r\n    });\r\n  }\r\n\r\n  getRoomCategoryByRoomId(roomId) {\r\n    return this.calendarData.roomsInfo.find(roomCategory => {\r\n      return this.getCategoryRooms(roomCategory).find(room => this.getRoomId(room) === roomId);\r\n    });\r\n  }\r\n\r\n  getCategoryName(roomCategory) {\r\n    return roomCategory.name;\r\n  }\r\n\r\n  getCategoryId(roomCategory) {\r\n    return roomCategory.id;\r\n  }\r\n\r\n  getTotalPhysicalRooms(roomCategory) {\r\n    return this.getCategoryRooms(roomCategory).length;\r\n  }\r\n\r\n  getCategoryRooms(roomCategory) {\r\n    return (roomCategory && roomCategory.physicalrooms) || [];\r\n  }\r\n\r\n  getRoomName(roomInfo) {\r\n    return roomInfo.name;\r\n  }\r\n\r\n  getRoomId(roomInfo) {\r\n    return roomInfo.id;\r\n  }\r\n\r\n  getRoomById(physicalRooms, roomId) {\r\n    return physicalRooms.find(physical_room => this.getRoomId(physical_room) === roomId);\r\n  }\r\n\r\n  getBookingData() {\r\n    return this.calendarData.bookingEvents;\r\n  }\r\n\r\n  addBookingDatas(aData) {\r\n    this.addBookingDatasEvent.emit(aData);\r\n  }\r\n\r\n  getSelectedCellRefName(roomId, selectedDay) {\r\n    return 'room_' + roomId + '_' + selectedDay.currentDate;\r\n  }\r\n\r\n  // getSplitBookingEvents(newEvent) {\r\n  //   return this.getBookingData().some(bookingEvent => !['003', '002', '004'].includes(bookingEvent.STATUS_CODE) && newEvent.FROM_DATE === bookingEvent.FROM_DATE);\r\n  // }\r\n  getSplitBookingEvents(newEvent) {\r\n    console.log(newEvent.FROM_DATE);\r\n    return this.getBookingData().some(bookingEvent => {\r\n      if (!['003', '002', '004'].includes(bookingEvent.STATUS_CODE)) {\r\n        if (\r\n          new Date(newEvent.FROM_DATE).getTime() >= new Date(bookingEvent.FROM_DATE).getTime() &&\r\n          new Date(newEvent.FROM_DATE).getTime() <= new Date(bookingEvent.TO_DATE).getTime()\r\n        ) {\r\n          return bookingEvent;\r\n        }\r\n      }\r\n    });\r\n  }\r\n  @Listen('closeBookingWindow', { target: 'window' })\r\n  closeWindow() {\r\n    let ind = this.getBookingData().findIndex(ev => ev.ID === 'NEW_TEMP_EVENT');\r\n    if (ind !== -1) {\r\n      this.getBookingData().splice(ind, 1);\r\n      console.log('removed item..');\r\n      this.renderElement();\r\n    }\r\n  }\r\n\r\n  addNewEvent(roomCategory) {\r\n    let keys = Object.keys(this.selectedRooms);\r\n    let startDate, endDate;\r\n\r\n    if (this.selectedRooms[keys[0]].currentDate < this.selectedRooms[keys[1]].currentDate) {\r\n      startDate = new Date(this.selectedRooms[keys[0]].currentDate);\r\n      endDate = new Date(this.selectedRooms[keys[1]].currentDate);\r\n    } else {\r\n      startDate = new Date(this.selectedRooms[keys[1]].currentDate);\r\n      endDate = new Date(this.selectedRooms[keys[0]].currentDate);\r\n    }\r\n\r\n    this.newEvent = {\r\n      ID: 'NEW_TEMP_EVENT',\r\n      NAME: <span>&nbsp;</span>,\r\n      EMAIL: '',\r\n      PHONE: '',\r\n      convertBooking: false,\r\n      REFERENCE_TYPE: 'PHONE',\r\n      FROM_DATE: startDate.getFullYear() + '-' + this.getTwoDigitNumStr(startDate.getMonth() + 1) + '-' + this.getTwoDigitNumStr(startDate.getDate()),\r\n      TO_DATE: endDate.getFullYear() + '-' + this.getTwoDigitNumStr(endDate.getMonth() + 1) + '-' + this.getTwoDigitNumStr(endDate.getDate()),\r\n      BALANCE: '',\r\n      NOTES: '',\r\n      RELEASE_AFTER_HOURS: 0,\r\n      PR_ID: this.selectedRooms[keys[0]].roomId,\r\n      ENTRY_DATE: '',\r\n      NO_OF_DAYS: (endDate - startDate) / 86400000,\r\n      ADULTS_COUNT: 1,\r\n      COUNTRY: '',\r\n      INTERNAL_NOTE: '',\r\n      RATE: '',\r\n      TOTAL_PRICE: '',\r\n      RATE_PLAN: '',\r\n      ARRIVAL_TIME: '',\r\n      TITLE: locales.entries.Lcz_NewBookingFor,\r\n      roomsInfo: [roomCategory],\r\n      CATEGORY: roomCategory.name,\r\n      event_type: 'BAR_BOOKING',\r\n      STATUS: 'TEMP-EVENT',\r\n      defaultDateRange: {\r\n        fromDate: null,\r\n        fromDateStr: '',\r\n        toDate: null,\r\n        toDateStr: '',\r\n        dateDifference: (endDate - startDate) / 86400000,\r\n        editable: false,\r\n        message: 'Including 5.00% City Tax - Excluding 11.00% VAT',\r\n      },\r\n    };\r\n\r\n    let popupTitle = roomCategory.name + ' ' + this.getRoomName(this.getRoomById(this.getCategoryRooms(roomCategory), this.selectedRooms[keys[0]].roomId));\r\n    this.newEvent.BLOCK_DATES_TITLE = locales.entries.Lcz_BlockDatesFor + popupTitle;\r\n    this.newEvent.TITLE += popupTitle;\r\n    this.newEvent.defaultDateRange.toDate = new Date(this.newEvent.TO_DATE + 'T00:00:00');\r\n    this.newEvent.defaultDateRange.fromDate = new Date(this.newEvent.FROM_DATE + 'T00:00:00');\r\n    this.newEvent.defaultDateRange.fromDateStr = this.getDateStr(this.newEvent.defaultDateRange.fromDate);\r\n    this.newEvent.defaultDateRange.toDateStr = this.getDateStr(this.newEvent.defaultDateRange.toDate);\r\n    this.newEvent.ENTRY_DATE = new Date().toISOString();\r\n    this.newEvent.legendData = this.calendarData.formattedLegendData;\r\n\r\n    let splitBookingEvents = this.getSplitBookingEvents(this.newEvent);\r\n    if (splitBookingEvents) {\r\n      this.newEvent.splitBookingEvents = splitBookingEvents;\r\n    }\r\n\r\n    this.getBookingData().push(this.newEvent);\r\n    return this.newEvent;\r\n  }\r\n\r\n  getTwoDigitNumStr(num) {\r\n    return num <= 9 ? '0' + num : num;\r\n  }\r\n\r\n  getDateStr(date, locale = 'default') {\r\n    return date.getDate() + ' ' + date.toLocaleString(locale, { month: 'short' }) + ' ' + date.getFullYear();\r\n  }\r\n\r\n  removeNewEvent() {\r\n    this.calendarData.bookingEvents = this.calendarData.bookingEvents.filter(events => events.ID !== 'NEW_TEMP_EVENT');\r\n    this.newEvent = null;\r\n  }\r\n\r\n  clickCell(roomId, selectedDay, roomCategory) {\r\n    if (!this.isScrollViewDragging && selectedDay.currentDate >= this.currentDate.getTime()) {\r\n      let refKey = this.getSelectedCellRefName(roomId, selectedDay);\r\n      if (this.selectedRooms.hasOwnProperty(refKey)) {\r\n        this.removeNewEvent();\r\n        delete this.selectedRooms[refKey];\r\n        this.renderElement();\r\n        return;\r\n      } else if (Object.keys(this.selectedRooms).length != 1 || this.fromRoomId != roomId) {\r\n        this.removeNewEvent();\r\n        this.selectedRooms = {};\r\n        this.selectedRooms[refKey] = { ...selectedDay, roomId };\r\n        this.fromRoomId = roomId;\r\n        this.renderElement();\r\n      } else {\r\n        // create bar;\r\n        this.selectedRooms[refKey] = { ...selectedDay, roomId };\r\n        this.addNewEvent(roomCategory);\r\n        this.selectedRooms = {};\r\n        this.renderElement();\r\n        this.showNewBookingPopup(this.newEvent);\r\n      }\r\n    }\r\n  }\r\n\r\n  showNewBookingPopup(data) {\r\n    console.log(data);\r\n    // this.showBookingPopup.emit({key: \"add\", data});\r\n  }\r\n\r\n  renderElement() {\r\n    this.renderAgain = !this.renderAgain;\r\n  }\r\n\r\n  getGeneralCategoryDayColumns(addClass: string, isCategory: boolean = false, index: number) {\r\n    return calendar_dates.days.map(dayInfo => {\r\n      return (\r\n        <div class={`cellData  font-weight-bold categoryPriceColumn ${addClass + '_' + dayInfo.day} ${dayInfo.day === this.today ? 'currentDay' : ''}`}>\r\n          {isCategory ? (\r\n            <span class={'categoryName'}>\r\n              {dayInfo.rate[index].exposed_inventory.rts}\r\n              {/* <br />\r\n              {dayInfo.rate[index].exposed_inventory.offline} */}\r\n            </span>\r\n          ) : (\r\n            ''\r\n          )}\r\n        </div>\r\n      );\r\n    });\r\n  }\r\n\r\n  getGeneralRoomDayColumns(roomId: string, roomCategory) {\r\n    // onDragOver={event => this.handleDragOver(event)} onDrop={event => this.handleDrop(event, addClass+\"_\"+dayInfo.day)}\r\n    return this.calendarData.days.map(dayInfo => (\r\n      <div\r\n        class={`cellData ${'room_' + roomId + '_' + dayInfo.day} ${dayInfo.day === this.today ? 'currentDay' : ''} ${\r\n          this.dragOverElement === roomId + '_' + dayInfo.day ? 'dragOverHighlight' : ''\r\n        } ${this.selectedRooms.hasOwnProperty(this.getSelectedCellRefName(roomId, dayInfo)) ? 'selectedDay' : ''}`}\r\n        onClick={() => this.clickCell(roomId, dayInfo, roomCategory)}\r\n      ></div>\r\n    ));\r\n  }\r\n\r\n  toggleCategory(roomCategory) {\r\n    roomCategory.expanded = !roomCategory.expanded;\r\n    this.renderElement();\r\n  }\r\n\r\n  getRoomCategoryRow(roomCategory, index) {\r\n    if (this.getTotalPhysicalRooms(roomCategory) <= 1) {\r\n      return null;\r\n    }\r\n    return (\r\n      <div class=\"roomRow\">\r\n        <div\r\n          class={`cellData text-left align-items-center roomHeaderCell categoryTitle ${'category_' + this.getCategoryId(roomCategory)}`}\r\n          onClick={() => this.toggleCategory(roomCategory)}\r\n        >\r\n          <div class={'categoryName'}>{this.getCategoryName(roomCategory)}</div>\r\n\r\n          {roomCategory.expanded ? (\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" height={14} width={14}>\r\n              <path\r\n                fill=\"#6b6f82\"\r\n                d=\"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z\"\r\n              />\r\n            </svg>\r\n          ) : (\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 320 512\" height={14} width={14}>\r\n              <path\r\n                fill=\"#6b6f82\"\r\n                d=\"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z\"\r\n              />\r\n            </svg>\r\n          )}\r\n          {/* <i class={`la la-angle-${roomCategory.expanded ? 'down' : 'right'}`}></i> */}\r\n        </div>\r\n        {this.getGeneralCategoryDayColumns('category_' + this.getCategoryId(roomCategory), true, index)}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getRoomsByCategory(roomCategory) {\r\n    // Check accordion is expanded.\r\n    if (!roomCategory.expanded) {\r\n      return [];\r\n    }\r\n\r\n    return this.getCategoryRooms(roomCategory)?.map(room => (\r\n      <div class=\"roomRow\">\r\n        <div\r\n          class={`cellData text-left align-items-center roomHeaderCell  roomTitle ${this.getTotalPhysicalRooms(roomCategory) <= 1 ? 'pl10' : ''} ${'room_' + this.getRoomId(room)}`}\r\n          data-room={this.getRoomId(room)}\r\n        >\r\n          <div>{this.getTotalPhysicalRooms(roomCategory) <= 1 ? this.getCategoryName(roomCategory) : this.getRoomName(room)}</div>\r\n        </div>\r\n        {this.getGeneralRoomDayColumns(this.getRoomId(room), roomCategory)}\r\n      </div>\r\n    ));\r\n  }\r\n\r\n  getRoomRows() {\r\n    return this.calendarData.roomsInfo.map((roomCategory, index) => {\r\n      if (roomCategory.is_active) {\r\n        return [this.getRoomCategoryRow(roomCategory, index), this.getRoomsByCategory(roomCategory)];\r\n      } else {\r\n        return null;\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    // onDragStart={event => this.handleDragStart(event)} draggable={true}\r\n    return (\r\n      <Host>\r\n        <div class=\"bodyContainer\">\r\n          {this.getRoomRows()}\r\n          <div class=\"bookingEventsContainer preventPageScroll\">\r\n            {this.getBookingData()?.map(bookingEvent => (\r\n              <igl-booking-event\r\n                language={this.language}\r\n                is_vacation_rental={this.calendarData.is_vacation_rental}\r\n                countryNodeList={this.countryNodeList}\r\n                currency={this.currency}\r\n                data-component-id={bookingEvent.ID}\r\n                bookingEvent={bookingEvent}\r\n                allBookingEvents={this.getBookingData()}\r\n              ></igl-booking-event>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n  position: sticky;\r\n  bottom: 0;\r\n  width: max-content;\r\n  z-index: 3;\r\n}\r\n\r\n.footerCell {\r\n  display: -moz-inline-grid;\r\n  display: -ms-inline-grid;\r\n  display: inline-grid;\r\n  position: -webkit-sticky;\r\n  position: sticky;\r\n  bottom: 0;\r\n  width: 70px;\r\n  height: 40px;\r\n  /* color: #b8b6b7; */\r\n  background: #fff;\r\n  vertical-align: top;\r\n  border-top: 1px solid #e0e0e0;\r\n}\r\n\r\n.bottomLeftCell {\r\n  left: -1px;\r\n  z-index: 2;\r\n  width: 170px;\r\n  text-align: left;\r\n  padding-left: 15px;\r\n  color: #000000;\r\n}\r\n\r\n.footerCell i {\r\n  margin-right: 5px;\r\n}\r\n\r\n.legendBtn {\r\n  color: #41bff3;\r\n  cursor: pointer;\r\n}\r\n\r\n.isOnline i {\r\n  color: #2f9c3f;\r\n  font-weight: bold;\r\n}\r\n\r\n.isOffline i {\r\n  font-weight: bold;\r\n}\r\n\r\n.isOffline {\r\n  color: #a40000;\r\n}\r\n\r\n.dayTitle {\r\n  font-size: 0.8em;\r\n  font-weight: 600;\r\n  display: grid;\r\n  user-select: none;\r\n  /* height: 100%;\r\n  \r\n  align-items: center;\r\n  text-align: center;\r\n  width: 100%; */\r\n}\r\n\r\n.currentDay .dayTitle {\r\n  font-weight: bold;\r\n  /* color: #262b31; */\r\n}\r\n\r\n.currentDay {\r\n  background-color: #e3f3fa;\r\n}\r\n\r\n.dayCapacityPercent {\r\n  font-size: 0.75em;\r\n}\r\n\r\n.badge-pill {\r\n  padding-left: 1em;\r\n  padding-right: 1em;\r\n  font-size: 0.7em;\r\n  margin-bottom: 2px;\r\n}\r\n","import locales from '@/stores/locales.store';\r\nimport { Component, Event, EventEmitter, Host, Prop, h } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'igl-cal-footer',\r\n  styleUrl: 'igl-cal-footer.css',\r\n  scoped: true,\r\n})\r\nexport class IglCalFooter {\r\n  @Event() optionEvent: EventEmitter<{ [key: string]: any }>;\r\n  @Prop() calendarData: { [key: string]: any };\r\n  @Prop() today: String;\r\n\r\n  // private isOnline:boolean = false;\r\n\r\n  handleOptionEvent(key, data = '') {\r\n    this.optionEvent.emit({ key, data });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host class=\"footerContainer\">\r\n        <div class=\"footerCell bottomLeftCell align-items-center preventPageScroll\">\r\n          <div class=\"legendBtn\" onClick={() => this.handleOptionEvent('showLegend')}>\r\n            <i class=\"la la-square\"></i>\r\n            <u>{locales.entries.Lcz_Legend}</u>\r\n          </div>\r\n          {/* <div class={`${this.isOnline ? 'isOnline' : 'isOffline'}`}>\r\n            <i class=\"la la-share-alt isOffline\"></i><span>{this.isOnline ? \"Connected\": \"Offline\"}</span>\r\n          </div> */}\r\n        </div>\r\n        {this.calendarData.days.map(dayInfo => (\r\n          <div class=\"footerCell align-items-center\">\r\n            <div class={`dayTitle full-height align-items-center ${dayInfo.day === this.today ? 'currentDay' : ''}`}>{dayInfo.dayDisplayName}</div>\r\n\r\n            {/* <div class=\"dayTitle\">{dayInfo.dayDisplayName}</div>\r\n              <div class=\"dayCapacityPercent\">28.57%</div>\r\n              <div class=\"preventPageScroll\">\r\n                <span class=\"badge badge-primary badge-pill\">\r\n                  {index}\r\n                </span>\r\n              </div> */}\r\n          </div>\r\n        ))}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n  position: absolute;\r\n  top: 0;\r\n  height: 100%;\r\n}\r\n.svg-icon {\r\n  height: 20px;\r\n  width: 20px;\r\n}\r\n.darkGrey {\r\n  background: #ececec;\r\n}\r\n.btn {\r\n  pointer-events: auto;\r\n}\r\n\r\n.stickyCell {\r\n  display: -ms-inline-grid;\r\n  display: -moz-inline-grid;\r\n  display: inline-grid;\r\n  position: -webkit-sticky;\r\n  position: sticky;\r\n  top: 0px;\r\n  height: 82px;\r\n  display: inline-block;\r\n  vertical-align: top;\r\n  z-index: 2;\r\n}\r\n\r\n.headersContainer {\r\n  background-color: #ffffff;\r\n}\r\n\r\n.headerCell {\r\n  display: inline-grid;\r\n  width: 70px;\r\n  height: 60px;\r\n  vertical-align: top;\r\n  background-color: #ffffff;\r\n  border-bottom: 1px solid #e0e0e0;\r\n}\r\n\r\n.datePickerHidden {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  opacity: 0;\r\n}\r\n\r\n.monthsContainer {\r\n  height: 20px;\r\n  background-color: #ffffff;\r\n  margin-bottom: 0.2em;\r\n}\r\n\r\n.monthCell {\r\n  display: inline-grid;\r\n  height: 20px;\r\n  background-color: #ececec;\r\n  border-right: 1px solid #c7c7c7;\r\n  vertical-align: top;\r\n}\r\n\r\n.monthCell:nth-child(odd) {\r\n  background-color: #dddddd;\r\n}\r\n\r\n.monthTitle {\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  font-size: 0.9em;\r\n  text-transform: uppercase;\r\n  font-weight: bold;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n\r\n.topLeftCell {\r\n  left: 0px;\r\n  z-index: 3;\r\n  width: 170px;\r\n  background-color: #ffffff;\r\n  display: -ms-inline-grid;\r\n  display: -moz-inline-grid;\r\n  display: inline-grid;\r\n}\r\n\r\n.caledarBtns {\r\n  position: relative;\r\n  cursor: pointer;\r\n  font-size: 1.75em;\r\n  line-height: 1em;\r\n  padding: 0.4rem;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.caledarBtns .la {\r\n  font-size: 1.1em;\r\n}\r\n\r\n.caledarBtns:hover {\r\n  background-color: #f6f6f6;\r\n}\r\n\r\n.dayTitle {\r\n  font-size: 0.8em;\r\n  font-weight: 600;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n\r\n.currentDay .dayTitle {\r\n  font-weight: bold;\r\n}\r\n\r\n.currentDay {\r\n  background-color: #e3f3fa;\r\n}\r\n\r\n.dayCapacityPercent {\r\n  font-size: 0.75em;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n\r\n.badge-pill {\r\n  padding: 3px 1em;\r\n  font-size: 0.8em;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n\r\n.pointer {\r\n  cursor: pointer;\r\n}\r\n\r\n.searchContiner {\r\n  padding-left: 10px;\r\n  padding-right: 10px;\r\n}\r\n\r\n.searchListContainer {\r\n  background: #fff;\r\n  border: 1px solid #ccc;\r\n  border-bottom: none;\r\n}\r\n\r\n.searchListItem {\r\n  background: white;\r\n  border-bottom: 1px solid #ccc;\r\n  padding-left: 8px;\r\n}\r\n\r\n.badge-light {\r\n  background-color: #999999;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n.min-width-full {\r\n  min-width: 100%;\r\n}\r\n","import { Component, Event, EventEmitter, Host, Prop, h, State, Listen, Watch } from '@stencil/core';\r\nimport { ToBeAssignedService } from '../../../services/toBeAssigned.service';\r\nimport { dateToFormattedString } from '../../../utils/utils';\r\nimport moment from 'moment';\r\nimport locales from '@/stores/locales.store';\r\n\r\n@Component({\r\n  tag: 'igl-cal-header',\r\n  styleUrl: 'igl-cal-header.css',\r\n  scoped: true,\r\n})\r\nexport class IglCalHeader {\r\n  @Event() optionEvent: EventEmitter<{ [key: string]: any }>;\r\n  @Event({ bubbles: true, composed: true }) gotoRoomEvent: EventEmitter<{\r\n    [key: string]: any;\r\n  }>;\r\n  @Event({ bubbles: true, composed: true }) gotoToBeAssignedDate: EventEmitter<{\r\n    [key: string]: any;\r\n  }>;\r\n  @Prop() calendarData: { [key: string]: any };\r\n  @Prop() today: String;\r\n  @Prop() propertyid: number;\r\n  @Prop() unassignedDates;\r\n  @Prop() to_date: string;\r\n  @State() renderAgain: boolean = false;\r\n  @State() unassignedRoomsNumber: any = {};\r\n  private searchValue: string = '';\r\n  private searchList: { [key: string]: any }[] = [];\r\n  private roomsList: { [key: string]: any }[] = [];\r\n  private toBeAssignedService = new ToBeAssignedService();\r\n  componentWillLoad() {\r\n    try {\r\n      this.initializeRoomsList();\r\n\r\n      if (!this.calendarData.is_vacation_rental && Object.keys(this.unassignedDates).length > 0) {\r\n        this.fetchAndAssignUnassignedRooms();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error in componentWillLoad:', error);\r\n    }\r\n  }\r\n  @Watch('unassignedDates')\r\n  handleCalendarDataChanged() {\r\n    this.fetchAndAssignUnassignedRooms();\r\n  }\r\n  private initializeRoomsList() {\r\n    this.roomsList = [];\r\n    this.calendarData.roomsInfo.forEach(category => {\r\n      this.roomsList = this.roomsList.concat(...category.physicalrooms);\r\n    });\r\n  }\r\n\r\n  private async fetchAndAssignUnassignedRooms() {\r\n    await this.assignRoomsToDate();\r\n  }\r\n\r\n  private async assignRoomsToDate() {\r\n    try {\r\n      const { fromDate, toDate, data } = this.unassignedDates;\r\n      let dt = new Date(fromDate);\r\n      dt.setHours(0);\r\n      dt.setMinutes(0);\r\n      dt.setSeconds(0);\r\n      let endDate = dt.getTime();\r\n      while (endDate <= new Date(toDate).getTime()) {\r\n        const selectedDate = moment(endDate).format('D_M_YYYY');\r\n        if (data[endDate]) {\r\n          const result = await this.toBeAssignedService.getUnassignedRooms(\r\n            this.propertyid,\r\n            dateToFormattedString(new Date(endDate)),\r\n            this.calendarData.roomsInfo,\r\n            this.calendarData.formattedLegendData,\r\n          );\r\n          this.unassignedRoomsNumber[selectedDate] = result.length;\r\n        } else if (this.unassignedRoomsNumber[selectedDate]) {\r\n          this.unassignedRoomsNumber[selectedDate] = this.unassignedRoomsNumber[selectedDate] - 1;\r\n        }\r\n        endDate = moment(endDate).add(1, 'days').toDate().getTime();\r\n        this.renderView();\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  @Listen('reduceAvailableUnitEvent', { target: 'window' })\r\n  handleReduceAvailableUnitEvent(event: CustomEvent<{ fromDate: string; toDate: string }>) {\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n    const { fromDate, toDate } = event.detail;\r\n    let endDate = new Date(fromDate).getTime();\r\n    while (endDate < new Date(toDate).getTime()) {\r\n      const selectedDate = moment(endDate).format('D_M_YYYY');\r\n      this.unassignedRoomsNumber[selectedDate] = this.unassignedRoomsNumber[selectedDate] - 1;\r\n      endDate = moment(endDate).add(1, 'days').toDate().getTime();\r\n    }\r\n    this.renderView();\r\n  }\r\n\r\n  showToBeAssigned(dayInfo) {\r\n    if (this.unassignedRoomsNumber[dayInfo.day] || 0) {\r\n      this.handleOptionEvent('showAssigned');\r\n      setTimeout(() => {\r\n        this.gotoToBeAssignedDate.emit({\r\n          key: 'gotoToBeAssignedDate',\r\n          data: dayInfo.currentDate,\r\n        });\r\n      }, 100);\r\n    } else {\r\n      // do nothing as the value is 0;\r\n    }\r\n  }\r\n\r\n  handleOptionEvent(key, data: any = '') {\r\n    this.optionEvent.emit({ key, data });\r\n  }\r\n\r\n  handleDateSelect(event: CustomEvent) {\r\n    if (Object.keys(event.detail).length > 0) {\r\n      this.handleOptionEvent('calendar', event.detail);\r\n    }\r\n  }\r\n\r\n  handleClearSearch() {\r\n    this.searchValue = '';\r\n    this.searchList = [];\r\n    this.renderView();\r\n  }\r\n\r\n  handleFilterRooms(event: Event) {\r\n    const inputElement = event.target as HTMLInputElement;\r\n    let value = inputElement.value.trim();\r\n    this.searchValue = value;\r\n    value = value.toLowerCase();\r\n    if (value === '') {\r\n      this.handleClearSearch();\r\n    } else {\r\n      this.searchList = this.roomsList.filter(room => room.name.toLocaleLowerCase().indexOf(value) != -1);\r\n    }\r\n    this.renderView();\r\n  }\r\n\r\n  handleScrollToRoom(roomId) {\r\n    this.handleClearSearch();\r\n    this.gotoRoomEvent.emit({ key: 'gotoRoom', roomId });\r\n  }\r\n\r\n  getStringDateFormat(dt) {\r\n    return dt.getFullYear() + '-' + (dt.getMonth() < 9 ? '0' : '') + (dt.getMonth() + 1) + '-' + (dt.getDate() <= 9 ? '0' : '') + dt.getDate();\r\n  }\r\n\r\n  getNewBookingModel() {\r\n    let today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n    let from_date = this.getStringDateFormat(today);\r\n    today.setDate(today.getDate() + 1);\r\n    today.setHours(0, 0, 0, 0);\r\n    let to_date = this.getStringDateFormat(today);\r\n    return {\r\n      ID: '',\r\n      NAME: '',\r\n      EMAIL: '',\r\n      PHONE: '',\r\n      REFERENCE_TYPE: 'PHONE',\r\n      FROM_DATE: from_date, // \"2023-07-09\",\r\n      TO_DATE: to_date, // \"2023-07-11\",\r\n      roomsInfo: this.calendarData.roomsInfo,\r\n      TITLE: locales.entries.Lcz_NewBooking,\r\n      event_type: 'PLUS_BOOKING',\r\n      legendData: this.calendarData.formattedLegendData,\r\n      defaultDateRange: {\r\n        fromDate: new Date(from_date), //new Date(\"2023-09-10\"),\r\n        fromDateStr: '', //\"10 Sep 2023\",\r\n        toDate: new Date(to_date), //new Date(\"2023-09-15\"),\r\n        toDateStr: '', // \"15 Sep 2023\",\r\n        dateDifference: 0,\r\n        editabled: true,\r\n        message: '',\r\n      },\r\n    };\r\n  }\r\n\r\n  renderView() {\r\n    this.renderAgain = !this.renderAgain;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <div class=\"stickyCell align-items-center topLeftCell preventPageScroll\">\r\n          <div class=\"row justify-content-around no-gutters\">\r\n            {!this.calendarData.is_vacation_rental && (\r\n              <div\r\n                class=\"caledarBtns\"\r\n                onClick={() => this.handleOptionEvent('showAssigned')}\r\n                data-toggle=\"tooltip\"\r\n                data-placement=\"bottom\"\r\n                title={locales.entries.Lcz_UnassignedUnitsTooltip}\r\n              >\r\n                {/* <i class=\"la la-tasks\"></i> */}\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-icon\">\r\n                  <path\r\n                    fill=\"#6b6f82\"\r\n                    d=\"M448 160H320V128H448v32zM48 64C21.5 64 0 85.5 0 112v64c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zM448 352v32H192V352H448zM48 288c-26.5 0-48 21.5-48 48v64c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V336c0-26.5-21.5-48-48-48H48z\"\r\n                  />\r\n                </svg>\r\n              </div>\r\n            )}\r\n            <div class=\"caledarBtns\" onClick={() => this.handleOptionEvent('calendar')} data-toggle=\"tooltip\" data-placement=\"bottom\" title={locales.entries.Lcz_Navigate}>\r\n              {/* <i class=\"la la-calendar-o\"></i> */}\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class={'svg-icon'}>\r\n                <path\r\n                  fill=\"#6b6f82\"\r\n                  d=\"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192H400V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192z\"\r\n                />\r\n              </svg>\r\n              {/* <input  type=\"date\" onChange={this.handleDateSelect.bind(this)} title=\"\" /> */}\r\n              <ir-date-picker\r\n                minDate={moment().add(-2, 'months').startOf('month').format('YYYY-MM-DD')}\r\n                autoApply\r\n                singleDatePicker\r\n                onDateChanged={evt => {\r\n                  console.log('evt', evt);\r\n                  this.handleDateSelect(evt);\r\n                }}\r\n                class=\"datePickerHidden\"\r\n              ></ir-date-picker>\r\n            </div>\r\n            <div class=\"caledarBtns\" onClick={() => this.handleOptionEvent('gotoToday')} data-toggle=\"tooltip\" data-placement=\"bottom\" title={locales.entries.Lcz_Today}>\r\n              {/* <i class=\"la la-clock-o\"></i> */}\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" class=\"svg-icon\">\r\n                <path\r\n                  fill=\"#6b6f82\"\r\n                  d=\"M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <div\r\n              class=\"caledarBtns\"\r\n              onClick={() => this.handleOptionEvent('add', this.getNewBookingModel())}\r\n              data-toggle=\"tooltip\"\r\n              data-placement=\"bottom\"\r\n              title={locales.entries.Lcz_CreateNewBooking}\r\n            >\r\n              {/* <i class=\"la la-plus\"></i> */}\r\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" class=\"svg-icon\">\r\n                <path\r\n                  fill=\"#6b6f82\"\r\n                  d=\"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z\"\r\n                />\r\n              </svg>\r\n            </div>\r\n          </div>\r\n          <div class=\"row justify-content-around no-gutters searchContiner\">\r\n            <fieldset class={`form-group position-relative ${this.searchValue != '' ? 'show' : ''}`}>\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control form-control-sm input-sm\"\r\n                id=\"iconLeft7\"\r\n                value={this.searchValue}\r\n                placeholder={locales.entries.Lcz_FindUnit}\r\n                onInput={event => this.handleFilterRooms(event)}\r\n              />\r\n              {this.searchValue !== '' ? (\r\n                <div\r\n                  class=\"form-control-position pointer\"\r\n                  onClick={() => this.handleClearSearch()}\r\n                  data-toggle=\"tooltip\"\r\n                  data-placement=\"top\"\r\n                  data-original-title=\"Clear Selection\"\r\n                >\r\n                  <i class=\"la la-close font-small-4\"></i>\r\n                </div>\r\n              ) : null}\r\n\r\n              {this.searchList.length ? (\r\n                <div class=\"position-absolute searchListContainer dropdown-menu dropdown-menu-left min-width-full\">\r\n                  {this.searchList.map(room => (\r\n                    <div class=\"searchListItem1 dropdown-item px-1 text-left pointer\" onClick={() => this.handleScrollToRoom(room.id)}>\r\n                      {room.name}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : null}\r\n            </fieldset>\r\n          </div>\r\n        </div>\r\n        <div class=\"stickyCell headersContainer\">\r\n          <div class=\"monthsContainer\">\r\n            {this.calendarData.monthsInfo.map(monthInfo => (\r\n              <div class=\"monthCell\" style={{ width: monthInfo.daysCount * 70 + 'px' }}>\r\n                <div class=\"monthTitle\">{monthInfo.monthName}</div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n          {this.calendarData.days.map(dayInfo => (\r\n            <div class={`headerCell align-items-center ${'day-' + dayInfo.day} ${dayInfo.day === this.today ? 'currentDay' : ''}`} data-day={dayInfo.day}>\r\n              {!this.calendarData.is_vacation_rental && (\r\n                <div class=\"preventPageScroll\">\r\n                  <span\r\n                    class={`badge badge-${this.unassignedRoomsNumber[dayInfo.day] || dayInfo.unassigned_units_nbr !== 0 ? 'info pointer' : 'light'} badge-pill`}\r\n                    onClick={() => this.showToBeAssigned(dayInfo)}\r\n                  >\r\n                    {this.unassignedRoomsNumber[dayInfo.day] || dayInfo.unassigned_units_nbr}\r\n                  </span>\r\n                </div>\r\n              )}\r\n              <div class=\"dayTitle\">{dayInfo.dayDisplayName}</div>\r\n              <div class=\"dayCapacityPercent\">{dayInfo.occupancy}%</div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n\r\n/* Legend */\r\n\r\n.legendHeader {\r\n  font-weight: 500;\r\n  letter-spacing: 0.05rem;\r\n  font-size: 1.12rem;\r\n  padding-top: 5px;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.legendCloseBtn {\r\n  position: absolute;\r\n  top: 50%;\r\n  right: 0;\r\n  cursor: pointer;\r\n  font-size: 1.75em;\r\n  line-height: 1em;\r\n  padding: 0.4rem;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 3px;\r\n  transform: translateY(-50%);\r\n}\r\n\r\n.legendCloseBtn:hover {\r\n  background-color: #f6f6f6;\r\n}\r\n\r\n.stickyHeader {\r\n  position: -webkit-sticky;\r\n  position: sticky;\r\n  top: 0;\r\n  background-color: #ffffff;\r\n  z-index: 1;\r\n}\r\n\r\n.legendRow {\r\n  position: relative;\r\n  vertical-align: middle;\r\n  margin-bottom: 0.3rem;\r\n}\r\n\r\n.legendRow div {\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n}\r\n\r\n.legend_skew,\r\n.legend_skew-bordered,\r\n.legend_skewsplit {\r\n  transform: skew(-30deg);\r\n  width: 15px;\r\n  height: 16px;\r\n}\r\n.legend_skew-bordered {\r\n  border: 1px solid black;\r\n}\r\n\r\n.legend_circle {\r\n  border-radius: 100%;\r\n  width: 10px;\r\n  height: 10px;\r\n  margin: 3px 3px 3px 2px;\r\n}\r\n\r\n.legend_skewsplit {\r\n  border-right: 2px solid #000000;\r\n}\r\n.headerCell .blueColor {\r\n  background-color: #31bef1;\r\n}\r\n.greenColor {\r\n  background-color: #45b16d;\r\n}\r\n.yellowColor {\r\n  background-color: #f4d552;\r\n}\r\n.greyColor {\r\n  background-color: #a0a0a0;\r\n}\r\n.redColor {\r\n  background-color: #f34752;\r\n}\r\n.pinkColor {\r\n  background-color: #f9b4b7;\r\n}\r\n\r\n/* Legend Calendar */\r\n\r\n.legendCalendar .legendRow {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.legendCalendar .legendRow:first-child .legendCal {\r\n  background-color: #ececec;\r\n}\r\n\r\n.legendCalendar .legendRow div {\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n.total-availability {\r\n  font-size: 1em !important;\r\n}\r\n.legendCalendar .legendCal {\r\n  width: 80px;\r\n  height: 25px;\r\n  text-align: center;\r\n  display: inline-grid !important;\r\n  align-content: center;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n\r\n.legendCalendar .legendCal .badge {\r\n  margin-top: 0.2rem;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n\r\n.legendCalendar .legendCal.legendCal-h2 {\r\n  height: 40px;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n\r\n.br-t {\r\n  border-top: 1px solid #a0a0a0;\r\n}\r\n.br-s {\r\n  border-left: 1px solid #a0a0a0;\r\n  border-right: 1px solid #a0a0a0;\r\n}\r\n.br-bt {\r\n  border-bottom: 1px solid #a0a0a0;\r\n}\r\n\r\n.highphenLegend {\r\n  font-size: 0.9em;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n\r\n.highphenLegend::before {\r\n  width: 12px;\r\n  height: 0.5px;\r\n  content: ' ';\r\n  background-color: #000000;\r\n  vertical-align: middle;\r\n  display: inline-block;\r\n  margin-left: 5px;\r\n  margin-right: 5px;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n/* .badge-pill {\r\n  padding: 4px 1.1em;\r\n  font-size: 0.9em;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n} */\r\n.badge-pill {\r\n  padding: 3px 1em;\r\n  font-size: 0.8em;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n\r\n.headerCell {\r\n  width: 70px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n.dayTitle {\r\n  font-size: 0.8em;\r\n  font-weight: 600;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n.dayCapacityPercent {\r\n  font-size: 0.75em;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  -webkit-user-drag: none;\r\n}\r\n","import locales from '@/stores/locales.store';\r\nimport { Component, Event, EventEmitter, Host, Prop, h } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'igl-legends',\r\n  styleUrl: 'igl-legends.css',\r\n  scoped: true,\r\n})\r\nexport class IglLegends {\r\n  @Event() optionEvent: EventEmitter<{ [key: string]: any }>;\r\n  @Prop() legendData: { [key: string]: any };\r\n  handleOptionEvent(key, data = '') {\r\n    this.optionEvent.emit({ key, data });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host class=\"legendContainer pr-1 text-left\">\r\n        <div class={'w-full'}>\r\n          <div class={'w-full'}>\r\n            <div class=\"stickyHeader pt-1 \">\r\n              <p class=\"legendHeader\">{locales.entries.Lcz_Legend}</p>\r\n              <div class=\"legendCloseBtn\" onClick={() => this.handleOptionEvent('closeSideMenu')}>\r\n                {/* <i class=\"ft-chevrons-left\"></i> */}\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" height={18} width={18}>\r\n                  <path\r\n                    fill=\"#6b6f82\"\r\n                    d=\"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z\"\r\n                  />\r\n                </svg>\r\n              </div>\r\n              <hr />\r\n            </div>\r\n            <div class=\"mt-2 pl-1\">\r\n              {this.legendData.map(legendInfo => (\r\n                <div class=\"legendRow \">\r\n                  <div class={`legend_${legendInfo.design} mr-1`} style={{ backgroundColor: legendInfo.color }}></div>\r\n                  <span class=\"font-small-3\">{legendInfo.name}</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n            <hr />\r\n            <div class=\"mt-2\">\r\n              <div class=\"legendCalendar\">\r\n                <div class=\"legendRow align-items-center\">\r\n                  <div class=\"legendCal br-t br-s br-bt\">\r\n                    <strong>MAR 2022</strong>\r\n                  </div>\r\n                  <div class=\"highphenLegend\">{locales.entries.Lcz_MonthAndYear}</div>\r\n                </div>\r\n                <div class=\"legendRow\">\r\n                  <div class=\"legendCal headerCell align-items-center br-s\">\r\n                    <span class=\"badge badge-info  badge-pill\">3</span>\r\n                  </div>\r\n                  <div class=\"highphenLegend\">\r\n                    <div>{locales.entries.Lcz_UnassignedUnits}</div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"legendRow\">\r\n                  <div class=\"legendCal dayTitle br-s\">Fri 18</div>\r\n                  <div class=\"highphenLegend\">{locales.entries.Lcz_Date}</div>\r\n                </div>\r\n                <div class=\"legendRow\">\r\n                  <div class=\"legendCal br-s br-bt dayCapacityPercent\">15%</div>\r\n                  <div class=\"highphenLegend\">{locales.entries.Lcz_Occupancy}</div>\r\n                </div>\r\n                <div class=\"legendRow\">\r\n                  <div class=\"legendCal br-s br-bt  font-weight-bold total-availability\">20</div>\r\n                  <div class=\"highphenLegend\">{locales.entries.Lcz_TotalAvailability}</div>\r\n                </div>\r\n                {/* <div class=\"legendRow align-items-center\">\r\n                  <div class=\"legendCal br-s br-bt font-small-2\">15</div>\r\n                  <div class=\"highphenLegend\">\r\n                    <div>{locales.entries.Lcz_OfflineAvailability}</div>\r\n                  </div>\r\n                </div> */}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n.custom-dropdown {\r\n  cursor: pointer;\r\n  padding: 5px 10px;\r\n  width: min-content;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n.dropdown-toggle {\r\n  all: unset;\r\n  display: flex;\r\n  width: max-content;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n.dropdown-menu {\r\n  max-height: 250px;\r\n  overflow-y: auto;\r\n}\r\n.tobeAssignedHeader {\r\n  font-weight: 500;\r\n  letter-spacing: 0.05rem;\r\n  font-size: 1.12rem;\r\n  padding-top: 5px;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.closeBtn {\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  cursor: pointer;\r\n  line-height: 1em;\r\n  padding: 0.4rem;\r\n}\r\n\r\n.closeBtn:hover {\r\n  background-color: #f6f6f6;\r\n}\r\n.dropdown-toggle::after {\r\n  content: none;\r\n  display: none;\r\n}\r\n.dropdown-toggle .caret-icon {\r\n  transition: transform 0.2s ease;\r\n}\r\n.show .caret-icon {\r\n  transform: rotate(-180deg);\r\n}\r\n.stickyHeader {\r\n  position: -webkit-sticky;\r\n  position: sticky;\r\n  top: 0;\r\n  background-color: #ffffff;\r\n  z-index: 1;\r\n}\r\n\r\n.pointer {\r\n  cursor: pointer;\r\n}\r\n","import { Component, Host, h, Prop, Event, EventEmitter, State, Listen, Fragment, Watch } from '@stencil/core';\r\nimport { ToBeAssignedService } from '../../../services/toBeAssigned.service';\r\nimport { dateToFormattedString } from '../../../utils/utils';\r\nimport moment from 'moment';\r\nimport locales from '@/stores/locales.store';\r\nimport { getUnassignedDates } from '@/stores/unassigned_dates.store';\r\n//import { updateCategories } from '../../../utils/events.utils';\r\n\r\n@Component({\r\n  tag: 'igl-to-be-assigned',\r\n  styleUrl: 'igl-to-be-assigned.css',\r\n  scoped: true,\r\n})\r\nexport class IglToBeAssigned {\r\n  @Prop() unassignedDatesProp: any;\r\n  @Prop() propertyid: number;\r\n  @Prop() from_date: string;\r\n  @Prop() to_date: string;\r\n  @State() loadingMessage: string;\r\n  @Prop({ mutable: true }) calendarData: { [key: string]: any };\r\n  @Event() optionEvent: EventEmitter<{ [key: string]: any }>;\r\n  @Event({ bubbles: true, composed: true })\r\n  reduceAvailableUnitEvent: EventEmitter<{ [key: string]: any }>;\r\n  @Event() showBookingPopup: EventEmitter;\r\n  @Event({ bubbles: true, composed: true }) addToBeAssignedEvent: EventEmitter;\r\n  @Event({ bubbles: true, composed: true })\r\n  highlightToBeAssignedBookingEvent: EventEmitter;\r\n  @State() showDatesList: boolean = false;\r\n  @State() renderAgain: boolean = false;\r\n  @State() orderedDatesList: any[] = [];\r\n  private isGotoToBeAssignedDate: boolean = false;\r\n  private isLoading: boolean = true;\r\n  private selectedDate = null;\r\n  private data: { [key: string]: any } = {};\r\n  private today = new Date();\r\n  private categoriesData: { [key: string]: any } = {};\r\n  private toBeAssignedService: ToBeAssignedService = new ToBeAssignedService();\r\n  private unassignedDates: any;\r\n  componentWillLoad() {\r\n    this.reArrangeData();\r\n    this.loadingMessage = locales.entries.Lcz_FetchingUnAssignedUnits;\r\n  }\r\n\r\n  @Watch('unassignedDatesProp')\r\n  handleUnassignedDatesToBeAssignedChange(newValue: any) {\r\n    const { fromDate, toDate, data } = newValue;\r\n    let dt = new Date(fromDate);\r\n    dt.setHours(0);\r\n    dt.setMinutes(0);\r\n    dt.setSeconds(0);\r\n    let endDate = dt.getTime();\r\n    while (endDate <= new Date(toDate).getTime()) {\r\n      if (data && !data[endDate] && this.unassignedDates.hasOwnProperty(endDate)) {\r\n        delete this.unassignedDates[endDate];\r\n      } else if (data && data[endDate]) {\r\n        this.unassignedDates[endDate] = data[endDate];\r\n      }\r\n      endDate = moment(endDate).add(1, 'days').toDate().getTime();\r\n    }\r\n    this.data = { ...this.unassignedDates };\r\n    this.orderedDatesList = Object.keys(this.data).sort((a, b) => parseInt(a) - parseInt(b));\r\n\r\n    if (this.orderedDatesList.length) {\r\n      if (!this.data.hasOwnProperty(this.selectedDate)) {\r\n        this.selectedDate = this.orderedDatesList.length ? this.orderedDatesList[0] : null;\r\n      }\r\n      this.showForDate(this.selectedDate, false);\r\n      this.renderView();\r\n    } else {\r\n      this.selectedDate = null;\r\n    }\r\n  }\r\n  handleAssignUnit(event: CustomEvent<{ [key: string]: any }>) {\r\n    const opt: { [key: string]: any } = event.detail;\r\n    const data = opt.data;\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n\r\n    if (opt.key === 'assignUnit') {\r\n      if (Object.keys(this.data[data.selectedDate].categories).length === 1) {\r\n        this.isLoading = true;\r\n      }\r\n      this.data[data.selectedDate].categories[data.RT_ID] = this.data[data.selectedDate].categories[data.RT_ID].filter(eventData => eventData.ID != data.assignEvent.ID);\r\n      this.calendarData = data.calendarData;\r\n      // this.calendarData.bookingEvents.push(data.assignEvent);\r\n\r\n      // if (!this.data[data.selectedDate].categories[data.RT_ID].length) {\r\n      //   delete this.data[data.selectedDate].categories[data.RT_ID];\r\n\r\n      //   if (!Object.keys(this.data[data.selectedDate].categories).length) {\r\n      //     delete this.data[data.selectedDate];\r\n      //     //this.orderedDatesList = this.orderedDatesList.filter(dateStamp => dateStamp != data.selectedDate);\r\n      //     //this.selectedDate = this.orderedDatesList.length ? this.orderedDatesList[0] : null;\r\n      //   }\r\n      // }\r\n      this.renderView();\r\n\r\n      // this.reduceAvailableUnitEvent.emit({key: \"reduceAvailableDays\", data: {selectedDate: data.selectedDate}});\r\n    }\r\n  }\r\n\r\n  async updateCategories(key, calendarData) {\r\n    try {\r\n      //console.log(\"called\")\r\n      let categorisedRooms = {};\r\n      const result = await this.toBeAssignedService.getUnassignedRooms(\r\n        this.propertyid,\r\n        dateToFormattedString(new Date(+key)),\r\n        calendarData.roomsInfo,\r\n        calendarData.formattedLegendData,\r\n      );\r\n      result.forEach(room => {\r\n        if (!categorisedRooms.hasOwnProperty(room.RT_ID)) {\r\n          categorisedRooms[room.RT_ID] = [room];\r\n        } else {\r\n          categorisedRooms[room.RT_ID].push(room);\r\n        }\r\n      });\r\n      this.unassignedDates[key].categories = categorisedRooms;\r\n    } catch (error) {\r\n      //  toastr.error(error);\r\n    }\r\n  }\r\n\r\n  async reArrangeData() {\r\n    try {\r\n      this.today.setHours(0, 0, 0, 0);\r\n      this.calendarData.roomsInfo.forEach(category => {\r\n        this.categoriesData[category.id] = {\r\n          name: category.name,\r\n          roomsList: category.physicalrooms,\r\n          roomIds: category.physicalrooms.map(room => {\r\n            return room.id;\r\n          }),\r\n        };\r\n      });\r\n\r\n      this.selectedDate = null;\r\n      //this.unassignedDates = await this.toBeAssignedService.getUnassignedDates(this.propertyid, dateToFormattedString(new Date()), this.to_date);\r\n      this.unassignedDates = getUnassignedDates();\r\n      console.log(this.unassignedDates);\r\n\r\n      this.data = this.unassignedDates;\r\n      this.orderedDatesList = Object.keys(this.data).sort((a, b) => parseInt(a) - parseInt(b));\r\n\r\n      if (!this.selectedDate && this.orderedDatesList.length) {\r\n        this.selectedDate = this.orderedDatesList[0];\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching unassigned dates:', error);\r\n      //  toastr.error(error);\r\n    }\r\n  }\r\n  async componentDidLoad() {\r\n    setTimeout(() => {\r\n      if (!this.isGotoToBeAssignedDate && Object.keys(this.unassignedDates).length > 0) {\r\n        //console.log(this.isGotoToBeAssignedDate);\r\n        const firstKey = Object.keys(this.unassignedDates)[0];\r\n\r\n        this.showForDate(firstKey);\r\n      }\r\n    }, 100);\r\n  }\r\n  @Listen('gotoToBeAssignedDate', { target: 'window' })\r\n  async gotoDate(event: CustomEvent) {\r\n    this.isGotoToBeAssignedDate = true;\r\n    this.showForDate(event.detail.data);\r\n    this.showDatesList = false;\r\n    this.renderView();\r\n  }\r\n\r\n  async showForDate(dateStamp, withLoading = true) {\r\n    try {\r\n      if (withLoading) {\r\n        this.isLoading = true;\r\n      }\r\n      if (this.showDatesList) {\r\n        this.showUnassignedDate();\r\n      }\r\n      await this.updateCategories(dateStamp, this.calendarData);\r\n      this.addToBeAssignedEvent.emit({ key: 'tobeAssignedEvents', data: [] });\r\n      this.showBookingPopup.emit({\r\n        key: 'calendar',\r\n        data: parseInt(dateStamp) - 86400000,\r\n      });\r\n      if (this.isGotoToBeAssignedDate) {\r\n        this.isGotoToBeAssignedDate = false;\r\n      }\r\n      this.isLoading = false;\r\n      this.selectedDate = dateStamp;\r\n      this.renderView();\r\n    } catch (error) {\r\n      // toastr.error(error);\r\n    }\r\n  }\r\n\r\n  getDay(dt) {\r\n    const currentDate = new Date(dt);\r\n    const locale = 'default'; //'en-US';\r\n    const dayOfWeek = this.getLocalizedDayOfWeek(currentDate, locale);\r\n    // const monthName = currentDate.toLocaleString(\"default\", { month: 'short' })\r\n    return dayOfWeek + ' ' + currentDate.getDate() + ', ' + currentDate.getFullYear();\r\n  }\r\n\r\n  getLocalizedDayOfWeek(date, locale) {\r\n    const options = { weekday: 'short' };\r\n    return date.toLocaleDateString(locale, options);\r\n  }\r\n\r\n  handleOptionEvent(key, data = '') {\r\n    this.highlightToBeAssignedBookingEvent.emit({\r\n      key: 'highlightBookingId',\r\n      data: { bookingId: '----' },\r\n    });\r\n    this.addToBeAssignedEvent.emit({ key: 'tobeAssignedEvents', data: [] });\r\n    this.optionEvent.emit({ key, data });\r\n  }\r\n\r\n  showUnassignedDate() {\r\n    this.showDatesList = !this.showDatesList;\r\n  }\r\n\r\n  getToBeAssignedEntities() {\r\n    // toBeAssignedEvents\r\n  }\r\n\r\n  getCategoryView() {\r\n    if (this.orderedDatesList.length && this.selectedDate && this.data[this.selectedDate]) {\r\n      return Object.entries(this.data[this.selectedDate].categories).map(([id, eventDatas], ind) => (\r\n        <igl-tba-category-view\r\n          calendarData={this.calendarData}\r\n          selectedDate={this.selectedDate}\r\n          categoryId={id}\r\n          categoryIndex={ind}\r\n          categoriesData={this.categoriesData}\r\n          eventDatas={eventDatas}\r\n          onAssignUnitEvent={evt => this.handleAssignUnit(evt)}\r\n        ></igl-tba-category-view>\r\n      ));\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  renderView() {\r\n    this.renderAgain = !this.renderAgain;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Host class=\"tobeAssignedContainer pr-1 text-left\">\r\n        <div>\r\n          <div>\r\n            <div class=\"stickyHeader pt-1\">\r\n              <p class=\"tobeAssignedHeader \">{locales.entries.Lcz_Assignments}</p>\r\n              {/* <div class=\"closeBtn pt-1\" onClick={() => this.handleOptionEvent('closeSideMenu')}>\r\n                <i class=\"ft-chevrons-left\"></i>\r\n              </div> */}\r\n              <ir-icon class=\"closeBtn pt-2\" onIconClickHandler={() => this.handleOptionEvent('closeSideMenu')}>\r\n                <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" height={18} width={18}>\r\n                  <path\r\n                    fill=\"#6b6f82\"\r\n                    d=\"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z\"\r\n                  />\r\n                </svg>\r\n              </ir-icon>\r\n              <hr />\r\n              {Object.keys(this.data).length === 0 ? (\r\n                <p>{locales.entries.Lcz_AllBookingsAreAssigned}</p>\r\n              ) : this.isLoading ? (\r\n                <p>{this.loadingMessage}</p>\r\n              ) : (\r\n                <Fragment>\r\n                  {this.orderedDatesList.length ? (\r\n                    <div\r\n                      class={`custom-dropdown border border-light rounded text-center ` + (this.showDatesList ? 'show' : '')}\r\n                      id=\"dropdownMenuButton\"\r\n                      data-toggle=\"dropdown\"\r\n                      aria-haspopup=\"true\"\r\n                      aria-expanded=\"false\"\r\n                    >\r\n                      <div\r\n                        class={'dropdown-toggle'}\r\n                        //onClick={() => this.showUnassignedDate()}\r\n                      >\r\n                        <span class=\"font-weight-bold\">{this.data[this.selectedDate].dateStr}</span>\r\n                        <svg class={'caret-icon'} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" height={14} width={14}>\r\n                          <path\r\n                            fill=\"#6b6f82\"\r\n                            d=\"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z\"\r\n                          />\r\n                        </svg>\r\n                      </div>\r\n                      <div class=\"dropdown-menu dropdown-menu-right full-width\" aria-labelledby=\"dropdownMenuButton\">\r\n                        {this.orderedDatesList?.map(ordDate => (\r\n                          <div class=\"dropdown-item pointer\" onClick={() => this.showForDate(ordDate)}>\r\n                            {this.data[ordDate].dateStr}\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    locales.entries.Lcz_AllBookingsAreAssigned\r\n                  )}\r\n                </Fragment>\r\n              )}\r\n            </div>\r\n            {!this.isLoading && (\r\n              <div class=\"scrollabledArea\">\r\n                {this.orderedDatesList.length ? (\r\n                  Object.keys(this.data[this.selectedDate].categories).length ? (\r\n                    this.getCategoryView()\r\n                  ) : (\r\n                    <div class=\"mt-1\">{locales.entries.Lcz_AllAssignForThisDay}</div>\r\n                  )\r\n                ) : null}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  overflow-x: hidden;\r\n}\r\n.confirmed {\r\n  color: #fff;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.bg-ir-green {\r\n  background: #629a4c;\r\n  height: 28px;\r\n  padding-top: 0 !important;\r\n  padding-bottom: 0 !important ;\r\n}\r\n.h-28 {\r\n  height: 2rem;\r\n}\r\n.bg-ir-red {\r\n  background: #ff4961;\r\n  height: 28px;\r\n  padding-top: 0 !important;\r\n  padding-bottom: 0 !important ;\r\n}\r\n.bg-ir-orange {\r\n  background: #ff9149;\r\n  height: 28px;\r\n  padding-top: 0 !important;\r\n  padding-bottom: 0 !important ;\r\n}\r\n.pickup-margin {\r\n  margin-bottom: 7px !important;\r\n}\r\n\r\n.pointer {\r\n  cursor: pointer;\r\n}\r\n\r\n:root {\r\n  --sidebar-width: 50rem;\r\n}\r\n\r\n.sm-padding-right {\r\n  padding-right: 0.2rem;\r\n}\r\n.sm-padding-left {\r\n  padding-left: 0.2rem;\r\n}\r\n.sm-padding-top {\r\n  padding-top: 0.2rem;\r\n}\r\n.sm-padding-bottom {\r\n  padding-bottom: 0.2rem;\r\n}\r\n\r\n.info-notes {\r\n  list-style: none;\r\n  padding-left: 0;\r\n}\r\n.light-blue-bg {\r\n  background-color: #acecff;\r\n  padding: 0rem 0.1rem;\r\n}\r\n.iframeHeight {\r\n  height: 17.5rem;\r\n}\r\n","import { Component, Listen, h, Prop, Watch, State, Event, EventEmitter, Element, Fragment } from '@stencil/core';\r\nimport moment from 'moment';\r\nimport { _formatDate, _formatTime } from './functions';\r\nimport { Booking, Guest, Room } from '../../models/booking.dto';\r\nimport axios from 'axios';\r\nimport { BookingService } from '../../services/booking.service';\r\nimport { IglBookPropertyPayloadAddRoom, TIglBookPropertyPayload } from '../../models/igl-book-property';\r\nimport { RoomService } from '../../services/room.service';\r\nimport locales, { ILocale } from '@/stores/locales.store';\r\nimport { IToast } from '../ir-toast/toast';\r\nimport calendar_data from '@/stores/calendar-data';\r\n\r\n@Component({\r\n  tag: 'ir-booking-details',\r\n  styleUrl: 'ir-booking-details.css',\r\n  scoped: true,\r\n})\r\nexport class IrBookingDetails {\r\n  @Element() element: HTMLElement;\r\n  // Setup Data\r\n  @Prop() language: string = '';\r\n  @Prop() ticket: string = '';\r\n  @Prop() bookingNumber: string = '';\r\n  @Prop() baseurl: string = '';\r\n  @Prop() propertyid: number;\r\n\r\n  // Booleans Conditions\r\n  @Prop() hasPrint: boolean = false;\r\n  @Prop() hasReceipt: boolean = false;\r\n  @Prop() hasDelete: boolean = false;\r\n  @Prop() hasMenu: boolean = false;\r\n\r\n  // Room Booleans\r\n  @Prop() hasRoomEdit: boolean = false;\r\n  @Prop() hasRoomDelete: boolean = false;\r\n  @Prop() hasRoomAdd: boolean = false;\r\n  @Prop() hasCheckIn: boolean = false;\r\n  @Prop() hasCheckOut: boolean = false;\r\n\r\n  @State() bookingItem: TIglBookPropertyPayload | null = null;\r\n  @State() statusData = [];\r\n  // Temp Status Before Save\r\n  @State() tempStatus: string = null;\r\n\r\n  @State() showPaymentDetails: any;\r\n  @State() bookingData: Booking;\r\n  @State() countryNodeList: any;\r\n  @State() calendarData: any = {};\r\n  // Guest Data\r\n  @State() guestData: Guest = null;\r\n  @State() defaultTexts: ILocale;\r\n  // Rerender Flag\r\n  @State() rerenderFlag = false;\r\n  @State() sidebarState: 'guest' | 'pickup' | null = null;\r\n  @State() isUpdateClicked = false;\r\n\r\n  // Payment Event\r\n  @Event() toast: EventEmitter<IToast>;\r\n  private bookingService = new BookingService();\r\n  private roomService = new RoomService();\r\n  componentDidLoad() {\r\n    if (this.baseurl) {\r\n      axios.defaults.baseURL = this.baseurl;\r\n    }\r\n    if (this.ticket !== '') {\r\n      this.initializeApp();\r\n    }\r\n  }\r\n  @Watch('ticket')\r\n  async ticketChanged() {\r\n    sessionStorage.setItem('token', JSON.stringify(this.ticket));\r\n    this.initializeApp();\r\n  }\r\n  setRoomsData(roomServiceResp) {\r\n    let roomsData: { [key: string]: any }[] = new Array();\r\n    if (roomServiceResp.My_Result?.roomtypes?.length) {\r\n      roomsData = roomServiceResp.My_Result.roomtypes;\r\n      roomServiceResp.My_Result.roomtypes.forEach(roomCategory => {\r\n        roomCategory.expanded = true;\r\n      });\r\n    }\r\n    this.calendarData.roomsInfo = roomsData;\r\n  }\r\n  async initializeApp() {\r\n    try {\r\n      const [roomResponse, languageTexts, countriesList, bookingDetails] = await Promise.all([\r\n        this.roomService.fetchData(this.propertyid, this.language),\r\n        this.roomService.fetchLanguage(this.language),\r\n        this.bookingService.getCountries(this.language),\r\n        this.bookingService.getExposedBooking(this.bookingNumber, this.language),\r\n      ]);\r\n      console.log(languageTexts);\r\n      if (!locales.entries) {\r\n        locales.entries = languageTexts.entries;\r\n        locales.direction = languageTexts.direction;\r\n      }\r\n      this.defaultTexts = languageTexts;\r\n      console.log(this.defaultTexts);\r\n      this.countryNodeList = countriesList;\r\n\r\n      const { allowed_payment_methods: paymentMethods, currency, allowed_booking_sources, adult_child_constraints, calendar_legends } = roomResponse['My_Result'];\r\n      this.calendarData = { currency, allowed_booking_sources, adult_child_constraints, legendData: calendar_legends };\r\n      console.log(this.calendarData);\r\n      this.setRoomsData(roomResponse);\r\n      // console.log(this.calendarData);\r\n      const paymentCodesToShow = ['001', '004'];\r\n      this.showPaymentDetails = paymentMethods.some(method => paymentCodesToShow.includes(method.code));\r\n\r\n      this.guestData = bookingDetails.guest;\r\n      this.bookingData = bookingDetails;\r\n      this.rerenderFlag = !this.rerenderFlag;\r\n    } catch (error) {\r\n      console.error('Error initializing app:', error);\r\n    }\r\n  }\r\n\r\n  @Listen('iconClickHandler')\r\n  handleIconClick(e) {\r\n    const target = e.target;\r\n    switch (target.id) {\r\n      case 'pickup':\r\n        this.sidebarState = 'pickup';\r\n        return;\r\n      case 'print':\r\n        window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.bookingData.system_id}&&PM=B&TK=${this.ticket}`);\r\n        return;\r\n      case 'receipt':\r\n        window.open(`https://x.igloorooms.com/manage/AcBookingEdit.aspx?IRID=${this.bookingData.system_id}&&PM=I&TK=${this.ticket}`);\r\n        return;\r\n      case 'book-delete':\r\n        return;\r\n      case 'menu':\r\n        window.location.href = 'https://x.igloorooms.com/manage/acbookinglist.aspx';\r\n        return;\r\n      case 'room-add':\r\n        (this.bookingItem as IglBookPropertyPayloadAddRoom) = {\r\n          ID: '',\r\n          NAME: this.bookingData.guest.last_name,\r\n          EMAIL: this.bookingData.guest.email,\r\n          PHONE: this.bookingData.guest.mobile,\r\n          REFERENCE_TYPE: '',\r\n          FROM_DATE: this.bookingData.from_date,\r\n          ARRIVAL: this.bookingData.arrival,\r\n          TO_DATE: this.bookingData.to_date,\r\n          TITLE: `${locales.entries.Lcz_AddingUnitToBooking}# ${this.bookingData.booking_nbr}`,\r\n          defaultDateRange: {\r\n            fromDate: new Date(this.bookingData.from_date),\r\n            fromDateStr: '',\r\n            toDate: new Date(this.bookingData.to_date),\r\n            toDateStr: '',\r\n            dateDifference: 0,\r\n            message: '',\r\n          },\r\n          event_type: 'ADD_ROOM',\r\n          BOOKING_NUMBER: this.bookingData.booking_nbr,\r\n          ADD_ROOM_TO_BOOKING: this.bookingData.booking_nbr,\r\n          GUEST: this.bookingData.guest,\r\n          message: this.bookingData.remark,\r\n          SOURCE: this.bookingData.source,\r\n          ROOMS: this.bookingData.rooms,\r\n        };\r\n        return;\r\n      case 'add-payment':\r\n        return;\r\n    }\r\n  }\r\n\r\n  @Listen('editSidebar')\r\n  handleEditSidebar() {\r\n    this.sidebarState = 'guest';\r\n  }\r\n  @Listen('selectChange')\r\n  handleSelectChange(e: CustomEvent<any>) {\r\n    e.stopPropagation();\r\n    e.stopImmediatePropagation();\r\n    const target = e.target;\r\n    this.tempStatus = (target as any).selectedValue;\r\n  }\r\n\r\n  @Listen('clickHanlder')\r\n  async handleClick(e) {\r\n    const target = e.target;\r\n    const targetID = target.id;\r\n    switch (targetID) {\r\n      case 'update-status-btn':\r\n        await this.updateStatus();\r\n        await this.resetBookingData();\r\n        break;\r\n    }\r\n  }\r\n\r\n  openEditSidebar() {\r\n    const sidebar: any = document.querySelector('ir-sidebar#editGuestInfo');\r\n    sidebar.open = true;\r\n  }\r\n\r\n  _calculateNights(fromDate: string, toDate: string) {\r\n    // calculate the difference between the two dates\r\n    const diff = moment(toDate).diff(moment(fromDate), 'days');\r\n    // return the difference\r\n    return diff;\r\n  }\r\n\r\n  async updateStatus() {\r\n    if (this.tempStatus !== 'Select' && this.tempStatus !== null) {\r\n      try {\r\n        this.isUpdateClicked = true;\r\n        await axios.post(`/Change_Exposed_Booking_Status?Ticket=${this.ticket}`, {\r\n          book_nbr: this.bookingNumber,\r\n          status: this.tempStatus,\r\n        });\r\n        this.toast.emit({\r\n          type: 'success',\r\n          description: '',\r\n          title: locales.entries.Lcz_StatusUpdatedSuccessfully,\r\n          position: 'top-right',\r\n        });\r\n      } catch (error) {\r\n        console.log(error);\r\n      } finally {\r\n        this.isUpdateClicked = false;\r\n      }\r\n    } else {\r\n      this.toast.emit({\r\n        type: 'error',\r\n        description: '',\r\n        title: locales.entries.Lcz_SelectStatus,\r\n        position: 'top-right',\r\n      });\r\n    }\r\n  }\r\n  @Listen('editInitiated')\r\n  handleEditInitiated(e: CustomEvent<TIglBookPropertyPayload>) {\r\n    this.bookingItem = e.detail;\r\n  }\r\n  handleCloseBookingWindow() {\r\n    this.bookingItem = null;\r\n  }\r\n  handleDeleteFinish(e: CustomEvent) {\r\n    this.bookingData = { ...this.bookingData, rooms: this.bookingData.rooms.filter(room => room.identifier !== e.detail) };\r\n  }\r\n  async resetBookingData() {\r\n    try {\r\n      const booking = await this.bookingService.getExposedBooking(this.bookingNumber, this.language);\r\n      this.bookingData = { ...booking };\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  @Listen('resetBookingData')\r\n  async handleResetBookingData(e: CustomEvent) {\r\n    e.stopPropagation();\r\n    e.stopImmediatePropagation();\r\n    await this.resetBookingData();\r\n  }\r\n  render() {\r\n    if (!this.bookingData) {\r\n      return null;\r\n    }\r\n\r\n    let confirmationBG: string = '';\r\n    switch (this.bookingData.status.code) {\r\n      case '001':\r\n        confirmationBG = 'bg-ir-orange';\r\n        break;\r\n      case '002':\r\n        confirmationBG = 'bg-ir-green';\r\n        break;\r\n      case '003':\r\n        confirmationBG = 'bg-ir-red';\r\n        break;\r\n      case '004':\r\n        confirmationBG = 'bg-ir-red';\r\n        break;\r\n    }\r\n\r\n    return [\r\n      <div class=\"fluid-container p-1\">\r\n        <div class=\"d-flex flex-column p-0 mx-0 flex-lg-row align-items-md-center justify-content-between mt-1\">\r\n          <div class=\"m-0 p-0 mb-1 mb-lg-0 mt-md-0  d-flex justify-content-start align-items-end\">\r\n            <p class=\"font-size-large m-0 p-0\">{`${this.defaultTexts.entries.Lcz_Booking}#${this.bookingNumber}`}</p>\r\n            <p class=\"m-0 p-0\">\r\n              {/* format date */}@ {_formatDate(this.bookingData.booked_on.date)} {/* format time */}\r\n              {_formatTime(this.bookingData.booked_on.hour.toString(), +' ' + this.bookingData.booked_on.minute.toString())}\r\n            </p>\r\n          </div>\r\n\r\n          <div class=\"d-flex justify-content-end align-items-center\">\r\n            <span class={`confirmed btn-sm m-0 mr-2 ${confirmationBG}`}>{this.bookingData.status.description}</span>\r\n            {this.bookingData.allowed_actions.length > 0 && (\r\n              <Fragment>\r\n                <ir-select\r\n                  selectContainerStyle=\"h-28\"\r\n                  selectStyles=\"d-flex align-items-center h-28\"\r\n                  firstOption={locales.entries.Lcz_Select}\r\n                  id=\"update-status\"\r\n                  size=\"sm\"\r\n                  label-available=\"false\"\r\n                  data={this.bookingData.allowed_actions.map(b => ({ text: b.description, value: b.code }))}\r\n                  textSize=\"sm\"\r\n                  class=\"sm-padding-right m-0\"\r\n                ></ir-select>\r\n                <ir-button btn_styles=\"h-28\" isLoading={this.isUpdateClicked} btn_disabled={this.isUpdateClicked} id=\"update-status-btn\" size=\"sm\" text=\"Update\"></ir-button>\r\n              </Fragment>\r\n            )}\r\n            {this.hasReceipt && (\r\n              <ir-icon id=\"receipt\" class=\"mx-1\">\r\n                <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" stroke=\"#104064\" height=\"24\" width=\"19\" viewBox=\"0 0 384 512\">\r\n                  <path\r\n                    fill=\"#104064\"\r\n                    d=\"M64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0H64zM256 0V128H384L256 0zM80 64h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H80c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H80c-8.8 0-16-7.2-16-16s7.2-16 16-16zm16 96H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V256c0-17.7 14.3-32 32-32zm0 32v64H288V256H96zM240 416h64c8.8 0 16 7.2 16 16s-7.2 16-16 16H240c-8.8 0-16-7.2-16-16s7.2-16 16-16z\"\r\n                  />\r\n                </svg>\r\n              </ir-icon>\r\n            )}\r\n            {this.hasPrint && (\r\n              <ir-icon id=\"print\" icon=\"ft-printer h1 color-ir-dark-blue-hover m-0 ml-1  pointer\">\r\n                <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" width=\"24\" viewBox=\"0 0 512 512\">\r\n                  <path\r\n                    fill=\"#104064\"\r\n                    d=\"M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zM432 248a24 24 0 1 1 0 48 24 24 0 1 1 0-48z\"\r\n                  />\r\n                </svg>\r\n              </ir-icon>\r\n            )}\r\n            {this.hasDelete && <ir-icon id=\"book-delete\" icon=\"ft-trash-2 h1 danger m-0 ml-1 pointer\"></ir-icon>}\r\n            {this.hasMenu && <ir-icon id=\"menu\" icon=\"ft-list h1 color-ir-dark-blue-hover m-0 ml-1 pointer\"></ir-icon>}\r\n          </div>\r\n        </div>\r\n      </div>,\r\n      <div class=\"fluid-container p-1 text-left mx-0\">\r\n        <div class=\"row m-0\">\r\n          <div class=\"col-12 p-0 mx-0 pr-lg-1 col-lg-6\">\r\n            <div class=\"card\">\r\n              <div class=\"p-1\">\r\n                {this.bookingData.property.name || ''}\r\n                <ir-label label={`${this.defaultTexts.entries.Lcz_Source}:`} value={this.bookingData.origin.Label} imageSrc={this.bookingData.origin.Icon}></ir-label>\r\n                <ir-label\r\n                  label={`${this.defaultTexts.entries.Lcz_BookedBy}:`}\r\n                  value={`${this.bookingData.guest.first_name} ${this.bookingData.guest.last_name}`}\r\n                  iconShown={true}\r\n                ></ir-label>\r\n                <ir-label label={`${this.defaultTexts.entries.Lcz_Phone}:`} value={this.bookingData.guest.mobile}></ir-label>\r\n                <ir-label label={`${this.defaultTexts.entries.Lcz_Email}:`} value={this.bookingData.guest.email}></ir-label>\r\n                {this.bookingData.guest.alternative_email && (\r\n                  <ir-label label={`${this.defaultTexts.entries.Lcz_AlternativeEmail}:`} value={this.bookingData.guest.alternative_email}></ir-label>\r\n                )}\r\n                <ir-label label={`${this.defaultTexts.entries.Lcz_Address}:`} value={this.bookingData.guest.address}></ir-label>\r\n                <ir-label label={`${this.defaultTexts.entries.Lcz_ArrivalTime}:`} value={this.bookingData.arrival.description}></ir-label>\r\n                <ir-label label={`${this.defaultTexts.entries.Lcz_Note}:`} value={this.bookingData.remark}></ir-label>\r\n              </div>\r\n            </div>\r\n            <p class=\"font-size-large d-flex justify-content-between align-items-center mb-1\">\r\n              {`${_formatDate(this.bookingData.from_date)} - ${_formatDate(this.bookingData.to_date)} (${this._calculateNights(\r\n                this.bookingData.from_date,\r\n                this.bookingData.to_date,\r\n              )} ${\r\n                this._calculateNights(this.bookingData.from_date, this.bookingData.to_date) > 1\r\n                  ? ` ${this.defaultTexts.entries.Lcz_Nights}`\r\n                  : ` ${this.defaultTexts.entries.Lcz_Night}`\r\n              })`}\r\n              {this.hasRoomAdd && this.bookingData.is_direct && (\r\n                <ir-icon id=\"room-add\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"20\" width=\"17.5\" viewBox=\"0 0 448 512\" slot=\"icon\">\r\n                    <path\r\n                      fill=\"#6b6f82\"\r\n                      d=\"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z\"\r\n                    />\r\n                  </svg>\r\n                </ir-icon>\r\n              )}\r\n            </p>\r\n            <div class=\"card p-0 mx-0\">\r\n              {this.bookingData.rooms.map((room: Room, index: number) => {\r\n                const mealCodeName = room.rateplan.name;\r\n                const myRoomTypeFoodCat = room.roomtype.name;\r\n\r\n                return [\r\n                  <ir-room\r\n                    defaultTexts={this.defaultTexts}\r\n                    legendData={this.calendarData.legendData}\r\n                    roomsInfo={this.calendarData.roomsInfo}\r\n                    myRoomTypeFoodCat={myRoomTypeFoodCat}\r\n                    mealCodeName={mealCodeName}\r\n                    currency={this.bookingData.currency.code}\r\n                    hasRoomEdit={this.hasRoomEdit && this.bookingData.is_direct}\r\n                    hasRoomDelete={this.hasRoomDelete && this.bookingData.is_direct}\r\n                    hasCheckIn={this.hasCheckIn}\r\n                    hasCheckOut={this.hasCheckOut}\r\n                    bookingEvent={this.bookingData}\r\n                    bookingIndex={index}\r\n                    ticket={this.ticket}\r\n                    onDeleteFinished={this.handleDeleteFinish.bind(this)}\r\n                  />,\r\n                  // add separator if not last item with marginHorizontal and alignCenter\r\n                  index !== this.bookingData.rooms.length - 1 && <hr class=\"mr-2 ml-2 my-0 p-0\" />,\r\n                ];\r\n              })}\r\n            </div>\r\n            {calendar_data.pickup_service.is_enabled && this.bookingData.is_direct && (\r\n              <div class=\"mb-1\">\r\n                <div class={'d-flex w-100 mb-1 align-items-center justify-content-between'}>\r\n                  <p class={'font-size-large p-0 m-0 '}>{locales.entries.Lcz_Pickup}</p>\r\n                  <ir-icon class=\"pointer \" id=\"pickup\">\r\n                    <svg slot=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" height=\"20\" width=\"20\" viewBox=\"0 0 512 512\">\r\n                      <path\r\n                        fill=\"#6b6f82\"\r\n                        d=\"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z\"\r\n                      />\r\n                    </svg>\r\n                  </ir-icon>\r\n                </div>\r\n                {this.bookingData.pickup_info && (\r\n                  <div class={'card'}>\r\n                    <div class={'p-1'}>\r\n                      <div class={'d-flex align-items-center py-0 my-0 pickup-margin'}>\r\n                        <p class={'font-weight-bold mr-1 py-0 my-0'}>\r\n                          {locales.entries.Lcz_Date}: <span class={'font-weight-normal'}>{moment(this.bookingData.pickup_info.date, 'YYYY-MM-DD').format('ddd, DD MM YYYY')}</span>\r\n                        </p>\r\n                        <p class={'font-weight-bold flex-fill py-0 my-0'}>\r\n                          {locales.entries.Lcz_Time}:<span class={'font-weight-normal'}> {`${this.bookingData.pickup_info.hour}:${this.bookingData.pickup_info.minute}`}</span>\r\n                        </p>\r\n                        <p class={'font-weight-bold py-0 my-0'}>\r\n                          {locales.entries.Lcz_DueUponBooking}:{' '}\r\n                          <span class={'font-weight-normal'}>\r\n                            {this.bookingData.pickup_info.currency.symbol}\r\n                            {this.bookingData.pickup_info.total}\r\n                          </span>\r\n                        </p>\r\n                      </div>\r\n                      <p class={'font-weight-bold py-0 my-0'}>\r\n                        {locales.entries.Lcz_FlightDetails}:<span class={'font-weight-normal'}> {`${this.bookingData.pickup_info.details}`}</span>\r\n                      </p>\r\n                      <p class={'py-0 my-0 pickup-margin'}>{`${this.bookingData.pickup_info.selected_option.vehicle.description}`}</p>\r\n                      <p class={'font-weight-bold py-0 my-0 pickup-margin'}>\r\n                        {locales.entries.Lcz_NbrOfVehicles}:<span class={'font-weight-normal'}> {`${this.bookingData.pickup_info.nbr_of_units}`}</span>\r\n                      </p>\r\n                      <p class={'small py-0 my-0 pickup-margin'}>\r\n                        {calendar_data.pickup_service.pickup_instruction.description}\r\n                        {calendar_data.pickup_service.pickup_cancelation_prepayment.description}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n          <div class=\"col-12 p-0 m-0 pl-lg-1 col-lg-6\">\r\n            <ir-payment-details defaultTexts={this.defaultTexts} bookingDetails={this.bookingData}></ir-payment-details>\r\n          </div>\r\n        </div>\r\n      </div>,\r\n      <ir-sidebar\r\n        open={this.sidebarState !== null}\r\n        side={'right'}\r\n        id=\"editGuestInfo\"\r\n        onIrSidebarToggle={e => {\r\n          e.stopImmediatePropagation();\r\n          e.stopPropagation();\r\n          this.sidebarState = null;\r\n        }}\r\n        showCloseButton={false}\r\n      >\r\n        {this.sidebarState === 'guest' && (\r\n          <ir-guest-info\r\n            booking_nbr={this.bookingNumber}\r\n            defaultTexts={this.defaultTexts}\r\n            email={this.bookingData?.guest.email}\r\n            language={this.language}\r\n            onCloseSideBar={() => (this.sidebarState = null)}\r\n          ></ir-guest-info>\r\n        )}\r\n        {this.sidebarState === 'pickup' && (\r\n          <ir-pickup\r\n            defaultPickupData={this.bookingData.pickup_info}\r\n            bookingNumber={this.bookingData.booking_nbr}\r\n            numberOfPersons={this.bookingData.occupancy.adult_nbr + this.bookingData.occupancy.children_nbr}\r\n            onCloseModal={() => (this.sidebarState = null)}\r\n          ></ir-pickup>\r\n        )}\r\n      </ir-sidebar>,\r\n      <Fragment>\r\n        {this.bookingItem && (\r\n          <igl-book-property\r\n            allowedBookingSources={this.calendarData.allowed_booking_sources}\r\n            adultChildConstraints={this.calendarData.adult_child_constraints}\r\n            showPaymentDetails={this.showPaymentDetails}\r\n            countryNodeList={this.countryNodeList}\r\n            currency={this.calendarData.currency}\r\n            language={this.language}\r\n            propertyid={this.propertyid}\r\n            bookingData={this.bookingItem}\r\n            onCloseBookingWindow={() => this.handleCloseBookingWindow()}\r\n          ></igl-book-property>\r\n        )}\r\n      </Fragment>,\r\n    ];\r\n  }\r\n}\r\n",":host {\r\n  --viewport-padding: 25px;\r\n  position: fixed;\r\n  top: 0;\r\n  right: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: var(--viewport-padding);\r\n  gap: 10px;\r\n  max-width: 60vw;\r\n  margin: 0;\r\n  list-style: none;\r\n  z-index: 2147483647;\r\n  outline: none;\r\n  pointer-events: none;\r\n}\r\n\r\n.toast-container {\r\n  background-color: white;\r\n  border-radius: 6px;\r\n  box-shadow: hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;\r\n  padding: 15px 30px;\r\n  display: grid;\r\n  grid-template-areas: 'title action';\r\n  grid-template-columns: auto max-content;\r\n  column-gap: 15px;\r\n  align-items: center;\r\n  overflow: hidden;\r\n}\r\n.toast-container[data-state='open'] {\r\n  animation: slideIn 150ms cubic-bezier(0.16, 1, 0.3, 1) forwards;\r\n}\r\n.toast-container[data-state='closed'] {\r\n  pointer-events: none;\r\n  animation: fadeOut 150ms ease-in forwards;\r\n}\r\np {\r\n  margin: 0;\r\n  padding: 0;\r\n  grid-area: title;\r\n  font-weight: 500;\r\n  color: #1c2024;\r\n  font-size: 15px;\r\n}\r\n\r\n.x-mark-container,\r\n.check-mark-container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 1.5rem;\r\n  width: 1.5rem;\r\n  border-radius: 50%;\r\n}\r\n.x-mark-container {\r\n  background: red;\r\n}\r\n.check-mark-container {\r\n  background: rgb(9, 153, 9);\r\n}\r\n\r\n.loadingScreenContainer {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  height: 100vh;\r\n  width: 100vw;\r\n  z-index: 100000;\r\n  background: rgba(0, 0, 0, 0.2);\r\n  pointer-events: all;\r\n}\r\n\r\n@keyframes fadeOut {\r\n  0% {\r\n    opacity: 1;\r\n  }\r\n  100% {\r\n    opacity: 0;\r\n  }\r\n}\r\n@keyframes slideIn {\r\n  0% {\r\n    transform: translateX(calc(100% + var(--viewport-padding)));\r\n    opacity: 0;\r\n  }\r\n  100% {\r\n    transform: translateX(0);\r\n    opacity: 1;\r\n  }\r\n}\r\n","import { Component, Event, EventEmitter, Host, Prop, State, h } from '@stencil/core';\r\nimport axios from 'axios';\r\nimport { IToast } from '../ir-toast/toast';\r\n\r\n@Component({\r\n  tag: 'ir-interceptor',\r\n  styleUrl: 'ir-interceptor.css',\r\n  scoped: true,\r\n})\r\nexport class IrInterceptor {\r\n  @State() isShown = false;\r\n  @State() isLoading = false;\r\n  @State() isUnassignedUnit = false;\r\n\r\n  @Prop({ reflect: true, mutable: true }) defaultMessage = {\r\n    loadingMessage: 'Fetching Data',\r\n    errorMessage: 'Something Went Wrong',\r\n  };\r\n\r\n  @Prop({ reflect: true }) handledEndpoints = ['/ReAllocate_Exposed_Room'];\r\n  @Event({ bubbles: true, composed: true }) toast: EventEmitter<IToast>;\r\n  @Event({ bubbles: true, composed: true }) fetchingIrInterceptorDataStatus: EventEmitter<'pending' | 'done'>;\r\n  componentWillLoad() {\r\n    this.setupAxiosInterceptors();\r\n  }\r\n\r\n  setupAxiosInterceptors() {\r\n    axios.interceptors.request.use(this.handleRequest.bind(this), this.handleError.bind(this));\r\n    axios.interceptors.response.use(this.handleResponse.bind(this), this.handleError.bind(this));\r\n  }\r\n\r\n  extractEndpoint(url: string): string {\r\n    return url.split('?')[0];\r\n  }\r\n\r\n  isHandledEndpoint(url: string): boolean {\r\n    return this.handledEndpoints.includes(this.extractEndpoint(url));\r\n  }\r\n\r\n  /* HTML: <div class=\"loader\"></div> */\r\n  // .loader {\r\n  //   width: 60px;\r\n  //   aspect-ratio: 2;\r\n  //   --_g: no-repeat radial-gradient(circle closest-side,#000 90%,#0000);\r\n  //   background:\r\n  //     var(--_g) 0%   50%,\r\n  //     var(--_g) 50%  50%,\r\n  //     var(--_g) 100% 50%;\r\n  //   background-size: calc(100%/3) 50%;\r\n  //   animation: l3 1s infinite linear;\r\n  // }\r\n  // @keyframes l3 {\r\n  //     20%{background-position:0%   0%, 50%  50%,100%  50%}\r\n  //     40%{background-position:0% 100%, 50%   0%,100%  50%}\r\n  //     60%{background-position:0%  50%, 50% 100%,100%   0%}\r\n  //     80%{background-position:0%  50%, 50%  50%,100% 100%}\r\n  // }\r\n\r\n  handleRequest(config) {\r\n    this.fetchingIrInterceptorDataStatus.emit('pending');\r\n    if (this.isHandledEndpoint(config.url)) {\r\n      this.isLoading = true;\r\n      if (this.extractEndpoint(config.url) === '/ReAllocate_Exposed_Room') {\r\n        this.defaultMessage.loadingMessage = 'Updating Event';\r\n      } else if (this.extractEndpoint(config.url) === '/Get_Aggregated_UnAssigned_Rooms') {\r\n        this.isUnassignedUnit = true;\r\n      } else {\r\n        this.defaultMessage.loadingMessage = 'Fetching Data';\r\n      }\r\n      this.showToast();\r\n    }\r\n    return config;\r\n  }\r\n\r\n  handleResponse(response) {\r\n    this.isLoading = false;\r\n    this.fetchingIrInterceptorDataStatus.emit('done');\r\n    if (response.data.ExceptionMsg?.trim()) {\r\n      this.handleError(response.data.ExceptionMsg);\r\n      throw new Error(response.data.ExceptionMsg);\r\n    } else {\r\n      this.hideToastAfterDelay(true);\r\n    }\r\n    return response;\r\n  }\r\n\r\n  handleError(error) {\r\n    if (this.isUnassignedUnit) {\r\n      this.isUnassignedUnit = false;\r\n    }\r\n\r\n    this.hideToastAfterDelay(true);\r\n    this.toast.emit({\r\n      type: 'error',\r\n      title: error,\r\n      description: '',\r\n      position: 'top-right',\r\n    });\r\n    return Promise.reject(error);\r\n  }\r\n\r\n  showToast() {\r\n    this.isShown = true;\r\n  }\r\n\r\n  hideToastAfterDelay(isSuccess: boolean) {\r\n    if (this.isUnassignedUnit) {\r\n      this.isShown = false;\r\n      this.isUnassignedUnit = false;\r\n    } else {\r\n      const delay = isSuccess ? 0 : 5000;\r\n      setTimeout(() => {\r\n        this.isShown = false;\r\n      }, delay);\r\n    }\r\n  }\r\n\r\n  renderMessage(): string {\r\n    return this.defaultMessage.errorMessage;\r\n  }\r\n  render() {\r\n    return (\r\n      <Host>\r\n        {this.isLoading && this.isShown && (\r\n          <div class=\"loadingScreenContainer\">\r\n            <div class=\"loadingContainer\">\r\n              <ir-loading-screen></ir-loading-screen>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n  box-sizing: border-box;\r\n  margin: 0;\r\n}\r\n\r\n.close-icon {\r\n  position: absolute;\r\n  top: 18px;\r\n  right: 33px;\r\n  outline: none;\r\n}\r\n.close {\r\n  float: right;\r\n  font-size: 1.5rem;\r\n  font-weight: 700;\r\n  line-height: 1;\r\n  color: #000;\r\n  text-shadow: 0 1px 0 #fff;\r\n  opacity: 0.5;\r\n\r\n  padding: 0;\r\n  background-color: transparent;\r\n  border: 0;\r\n  appearance: none;\r\n}\r\n.card {\r\n  top: 0;\r\n  z-index: 1000;\r\n}\r\n.card-title {\r\n  border-bottom: 1px solid #e4e5ec;\r\n  width: 100%;\r\n}\r\n.irfontgreen {\r\n  color: #0e930e;\r\n}\r\n.currency {\r\n  display: block;\r\n  position: absolute;\r\n  margin: 0;\r\n  padding: 0;\r\n  height: auto;\r\n  left: 10px;\r\n}\r\n.rate-input {\r\n  font-size: 14px;\r\n  line-height: 0;\r\n  padding: 0;\r\n  height: 0;\r\n}\r\n.rate-input-container {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  box-sizing: border-box;\r\n  flex: 1;\r\n}\r\n","import { Component, Host, Prop, State, h, Event, EventEmitter, Fragment } from '@stencil/core';\r\nimport axios from 'axios';\r\nimport { BookingService } from '../../services/booking.service';\r\nimport { convertDatePrice, formatDate, getCurrencySymbol, getDaysArray } from '../../utils/utils';\r\nimport { Booking, Day, IUnit, Room } from '../../models/booking.dto';\r\nimport { IRoomNightsDataEventPayload } from '../../models/property-types';\r\nimport { v4 } from 'uuid';\r\nimport moment from 'moment';\r\nimport locales from '@/stores/locales.store';\r\n\r\n@Component({\r\n  tag: 'ir-room-nights',\r\n  styleUrl: 'ir-room-nights.css',\r\n  scoped: true,\r\n})\r\nexport class IrRoomNights {\r\n  @Prop() bookingNumber: string;\r\n  @Prop() baseUrl: string;\r\n  @Prop() propertyId: number;\r\n  @Prop() language: string;\r\n  @Prop() identifier: string;\r\n  @Prop() toDate: string;\r\n  @Prop() fromDate: string;\r\n  @Prop() pool: string;\r\n  @Prop() ticket: string;\r\n\r\n  @State() bookingEvent: Booking;\r\n  @State() selectedRoom: Room;\r\n  @State() rates: Day[] = [];\r\n  @State() isLoading = false;\r\n  @State() initialLoading = false;\r\n  @State() inventory: number | null = null;\r\n  @State() isEndDateBeforeFromDate: boolean = false;\r\n  @State() defaultTotalNights = 0;\r\n\r\n  @Event() closeRoomNightsDialog: EventEmitter<IRoomNightsDataEventPayload>;\r\n\r\n  private bookingService = new BookingService();\r\n\r\n  componentWillLoad() {\r\n    if (this.baseUrl) {\r\n      axios.defaults.baseURL = this.baseUrl;\r\n    }\r\n    this.init();\r\n  }\r\n\r\n  isButtonDisabled() {\r\n    return this.isLoading || this.rates.some(rate => rate.amount === -1) || this.inventory === 0 || this.inventory === null;\r\n  }\r\n  async init() {\r\n    try {\r\n      this.bookingEvent = await this.bookingService.getExposedBooking(this.bookingNumber, this.language);\r\n\r\n      if (this.bookingEvent) {\r\n        const filteredRooms = this.bookingEvent.rooms.filter(room => room.identifier === this.identifier);\r\n        this.selectedRoom = filteredRooms[0];\r\n\r\n        const lastDay = this.selectedRoom?.days[this.selectedRoom.days.length - 1];\r\n        //let first_rate = this.selectedRoom.days[0].amount;\r\n        if (moment(this.toDate).add(-1, 'days').isSame(moment(lastDay.date))) {\r\n          const amount = await this.fetchBookingAvailability(\r\n            this.fromDate,\r\n            this.selectedRoom.days[0].date,\r\n            this.selectedRoom.rateplan.id,\r\n            this.selectedRoom.rateplan.selected_variation.adult_child_offering,\r\n          );\r\n          const newDatesArr = getDaysArray(this.selectedRoom.days[0].date, this.fromDate);\r\n          this.isEndDateBeforeFromDate = true;\r\n          this.rates;\r\n          this.rates = [\r\n            ...newDatesArr.map(day => ({\r\n              amount,\r\n              date: day,\r\n            })),\r\n            ...this.selectedRoom.days,\r\n          ];\r\n        } else {\r\n          const amount = await this.fetchBookingAvailability(\r\n            lastDay.date,\r\n            moment(this.toDate, 'YYYY-MM-DD').add(-1, 'days').format('YYYY-MM-DD'),\r\n            this.selectedRoom.rateplan.id,\r\n            this.selectedRoom.rateplan.selected_variation.adult_child_offering,\r\n          );\r\n          const newDatesArr = getDaysArray(lastDay.date, this.toDate);\r\n          this.rates = [\r\n            ...this.selectedRoom.days,\r\n            ...newDatesArr.map(day => ({\r\n              amount,\r\n              date: day,\r\n            })),\r\n          ];\r\n        }\r\n        this.defaultTotalNights = this.rates.length - this.selectedRoom.days.length;\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  handleInput(event: InputEvent, index: number) {\r\n    let inputElement = event.target as HTMLInputElement;\r\n    let inputValue = inputElement.value;\r\n    let days = [...this.rates];\r\n    inputValue = inputValue.replace(/[^0-9.]/g, '');\r\n    if (inputValue === '') {\r\n      days[index].amount = -1;\r\n    } else {\r\n      const decimalCheck = inputValue.split('.');\r\n      if (decimalCheck.length > 2) {\r\n        inputValue = inputValue.substring(0, inputValue.length - 1);\r\n        inputElement.value = inputValue;\r\n      } else if (decimalCheck.length === 2 && decimalCheck[1].length > 2) {\r\n        inputValue = `${decimalCheck[0]}.${decimalCheck[1].substring(0, 2)}`;\r\n        inputElement.value = inputValue;\r\n      }\r\n      if (!isNaN(Number(inputValue))) {\r\n        days[index].amount = Number(inputValue);\r\n      }\r\n    }\r\n    this.rates = days;\r\n    console.log(this.rates);\r\n  }\r\n  async fetchBookingAvailability(from_date: string, to_date: string, rate_plan_id: number, selected_variation: string) {\r\n    try {\r\n      this.initialLoading = true;\r\n      const bookingAvailability = await this.bookingService.getBookingAvailability(\r\n        from_date,\r\n        to_date,\r\n        this.propertyId,\r\n        {\r\n          adult: this.selectedRoom.rateplan.selected_variation.adult_nbr,\r\n          child: this.selectedRoom.rateplan.selected_variation.child_nbr,\r\n        },\r\n        this.language,\r\n        [this.selectedRoom.roomtype.id],\r\n        this.bookingEvent.currency,\r\n      );\r\n      this.inventory = bookingAvailability.roomtypes[0].inventory;\r\n      const rate_plan_index = bookingAvailability.roomtypes[0].rateplans.find(rate => rate.id === rate_plan_id);\r\n      const { amount } = rate_plan_index.variations.find(variation => variation.adult_child_offering === selected_variation);\r\n      return amount;\r\n    } catch (error) {\r\n      console.log(error);\r\n    } finally {\r\n      this.initialLoading = false;\r\n    }\r\n  }\r\n  renderInputField(index: number, currency_symbol: string, day: Day) {\r\n    return (\r\n      <fieldset class=\"col-2 ml-1 position-relative has-icon-left m-0 p-0 rate-input-container\">\r\n        <input\r\n          disabled={this.inventory === 0 || this.inventory === null}\r\n          type=\"text\"\r\n          class=\"form-control input-sm rate-input py-0 m-0 rateInputBorder\"\r\n          id={v4()}\r\n          value={day.amount > 0 ? day.amount : ''}\r\n          placeholder={locales.entries.Lcz_Rate || 'Rate'}\r\n          onInput={event => this.handleInput(event, index)}\r\n        />\r\n        <span class=\"currency\">{currency_symbol}</span>\r\n      </fieldset>\r\n    );\r\n  }\r\n  renderReadOnlyField(currency_symbol: string, day: Day) {\r\n    return <p class=\"col-9 ml-1 m-0 p-0\">{`${currency_symbol}${Number(day.amount).toFixed(2)}`}</p>;\r\n  }\r\n  renderRateFields(index: number, currency_symbol: string, day: Day) {\r\n    if (this.isEndDateBeforeFromDate) {\r\n      if (index < this.defaultTotalNights) {\r\n        return this.renderInputField(index, currency_symbol, day);\r\n      } else {\r\n        return this.renderReadOnlyField(currency_symbol, day);\r\n      }\r\n    } else {\r\n      return index < this.selectedRoom.days.length ? this.renderReadOnlyField(currency_symbol, day) : this.renderInputField(index, currency_symbol, day);\r\n    }\r\n  }\r\n  renderDates() {\r\n    const currency_symbol = getCurrencySymbol(this.bookingEvent.currency.code);\r\n    return (\r\n      <div class={'mt-2 m-0'}>\r\n        {this.rates?.map((day, index) => (\r\n          <div class={'row m-0 mt-1 align-items-center'}>\r\n            <p class={'col-2 m-0 p-0'}>{convertDatePrice(day.date)}</p>\r\n            {this.renderRateFields(index, currency_symbol, day)}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n  async handleRoomConfirmation() {\r\n    try {\r\n      this.isLoading = true;\r\n      let oldRooms = [...this.bookingEvent.rooms];\r\n      let selectedRoomIndex = oldRooms.findIndex(room => room.identifier === this.identifier);\r\n      if (selectedRoomIndex === -1) {\r\n        throw new Error('Invalid Pool');\r\n      }\r\n      oldRooms[selectedRoomIndex] = { ...oldRooms[selectedRoomIndex], days: this.rates, to_date: this.toDate, from_date: this.fromDate };\r\n      const body = {\r\n        assign_units: true,\r\n        check_in: true,\r\n        is_pms: true,\r\n        is_direct: true,\r\n        booking: {\r\n          booking_nbr: this.bookingNumber,\r\n          from_date: this.fromDate,\r\n          to_date: this.toDate,\r\n          remark: this.bookingEvent.remark,\r\n          property: this.bookingEvent.property,\r\n          source: this.bookingEvent.source,\r\n          currency: this.bookingEvent.currency,\r\n          arrival: this.bookingEvent.arrival,\r\n          guest: this.bookingEvent.guest,\r\n          rooms: oldRooms,\r\n        },\r\n      };\r\n      const { data } = await axios.post(`/DoReservation?Ticket=${this.ticket}`, body);\r\n      if (data.ExceptionMsg !== '') {\r\n        throw new Error(data.ExceptionMsg);\r\n      }\r\n      this.closeRoomNightsDialog.emit({ type: 'confirm', pool: this.pool });\r\n    } catch (error) {\r\n    } finally {\r\n      this.isLoading = false;\r\n    }\r\n  }\r\n  render() {\r\n    if (!this.bookingEvent) {\r\n      return <p>{locales.entries.Lcz_Loading}</p>;\r\n    }\r\n    return (\r\n      <Host>\r\n        <div class=\"card position-sticky mb-0 shadow-none p-0 \">\r\n          <div class=\"d-flex mt-2 align-items-center justify-content-between \">\r\n            <h3 class=\"card-title text-left pb-1 font-medium-2 px-2\">\r\n              {locales.entries.Lcz_AddingRoomNightsTo} {this.selectedRoom?.roomtype?.name} {(this.selectedRoom?.unit as IUnit).name}\r\n            </h3>\r\n            <button type=\"button\" class=\"close close-icon\" onClick={() => this.closeRoomNightsDialog.emit({ type: 'cancel', pool: this.pool })}>\r\n              <ir-icon icon=\"ft-x\" class={'m-0'}></ir-icon>\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <section class={'text-left px-2'}>\r\n          <p class={'font-medium-1'}>\r\n            {`${locales.entries.Lcz_Booking}#`} {this.bookingNumber}\r\n          </p>\r\n          <p class={'font-weight-bold font-medium-1'}>{`${formatDate(this.fromDate, 'YYYY-MM-DD')} - ${formatDate(this.toDate, 'YYYY-MM-DD')}`}</p>\r\n          {this.initialLoading ? (\r\n            <p class={'mt-2 text-secondary'}>{locales.entries['Lcz_CheckingRoomAvailability ']}</p>\r\n          ) : (\r\n            <Fragment>\r\n              <p class={'font-medium-1 mb-0'}>\r\n                {`${this.selectedRoom.rateplan.name}`} {this.selectedRoom.rateplan.is_non_refundable && <span class={'irfontgreen'}>{locales.entries.Lcz_NonRefundable}</span>}\r\n              </p>\r\n              {(this.inventory === 0 || this.inventory === null) && <p class=\"font-medium-1 text danger\">{locales.entries.Lcz_NoAvailabilityForAdditionalNights}</p>}\r\n\r\n              {this.selectedRoom.rateplan.custom_text && <p class={'text-secondary mt-0'}>{this.selectedRoom.rateplan.custom_text}</p>}\r\n              {this.renderDates()}\r\n            </Fragment>\r\n          )}\r\n        </section>\r\n        <section class={'d-flex align-items-center mt-2 px-2'}>\r\n          <button\r\n            disabled={this.isLoading}\r\n            type=\"button\"\r\n            class={'btn btn-secondary full-width'}\r\n            onClick={() => this.closeRoomNightsDialog.emit({ type: 'cancel', pool: this.pool })}\r\n          >\r\n            {locales?.entries.Lcz_Cancel}\r\n          </button>\r\n          {this.inventory > 0 && this.inventory !== null && (\r\n            <button disabled={this.isButtonDisabled()} type=\"button\" class={'btn btn-primary ml-2 full-width'} onClick={this.handleRoomConfirmation.bind(this)}>\r\n              {this.isLoading && <i class=\"la la-circle-o-notch spinner mx-1\"></i>}\r\n              {locales?.entries.Lcz_Confirm}\r\n            </button>\r\n          )}\r\n        </section>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n","button,\r\np,\r\nh3,\r\ndiv {\r\n  all: unset;\r\n}\r\n:host {\r\n  --rd-viewport-padding: 25px;\r\n  --rd-success: #2b9a66;\r\n  position: fixed;\r\n  bottom: 0;\r\n  right: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: var(--rd-viewport-padding);\r\n  gap: 10px;\r\n  max-width: 100vw;\r\n  margin: 0;\r\n  list-style: none;\r\n  z-index: 2147483647;\r\n  outline: none;\r\n  pointer-events: none;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n}\r\n@media (prefers-color-scheme: dark) {\r\n  :host {\r\n    --rd-success: #33b074;\r\n  }\r\n}\r\np {\r\n  color: hsla(222.2, 84%, 4.9%, 0.8);\r\n  font-size: 13px;\r\n  line-height: 1.3;\r\n}\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n  font-weight: 500;\r\n  color: hsl(222.2, 84%, 4.9%);\r\n  font-size: 15px;\r\n}\r\n:host([position='top-left']) {\r\n  top: 0;\r\n  left: 0;\r\n}\r\n:host([position='top-right']) {\r\n  top: 0;\r\n  right: 0;\r\n}\r\n:host([position='bottom-left']) {\r\n  bottom: 0;\r\n  left: 0;\r\n}\r\n:host([position='bottom-right']) {\r\n  bottom: 0;\r\n  right: 0;\r\n}\r\n.icon-container {\r\n  height: 25px;\r\n  width: 25px;\r\n  border-radius: 25px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 0;\r\n  margin: 0;\r\n  /* position: absolute;\r\n  top: 50%;\r\n  right: calc(var(--rd-viewport-padding) / 2); \r\n  transform: translateY(-50%);*/\r\n}\r\n.icon-container > svg {\r\n  margin: 0;\r\n  color: white;\r\n  stroke-width: 5px;\r\n}\r\n.success {\r\n  background-color: var(--rd-success);\r\n}\r\n.error {\r\n  background-color: red;\r\n}\r\n.ToastRoot {\r\n  background-color: hsl(0, 0%, 100%);\r\n  border-radius: 0.5rem;\r\n  box-shadow: hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px;\r\n  padding: 15px;\r\n  display: grid;\r\n  grid-template-areas: 'title action' 'description action';\r\n  grid-template-columns: auto max-content;\r\n  column-gap: 15px;\r\n  align-items: center;\r\n  pointer-events: none;\r\n  opacity: 0;\r\n  border: 1px solid hsl(214.3, 31.8%, 91.4%);\r\n  position: relative;\r\n}\r\n.ToastRoot[data-state='open'] {\r\n  pointer-events: all;\r\n  animation: slideIn 150ms cubic-bezier(0.16, 1, 0.3, 1);\r\n}\r\n.ToastRoot[data-state='closed'] {\r\n  pointer-events: none;\r\n  animation: hide 100ms ease-in;\r\n}\r\n\r\n@-webkit-keyframes slideIn {\r\n  from {\r\n    transform: translateX(var(--rd-offset-width));\r\n  }\r\n  to {\r\n    transform: translateX(0);\r\n  }\r\n}\r\n@keyframes slideIn {\r\n  from {\r\n    transform: translateX(var(--rd-offset-width));\r\n  }\r\n  to {\r\n    transform: translateX(0);\r\n  }\r\n}\r\n.ToastTitle {\r\n  grid-area: title;\r\n  font-weight: 500;\r\n  color: hsl(222.2, 84%, 4.9%);\r\n  font-size: 15px;\r\n}\r\n\r\n.ToastDescription {\r\n  grid-area: description;\r\n  margin: 0;\r\n  margin-top: 5px;\r\n  color: hsla(222.2, 84%, 4.9%, 0.8);\r\n  font-size: 13px;\r\n  line-height: 1.3;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n.ToastAction {\r\n  grid-area: action;\r\n}\r\n","import { Component, Fragment, Host, Element, Listen, Method, Prop, State, h } from '@stencil/core';\r\nimport { TPositions, IToast } from './toast';\r\n\r\n@Component({\r\n  tag: 'ir-toast',\r\n  styleUrl: 'ir-toast.css',\r\n  scoped: true,\r\n})\r\nexport class IrToast {\r\n  @Prop({ reflect: true, mutable: true }) position: TPositions = 'bottom-left';\r\n  @State() isVisible = false;\r\n  @State() isFocused = false;\r\n  @Element() element: HTMLElement;\r\n  private toastRef: HTMLElement;\r\n  private duration = 5000;\r\n  private showToastTimeOut: any;\r\n  private toastBody: IToast = { description: '', type: 'success' };\r\n  applyStyles(style: Partial<CSSStyleDeclaration>) {\r\n    for (const property in style) {\r\n      if (style.hasOwnProperty(property)) {\r\n        this.toastRef.style[property] = style[property];\r\n      }\r\n    }\r\n  }\r\n  @Listen('toast', { target: 'body' })\r\n  onToast(event: CustomEvent<IToast>) {\r\n    event.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n    const { duration, position, style } = event.detail;\r\n    this.toastBody = event.detail;\r\n    if (position) {\r\n      this.position = position;\r\n    }\r\n    if (duration) {\r\n      this.duration = duration;\r\n    }\r\n    if (style) {\r\n      this.applyStyles(style);\r\n    }\r\n    this.showToast();\r\n    this.setToastTimeout();\r\n  }\r\n  setToastTimeout() {\r\n    this.showToastTimeOut = setTimeout(() => {\r\n      this.hideToast();\r\n    }, this.duration);\r\n  }\r\n  clearToastTimeout() {\r\n    if (this.showToastTimeOut) {\r\n      clearTimeout(this.showToastTimeOut);\r\n      this.showToastTimeOut = undefined;\r\n    }\r\n  }\r\n  @Method()\r\n  async hideToast() {\r\n    this.clearToastTimeout();\r\n    this.toastRef.setAttribute('data-state', 'close');\r\n    this.toastRef.style.opacity = '0';\r\n    this.isVisible = false;\r\n  }\r\n  @Method()\r\n  async showToast() {\r\n    this.clearToastTimeout();\r\n    this.toastRef.style.opacity = '1';\r\n    this.toastRef.setAttribute('data-state', 'open');\r\n    this.isVisible = true;\r\n  }\r\n  disconnectedCallback() {\r\n    this.clearToastTimeout();\r\n  }\r\n  renderIcon() {\r\n    switch (this.toastBody.type) {\r\n      case 'success':\r\n        return (\r\n          <div class=\"icon-container success\">\r\n            <svg width=\"15\" height=\"15\" viewBox=\"0 0 15 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n              <path\r\n                d=\"M11.4669 3.72684C11.7558 3.91574 11.8369 4.30308 11.648 4.59198L7.39799 11.092C7.29783 11.2452 7.13556 11.3467 6.95402 11.3699C6.77247 11.3931 6.58989 11.3355 6.45446 11.2124L3.70446 8.71241C3.44905 8.48022 3.43023 8.08494 3.66242 7.82953C3.89461 7.57412 4.28989 7.55529 4.5453 7.78749L6.75292 9.79441L10.6018 3.90792C10.7907 3.61902 11.178 3.53795 11.4669 3.72684Z\"\r\n                fill=\"currentColor\"\r\n                fill-rule=\"evenodd\"\r\n                clip-rule=\"evenodd\"\r\n              ></path>\r\n            </svg>\r\n          </div>\r\n        );\r\n      case 'error':\r\n        return (\r\n          <div class=\"icon-container error\">\r\n            <svg width=\"15\" height=\"15\" viewBox=\"0 0 15 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n              <path\r\n                d=\"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z\"\r\n                fill=\"currentColor\"\r\n                fill-rule=\"evenodd\"\r\n                clip-rule=\"evenodd\"\r\n              ></path>\r\n            </svg>\r\n          </div>\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <section aria-live=\"off\" role=\"status\" aria-atomic=\"true\" ref={el => (this.toastRef = el)} class={`ToastRoot`}>\r\n          {this.isVisible && (\r\n            <Fragment>\r\n              {this.toastBody.type === 'custom' ? (\r\n                this.toastBody.body\r\n              ) : (\r\n                <Fragment>\r\n                  {this.toastBody.title !== '' && <h3 class=\"ToastTitle\">{this.toastBody.title}</h3>}\r\n                  {this.toastBody.description !== '' && <p class=\"ToastDescription\">{this.toastBody.description}</p>}\r\n                  {this.renderIcon()}\r\n                </Fragment>\r\n              )}\r\n            </Fragment>\r\n          )}\r\n        </section>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"}