import{r as i,c as t,h as s,F as o,g as e}from"./p-1da6dd41.js";import{l as h}from"./p-cda0b50c.js";import{v as r}from"./p-d4c9256e.js";import"./p-58003fb6.js";const a=".sc-ir-combobox-h{display:block;position:relative;padding:0;margin:0}ul.sc-ir-combobox{position:absolute;margin:0;margin-top:2px;width:max-content;max-height:80px;border-radius:0.21rem;z-index:10000;padding:1px;background:white;box-shadow:0px 8px 16px 0px rgba(0, 0, 0, 0.2);padding:5px 0;max-height:250px;overflow-y:auto;min-width:100%}ul[data-position='bottom-right'].sc-ir-combobox{right:0}.dropdown-item.sc-ir-combobox{cursor:pointer}ul.sc-ir-combobox li.sc-ir-combobox,span.sc-ir-combobox,loader-container.sc-ir-combobox{padding:0px 16px;margin:0px;margin-top:2px;width:100%;border-radius:2px}ul.sc-ir-combobox li.sc-ir-combobox{cursor:pointer}ul.sc-ir-combobox li.sc-ir-combobox{display:flex;align-items:center;flex-wrap:wrap;gap:3px}ul.sc-ir-combobox li.sc-ir-combobox p.sc-ir-combobox{margin:0;padding:0}ul.sc-ir-combobox li.sc-ir-combobox:hover{background:#f4f5fa}ul.sc-ir-combobox li[data-selected].sc-ir-combobox,ul.sc-ir-combobox li[data-selected].sc-ir-combobox:hover{color:#fff;text-decoration:none;background-color:#666ee8}";const l=class{constructor(s){i(this,s);this.comboboxValueChange=t(this,"comboboxValueChange",7);this.inputCleared=t(this,"inputCleared",7);this.toast=t(this,"toast",7);this.data=[];this.duration=300;this.placeholder=undefined;this.value=undefined;this.disabled=false;this.autoFocus=false;this.input_id=r();this.selectedIndex=-1;this.actualIndex=-1;this.isComboBoxVisible=false;this.isLoading=true;this.isItemSelected=undefined;this.inputValue="";this.filteredData=[];this.componentShouldAutoFocus=false}componentWillLoad(){this.filteredData=this.data}componentDidLoad(){if(this.autoFocus){this.focusInput()}}watchHandler(i,t){if(i!==t&&i===true){this.focusInput()}}handleKeyDown(i){var t;const s=this.filteredData.length;if(s>0){switch(i.key){case"ArrowUp":i.preventDefault();this.selectedIndex=(this.selectedIndex-1+s)%s;this.adjustScrollPosition();break;case"ArrowDown":i.preventDefault();this.selectedIndex=(this.selectedIndex+1)%s;this.adjustScrollPosition();break;case"Escape":(t=this.inputRef)===null||t===void 0?void 0:t.blur();this.isComboBoxVisible=false;break}}}focusInput(){requestAnimationFrame((()=>{var i;(i=this.inputRef)===null||i===void 0?void 0:i.focus()}))}adjustScrollPosition(){var i;const t=(i=this.el)===null||i===void 0?void 0:i.querySelector(`[data-selected]`);if(!t)return;t.scrollIntoView({block:"center"})}selectItem(i){if(this.filteredData[i]){this.isItemSelected=true;this.comboboxValueChange.emit({key:"select",data:this.filteredData[i].id});this.inputValue="";this.resetCombobox();if(this.autoFocus){this.focusInput()}}}debounceFetchData(){clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout((()=>{this.fetchData()}),this.duration)}handleFocus(){this.isComboBoxVisible=true}clearInput(){this.inputValue="";this.resetCombobox();this.inputCleared.emit(null)}resetCombobox(i=true){var t;if(i){(t=this.inputRef)===null||t===void 0?void 0:t.blur()}this.selectedIndex=-1;this.isComboBoxVisible=false}async fetchData(){try{this.isLoading=true;this.filteredData=this.data.filter((i=>i.name.toLowerCase().startsWith(this.inputValue)));this.selectedIndex=-1}catch(i){console.log("error",i)}finally{this.isLoading=false}}handleInputChange(i){this.inputValue=i.target.value;if(this.inputValue){this.debounceFetchData()}else{this.filteredData=this.data}}handleDocumentClick(i){const t=i.target;if(!this.el.contains(t)){this.isComboBoxVisible=false}}handleBlur(){this.blurTimout=setTimeout((()=>{if(!this.isItemSelected){this.inputValue="";this.resetCombobox()}else{this.isItemSelected=false}}),300)}isDropdownItem(i){return i&&i.closest(".combobox")}disconnectedCallback(){var i,t,s,o;clearTimeout(this.debounceTimer);clearTimeout(this.blurTimout);(i=this.inputRef)===null||i===void 0?void 0:i.removeEventListener("blur",this.handleBlur);(t=this.inputRef)===null||t===void 0?void 0:t.removeEventListener("click",this.selectItem);(s=this.inputRef)===null||s===void 0?void 0:s.removeEventListener("keydown",this.handleKeyDown);(o=this.inputRef)===null||o===void 0?void 0:o.removeEventListener("focus",this.handleFocus)}handleItemKeyDown(i,t){var s;if(i.key==="Enter"||i.key===" "||i.key==="ArrowRight"){this.selectItem(t);i.preventDefault()}else if(i.key==="Escape"){this.isComboBoxVisible=false;(s=this.inputRef)===null||s===void 0?void 0:s.blur();i.preventDefault()}}renderDropdown(){var i;if(!this.isComboBoxVisible){return null}return s("ul",{"data-position":this.filteredData.length>0&&this.filteredData[0].occupancy?"bottom-right":"bottom-left"},(i=this.filteredData)===null||i===void 0?void 0:i.map(((i,t)=>s("li",{onMouseEnter:()=>this.selectedIndex=t,role:"button",key:i.id,onKeyDown:i=>this.handleItemKeyDown(i,t),"data-selected":this.selectedIndex===t,tabIndex:0,onClick:()=>this.selectItem(t)},s("p",null,i.name),i.occupancy&&s(o,null,s("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},s("path",{fill:"currentColor",d:"M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"})),s("p",null,i.occupancy))))),this.filteredData.length===0&&!this.isLoading&&s("span",{class:"text-center"},h.entries.Lcz_NoResultsFound))}handleSubmit(i){i.preventDefault();i.stopPropagation();console.log("object");if(!this.filteredData.length){return}this.selectItem(this.selectedIndex===-1?0:this.selectedIndex)}render(){return s("form",{onSubmit:this.handleSubmit.bind(this),class:"m-0 p-0"},s("input",{type:"text",class:"form-control bg-white",id:this.input_id,ref:i=>this.inputRef=i,disabled:this.disabled,value:this.value,placeholder:this.placeholder,onKeyDown:this.handleKeyDown.bind(this),onBlur:this.handleBlur.bind(this),onInput:this.handleInputChange.bind(this),onFocus:this.handleFocus.bind(this),autoFocus:this.autoFocus}),this.renderDropdown())}get el(){return e(this)}static get watchers(){return{isComboBoxVisible:["watchHandler"]}}};l.style=a;export{l as ir_combobox};
//# sourceMappingURL=p-d2e1fa7a.entry.js.map