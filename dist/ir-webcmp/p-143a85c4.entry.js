import{r as t,h as i,H as s,g as e}from"./p-1da6dd41.js";import{B as l,b as o,o as n,u as a}from"./p-74bb5da7.js";import{R as c}from"./p-d49e89bc.js";import{l as h}from"./p-383186e3.js";import{f as r}from"./p-881be465.js";import{a as d}from"./p-d0086f2b.js";import{h as g}from"./p-fe6c3d31.js";import"./p-ac2141fd.js";const p=".sc-ir-booking-listing-h{display:block;height:100vh}.card.sc-ir-booking-listing{overflow-x:auto}.secondary-p.sc-ir-booking-listing{font-size:12px !important}.h-screen.sc-ir-booking-listing{height:100vh}.main-container.sc-ir-booking-listing{height:100vh;overflow-y:auto}.bg-ir-red.sc-ir-booking-listing{background:#ff4961;height:28px;padding-top:0 !important;padding-bottom:0 !important}.due-btn.sc-ir-booking-listing{border:1px solid #ff4961;color:#ff4961;cursor:pointer;padding:1px 0.25rem !important;font-size:12px !important}.due-btn.sc-ir-booking-listing:hover{background:#ff4961;color:white}.booking_number.sc-ir-booking-listing{all:unset;cursor:pointer}.booking_number.sc-ir-booking-listing:hover{color:#1e9ff2}.in-out.sc-ir-booking-listing{width:150px !important}.buttons-container.sc-ir-booking-listing{gap:10px}";const b=class{constructor(i){t(this,i);this.bookingListingService=new l;this.roomService=new c;this.itemsPerPage=20;this.language="";this.ticket="";this.baseurl="";this.propertyid=undefined;this.isLoading=false;this.currentPage=1;this.totalPages=1;this.oldStartValue=0;this.editBookingItem=null}componentWillLoad(){if(this.baseurl){d.defaults.baseURL=this.baseurl}if(this.ticket!==""){this.bookingListingService.setToken(this.ticket);this.roomService.setToken(this.ticket);o.token=this.ticket;this.initializeApp()}n("userSelection",(async t=>{const i=t.total_count;if(i&&this.totalPages!==i){this.totalPages=Math.round(i/this.itemsPerPage)}}))}async ticketChanged(t,i){if(t!==i){this.bookingListingService.setToken(this.ticket);this.roomService.setToken(this.ticket);o.token=this.ticket;this.initializeApp()}}async initializeApp(){try{this.isLoading=true;a("property_id",this.propertyid);await Promise.all([this.bookingListingService.getExposedBookingsCriteria(),this.roomService.fetchLanguage(this.language,["_BOOKING_LIST_FRONT"])]);await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},o.userSelection),{is_to_export:false}))}catch(t){console.error(t)}finally{this.isLoading=false}}handleSideBarToggle(t){if(t.detail){if(this.editBookingItem){this.editBookingItem=null}}}openModal(){if(!this.listingModal){this.listingModal=this.el.querySelector("ir-listing-modal")}this.listingModal.editBooking=this.editBookingItem;this.listingModal.openModal()}async handleResetData(t){t.stopImmediatePropagation();t.stopPropagation();await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},o.userSelection),{is_to_export:false}))}renderItemRange(){const t=o.userSelection.total_count;const i=(this.currentPage-1)*this.itemsPerPage+1;let s=this.currentPage*this.itemsPerPage;s=s>t?t:s;o.userSelection=Object.assign(Object.assign({},o.userSelection),{start_row:i-1,end_row:s});return`${h.entries.Lcz_View} ${i} - ${s} ${h.entries.Lcz_Of} ${t}`}async updateData(){const{total_count:t}=o.userSelection;let i=this.currentPage*this.itemsPerPage;i=i>t?t:i;const s=(this.currentPage-1)*this.itemsPerPage;await this.bookingListingService.getExposedBookings(Object.assign(Object.assign({},o.userSelection),{is_to_export:false,start_row:s,end_row:i}))}render(){var t,e,l,n,a,c,d,p,b;if(this.isLoading){return i("div",{class:"h-screen bg-white d-flex flex-column align-items-center justify-content-center"},i("ir-loading-screen",null))}return i(s,null,i("ir-interceptor",null),i("ir-toast",null),i("div",{class:"p-2 main-container"},i("ir-listing-header",{propertyId:this.propertyid,language:this.language,baseurl:this.baseurl}),i("section",null,i("div",{class:"card p-1 flex-fill m-0 mt-2"},i("table",{class:"table table-striped table-bordered no-footer dataTable"},i("thead",null,i("tr",null,i("th",{scope:"col",class:"text-left"},(t=h.entries)===null||t===void 0?void 0:t.Lcz_Booking,"#"),i("th",{scope:"col"},(e=h.entries)===null||e===void 0?void 0:e.Lcz_BookedOn),i("th",{scope:"col"},(l=h.entries)===null||l===void 0?void 0:l.Lcz_GuestSource),i("th",{scope:"col"},i("p",{class:"m-0"},(n=h.entries)===null||n===void 0?void 0:n.Lcz_Price),i("p",{class:"m-0 btn due-btn"},(a=h.entries)===null||a===void 0?void 0:a.Lcz_Balance)),i("th",{scope:"col",class:"text-left"},(c=h.entries)===null||c===void 0?void 0:c.Lcz_Services),i("th",{scope:"col",class:"in-out"},(d=h.entries)===null||d===void 0?void 0:d.Lcz_InOut),i("th",{scope:"col"},(p=h.entries)===null||p===void 0?void 0:p.Lcz_Status),i("th",{scope:"col"},i("p",{class:"sr-only"},"actions")))),i("tbody",{class:""},(b=o.bookings)===null||b===void 0?void 0:b.map((t=>{var s;let e="";switch(t.status.code){case"001":e="badge-warning";break;case"002":e="badge-success";break;case"003":case"004":e="badge-danger";break}return i("tr",{key:t.booking_nbr},i("td",{class:"text-left"},i("div",{class:"h-100 d-flex align-items-center justify-content-between"},i("button",{onClick:()=>this.editBookingItem={booking:t,cause:"edit"},class:"booking_number"},t.booking_nbr)," ",i("img",{class:"ml-2",src:t.origin.Icon,alt:"logo"}))),i("td",null,i("p",{class:"p-0 m-0"},g(t.booked_on.date,"YYYY-MM-DD").format("DD-MMM-YYYY")),i("p",{class:"p-0 m-0 secondary-p"},t.booked_on.hour,":",t.booked_on.minute)),i("td",null,i("p",{class:"p-0 m-0"},t.guest.first_name," ",(s=t.guest.last_name)!==null&&s!==void 0?s:""," ",t.occupancy.adult_nbr,h.entries.Lcz_P),i("p",{class:"p-0 m-0 secondary-p"},t.origin.Label)),i("td",null,i("p",{class:"p-0 m-0"},r(t.currency.code,t.financial.gross_total)),t.financial.due_amount>0&&i("buuton",{onClick:()=>{this.editBookingItem={booking:t,cause:"payment"};this.openModal()},class:"btn p-0 m-0 due-btn"},r(t.currency.code,t.financial.due_amount))),i("td",null,i("ul",null,t.rooms.map((t=>i("li",null,t.roomtype.name))))),i("td",null,i("p",{class:"p-0 m-0"},g(t.from_date,"YYYY-MM-DD").format("DD-MMM-YYYY")),i("p",{class:"p-0 m-0"},g(t.to_date,"YYYY-MM-DD").format("DD-MMM-YYYY"))),i("td",null,i("p",{class:`m-0 badge ${e}`},t.status.description)),i("td",null,i("div",{class:"d-flex justify-content-center align-items-center"},i("ir-icon",{onIconClickHandler:()=>this.editBookingItem={booking:t,cause:"edit"}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"20",viewBox:"0 0 512 512"},i("path",{fill:"#104064",d:"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"}))),i("ir-icon",{onIconClickHandler:()=>{this.editBookingItem={booking:t,cause:"delete"};this.openModal()},class:"ml-1"},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"17.5",viewBox:"0 0 448 512"},i("path",{fill:"#ff4961",d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"}))))))})))),this.totalPages>1&&i("section",{class:"d-flex flex-column flex-md-row align-items-center justify-content-between"},i("p",{class:"m-0 mb-1 mb-md-0"},this.renderItemRange()),i("div",{class:"d-flex align-items-center buttons-container"},i("ir-button",{size:"sm",btn_disabled:this.currentPage===1,onClickHanlder:async()=>{this.currentPage=1;await this.updateData()}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 512 512"},i("path",{fill:"white",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"}))),i("ir-button",{size:"sm",btn_disabled:this.currentPage===1,onClickHanlder:async()=>{this.currentPage=this.currentPage-1;await this.updateData()}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"8.75",viewBox:"0 0 320 512"},i("path",{fill:"white",d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"}))),i("ir-select",{selectedValue:this.currentPage.toString(),LabelAvailable:false,showFirstOption:false,onSelectChange:async t=>{this.currentPage=+t.detail;await this.updateData()},data:Array.from(Array(this.totalPages),((t,i)=>i+1)).map((t=>({text:t.toString(),value:t.toString()})))}),i("ir-button",{size:"sm",btn_disabled:this.currentPage===this.totalPages,onClickHanlder:async()=>{this.currentPage=this.currentPage+1;await this.updateData()}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"8.75",viewBox:"0 0 320 512"},i("path",{fill:"white",d:"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"}))),i("ir-button",{size:"sm",btn_disabled:this.currentPage===this.totalPages,onClickHanlder:async()=>{this.currentPage=this.totalPages;await this.updateData()}},i("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 512 512"},i("path",{fill:"white",d:"M470.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 256 265.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160zm-352 160l160-160c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L210.7 256 73.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0z"})))))))),i("ir-listing-modal",{onModalClosed:()=>this.editBookingItem=null}),i("ir-sidebar",{onIrSidebarToggle:this.handleSideBarToggle.bind(this),open:this.editBookingItem!==null&&this.editBookingItem.cause==="edit",showCloseButton:this.editBookingItem!==null,sidebarStyles:{width:this.editBookingItem?"80rem":"var(--sidebar-width,40rem)",background:"#F2F3F8"}},this.editBookingItem&&i("ir-booking-details",{hasPrint:true,hasReceipt:true,is_from_front_desk:true,propertyid:this.propertyid,hasRoomEdit:true,hasRoomDelete:true,bookingNumber:this.editBookingItem.booking.booking_nbr,ticket:this.ticket,baseurl:this.baseurl,language:this.language,hasRoomAdd:true})))}get el(){return e(this)}static get watchers(){return{ticket:["ticketChanged"]}}};b.style=p;export{b as ir_booking_listing};
//# sourceMappingURL=p-143a85c4.entry.js.map