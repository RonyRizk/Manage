{"version":3,"names":["RoomService","fetchData","id","language","token","JSON","parse","sessionStorage","getItem","data","axios","post","ExceptionMsg","Error","results","My_Result","calendar_data","adultChildConstraints","adult_child_constraints","allowedBookingSources","allowed_booking_sources","allowed_payment_methods","allowed_booking_methods","currency","is_vacation_rental","pickup_service","max_nights","channels","is_frontdesk_enabled","error","console","log","fetchLanguage","code","entries","this","transformArrayToObject","locales","direction","object","d","description","irChannelCss","IrChannel","roomService","componentDidLoad","baseurl","defaults","baseURL","ticket","initializeApp","_","languageTexts","Promise","all","propertyid","ticketChanged","setItem","stringify","render","h","Host","class","text","size","onClickHanlder","channel_status","scope","_a","map","channel","key","title","name","type","checked","is_active","href","showCloseButton","onIrSidebarToggle","e","stopImmediatePropagation","stopPropagation","open","onCloseSideBar"],"sources":["src/services/room.service.ts","src/components/ir-channel/ir-channel.css?tag=ir-channel&encapsulation=scoped","src/components/ir-channel/ir-channel.tsx"],"sourcesContent":["import calendar_data from '@/stores/calendar-data';\r\nimport { locales } from '@/stores/locales.store';\r\nimport axios from 'axios';\r\n\r\nexport class RoomService {\r\n  public async fetchData(id: number, language: string) {\r\n    try {\r\n      const token = JSON.parse(sessionStorage.getItem('token'));\r\n      if (token !== null) {\r\n        const { data } = await axios.post(`/Get_Exposed_Property?Ticket=${token}`, { id, language });\r\n        if (data.ExceptionMsg !== '') {\r\n          throw new Error(data.ExceptionMsg);\r\n        }\r\n        const results = data.My_Result;\r\n        calendar_data.adultChildConstraints = results.adult_child_constraints;\r\n        calendar_data.allowedBookingSources = results.allowed_booking_sources;\r\n        calendar_data.allowed_payment_methods = results.allowed_booking_methods;\r\n        calendar_data.currency = results.currency;\r\n        calendar_data.is_vacation_rental = results.is_vacation_rental;\r\n        calendar_data.pickup_service = results.pickup_service;\r\n        calendar_data.max_nights = results.max_nights;\r\n        calendar_data.channels = results.channels;\r\n        calendar_data.is_frontdesk_enabled = results.is_frontdesk_enabled;\r\n        return data;\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  public async fetchLanguage(code: string) {\r\n    try {\r\n      const token = JSON.parse(sessionStorage.getItem('token'));\r\n      if (token !== null) {\r\n        const { data } = await axios.post(`/Get_Exposed_Language?Ticket=${token}`, { code });\r\n        if (data.ExceptionMsg !== '') {\r\n          throw new Error(data.ExceptionMsg);\r\n        }\r\n        let entries = this.transformArrayToObject(data.My_Result.entries);\r\n        locales.entries = entries;\r\n        locales.direction = data.My_Result.direction;\r\n        return { entries, direction: data.My_Result.direction };\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      throw new Error(error);\r\n    }\r\n  }\r\n  private transformArrayToObject(data: any) {\r\n    let object: any = {};\r\n    for (const d of data) {\r\n      object[d.code] = d.description;\r\n    }\r\n    return object;\r\n  }\r\n}\r\n",":host {\r\n  display: block;\r\n}\r\n","import { RoomService } from '@/services/room.service';\r\nimport calendar_data from '@/stores/calendar-data';\r\nimport locales from '@/stores/locales.store';\r\nimport { Component, Host, Prop, Watch, h, Element, State } from '@stencil/core';\r\nimport axios from 'axios';\r\n\r\n@Component({\r\n  tag: 'ir-channel',\r\n  styleUrl: 'ir-channel.css',\r\n  scoped: true,\r\n})\r\nexport class IrChannel {\r\n  @Element() el: HTMLElement;\r\n\r\n  @Prop() ticket: string;\r\n  @Prop() propertyid: number;\r\n  @Prop() language: string;\r\n  @Prop() baseurl: string;\r\n\r\n  @State() channel_status: 'create' | 'edit' | null = null;\r\n\r\n  private roomService = new RoomService();\r\n\r\n  componentDidLoad() {\r\n    if (this.baseurl) {\r\n      axios.defaults.baseURL = this.baseurl;\r\n    }\r\n    if (this.ticket !== '') {\r\n      this.initializeApp();\r\n    }\r\n  }\r\n  async initializeApp() {\r\n    try {\r\n      const [_, languageTexts] = await Promise.all([this.roomService.fetchData(this.propertyid, this.language), this.roomService.fetchLanguage(this.language)]);\r\n      if (!locales.entries) {\r\n        locales.entries = languageTexts.entries;\r\n        locales.direction = languageTexts.direction;\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n\r\n  @Watch('ticket')\r\n  async ticketChanged() {\r\n    sessionStorage.setItem('token', JSON.stringify(this.ticket));\r\n    this.initializeApp();\r\n  }\r\n  render() {\r\n    return (\r\n      <Host>\r\n        <section class=\"p-2\">\r\n          <div class=\"d-flex w-100 justify-content-end mb-2\">\r\n            <ir-button text={'Create'} size=\"sm\" onClickHanlder={() => (this.channel_status = 'create')}></ir-button>\r\n          </div>\r\n          <div>\r\n            <table class=\"table\">\r\n              <thead class=\"\">\r\n                <tr>\r\n                  <th scope=\"col\" class=\"text-left\">\r\n                    Title\r\n                  </th>\r\n                  <th scope=\"col\">Channel</th>\r\n                  <th scope=\"col\">Status</th>\r\n                  <th scope=\"col\">Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {calendar_data.channels?.map(channel => (\r\n                  <tr key={channel.id}>\r\n                    <th scope=\"row\" class=\"text-left\">\r\n                      {channel.title}\r\n                    </th>\r\n                    <th scope=\"row\">{channel.name}</th>\r\n                    <td>\r\n                      <input data-switchery=\"true\" type=\"checkbox\" class=\"\" checked={channel.is_active} />\r\n                    </td>\r\n                    <th>\r\n                      <div class=\"dropdown\">\r\n                        <button class=\"btn dropdown-toggle text-primary\" type=\"button\" data-toggle=\"dropdown\" aria-expanded=\"false\">\r\n                          Actions\r\n                        </button>\r\n                        <div class=\"dropdown-menu dropdown-menu-right\">\r\n                          <a class=\"dropdown-item\" href=\"#\">\r\n                            Action\r\n                          </a>\r\n                          <a class=\"dropdown-item\" href=\"#\">\r\n                            Another action\r\n                          </a>\r\n                          <a class=\"dropdown-item\" href=\"#\">\r\n                            Something else here\r\n                          </a>\r\n                        </div>\r\n                      </div>\r\n                    </th>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </section>\r\n        <ir-sidebar\r\n          showCloseButton={false}\r\n          onIrSidebarToggle={e => {\r\n            e.stopImmediatePropagation();\r\n            e.stopPropagation();\r\n            this.channel_status = null;\r\n          }}\r\n          open={this.channel_status !== null}\r\n        >\r\n          {this.channel_status && <ir-channel-editor onCloseSideBar={() => (this.channel_status = null)}></ir-channel-editor>}\r\n        </ir-sidebar>\r\n      </Host>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"}