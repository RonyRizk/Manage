{"version":3,"names":["initialState","channels","settlement_methods","statuses","types","token","bookings","userSelection","from","moment","add","format","to","channel","undefined","property_id","start_row","end_row","total_count","filter_type","name","book_nbr","booking_status","affiliate_id","is_mpo_managed","is_mpo_used","is_for_mobile","is_combined_view","is_to_export","state","booking_listing","onChange","onBookingListingChange","createStore","initializeUserSelection","Object","assign","code","id","updateUserSelection","key","value","BookingListingService","Token","getExposedBookingsCriteria","this","getToken","Error","data","axios","post","result","My_Result","getExposedBookings","params","header","My_Params_Get_Exposed_Bookings"],"sources":["src/stores/booking_listing.store.ts","src/services/booking_listing.service.ts"],"sourcesContent":["import { IExposedBookingsCriteria } from '@/models/IrBookingListing';\r\nimport { Booking } from '@/models/booking.dto';\r\nimport { createStore } from '@stencil/store';\r\nimport moment from 'moment';\r\n\r\nexport interface IBookingListingStore extends IExposedBookingsCriteria {\r\n  token: string;\r\n  userSelection: IUserListingSelection;\r\n  bookings: Booking[];\r\n}\r\nexport interface IUserListingSelection {\r\n  channel: string;\r\n  property_id: number;\r\n  filter_type: number;\r\n  from: string;\r\n  to: string;\r\n  name: string;\r\n  book_nbr: string;\r\n  booking_status: string;\r\n  affiliate_id: 0;\r\n  is_mpo_managed: false;\r\n  is_mpo_used: false;\r\n  is_for_mobile: false;\r\n  is_combined_view: false;\r\n  start_row: number;\r\n  end_row: number;\r\n  total_count: number;\r\n  is_to_export: boolean;\r\n}\r\n\r\nconst initialState: IBookingListingStore = {\r\n  channels: [],\r\n  settlement_methods: [],\r\n  statuses: [],\r\n  types: [],\r\n  token: '',\r\n  bookings: [],\r\n  userSelection: {\r\n    from: moment().add(-7, 'days').format('YYYY-MM-DD'),\r\n    to: moment().format('YYYY-MM-DD'),\r\n    channel: undefined,\r\n    property_id: null,\r\n    start_row: 0,\r\n    end_row: 20,\r\n    total_count: 0,\r\n    filter_type: null,\r\n    name: '',\r\n    book_nbr: '',\r\n    booking_status: '',\r\n    affiliate_id: 0,\r\n    is_mpo_managed: false,\r\n    is_mpo_used: false,\r\n    is_for_mobile: false,\r\n    is_combined_view: false,\r\n    is_to_export: false,\r\n  },\r\n};\r\n\r\nexport const { state: booking_listing, onChange: onBookingListingChange } = createStore<IBookingListingStore>(initialState);\r\nexport function initializeUserSelection() {\r\n  //booking_listing.channels[0].name\r\n  booking_listing.userSelection = {\r\n    ...booking_listing.userSelection,\r\n    channel: '',\r\n    booking_status: booking_listing.statuses[0].code,\r\n    filter_type: booking_listing.types[0].id,\r\n    book_nbr: '',\r\n    name: '',\r\n    total_count: 0,\r\n  };\r\n}\r\nexport function updateUserSelection(key: keyof IUserListingSelection, value: any) {\r\n  booking_listing.userSelection = {\r\n    ...booking_listing.userSelection,\r\n    [key]: value,\r\n  };\r\n}\r\nexport default booking_listing;\r\n","import { Token } from '@/models/Token';\r\nimport booking_listing, { IUserListingSelection, initializeUserSelection } from '@/stores/booking_listing.store';\r\nimport axios from 'axios';\r\n\r\nexport class BookingListingService extends Token {\r\n  public async getExposedBookingsCriteria() {\r\n    const token = this.getToken();\r\n    if (!token) {\r\n      throw new Error('Invalid token');\r\n    }\r\n    const { data } = await axios.post(`/Get_Exposed_Bookings_Criteria?Ticket=${token}`);\r\n\r\n    const result = data.My_Result;\r\n\r\n    booking_listing.channels = result.channels;\r\n    booking_listing.settlement_methods = result.settlement_methods;\r\n    booking_listing.statuses = result.statuses;\r\n    booking_listing.types = result.types;\r\n    initializeUserSelection();\r\n  }\r\n\r\n  public async getExposedBookings(params: IUserListingSelection) {\r\n    const token = this.getToken();\r\n    if (!token) {\r\n      throw new Error('Invalid token');\r\n    }\r\n    const { data } = await axios.post(`/Get_Exposed_Bookings?Ticket=${token}`, params);\r\n    const result = data.My_Result;\r\n    const header = data.My_Params_Get_Exposed_Bookings;\r\n    booking_listing.bookings = [...result];\r\n    booking_listing.userSelection = {\r\n      ...booking_listing.userSelection,\r\n      book_nbr: '',\r\n      name: '',\r\n      total_count: header.total_count,\r\n    };\r\n  }\r\n}\r\n"],"mappings":"mHA8BA,MAAMA,EAAqC,CACzCC,SAAU,GACVC,mBAAoB,GACpBC,SAAU,GACVC,MAAO,GACPC,MAAO,GACPC,SAAU,GACVC,cAAe,CACbC,KAAMC,IAASC,KAAK,EAAG,QAAQC,OAAO,cACtCC,GAAIH,IAASE,OAAO,cACpBE,QAASC,UACTC,YAAa,KACbC,UAAW,EACXC,QAAS,GACTC,YAAa,EACbC,YAAa,KACbC,KAAM,GACNC,SAAU,GACVC,eAAgB,GAChBC,aAAc,EACdC,eAAgB,MAChBC,YAAa,MACbC,cAAe,MACfC,iBAAkB,MAClBC,aAAc,Q,MAIHC,MAAOC,EAAiBC,SAAUC,GAA2BC,EAAkCjC,G,SAC9FkC,IAEdJ,EAAgBvB,cAAa4B,OAAAC,OAAAD,OAAAC,OAAA,GACxBN,EAAgBvB,eAAa,CAChCM,QAAS,GACTS,eAAgBQ,EAAgB3B,SAAS,GAAGkC,KAC5ClB,YAAaW,EAAgB1B,MAAM,GAAGkC,GACtCjB,SAAU,GACVD,KAAM,GACNF,YAAa,GAEjB,C,SACgBqB,EAAoBC,EAAkCC,GACpEX,EAAgBvB,cAAa4B,OAAAC,OAAAD,OAAAC,OAAA,GACxBN,EAAgBvB,eAAa,CAChCiC,CAACA,GAAMC,GAEX,C,MCxEaC,UAA8BC,EAClC,gCAAMC,GACX,MAAMvC,EAAQwC,KAAKC,WACnB,IAAKzC,EAAO,CACV,MAAM,IAAI0C,MAAM,gB,CAElB,MAAMC,KAAEA,SAAeC,EAAMC,KAAK,yCAAyC7C,KAE3E,MAAM8C,EAASH,EAAKI,UAEpBtB,EAAgB7B,SAAWkD,EAAOlD,SAClC6B,EAAgB5B,mBAAqBiD,EAAOjD,mBAC5C4B,EAAgB3B,SAAWgD,EAAOhD,SAClC2B,EAAgB1B,MAAQ+C,EAAO/C,MAC/B8B,G,CAGK,wBAAMmB,CAAmBC,GAC9B,MAAMjD,EAAQwC,KAAKC,WACnB,IAAKzC,EAAO,CACV,MAAM,IAAI0C,MAAM,gB,CAElB,MAAMC,KAAEA,SAAeC,EAAMC,KAAK,gCAAgC7C,IAASiD,GAC3E,MAAMH,EAASH,EAAKI,UACpB,MAAMG,EAASP,EAAKQ,+BACpB1B,EAAgBxB,SAAW,IAAI6C,GAC/BrB,EAAgBvB,cAAa4B,OAAAC,OAAAD,OAAAC,OAAA,GACxBN,EAAgBvB,eAAa,CAChCc,SAAU,GACVD,KAAM,GACNF,YAAaqC,EAAOrC,a"}