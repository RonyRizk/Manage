import{r as t,c as i,h as e,F as s,H as o,g as n}from"./p-05195efb.js";import{B as a,t as l,f as r}from"./p-92f0d570.js";import{d as h,l as c,m as d,q as u,o as p}from"./p-9501b0ae.js";import{E as f}from"./p-518bf1d8.js";import{B as m}from"./p-dd8d0e6b.js";import{_ as g,b,c as v}from"./p-30bf9f71.js";import{h as w}from"./p-fe6c3d31.js";import{a as y}from"./p-539b691e.js";import{c as k}from"./p-e3870f97.js";class x{setBookingInfoFromAutoComplete(t,i){t.bookedByInfoData={id:i.guest.id,email:i.guest.email,firstName:i.guest.first_name,lastName:i.guest.last_name,countryId:i.guest.country_id,isdCode:i.guest.country_id.toString(),contactNumber:i.guest.mobile,selectedArrivalTime:i.arrival,emailGuest:i.guest.subscribe_to_news_letter,message:i.remark,cardNumber:"",cardHolderName:"",expiryMonth:"",expiryYear:"",bookingNumber:i.booking_nbr,rooms:i.rooms,from_date:i.from_date,to_date:i.to_date}}resetRoomsInfoAndMessage(t){t.defaultData.roomsInfo=[];t.message=""}onDataRoomUpdate(t,i,e,s,o){let n=i;const{data:a,key:l,changedKey:r}=t.detail;const h=`c_${a.roomCategoryId}`;const c=`p_${a.ratePlanId}`;if(this.shouldClearData(l)){n=new Map}this.initializeRoomCategoryIfNeeded(h,n);if(s){if(r==="rate"){if(n.has(h)&&n.get(h).has(c)){this.applyBookingEditToSelectedRoom(h,c,a,n,o,e)}}else{if(r!=="rateType"){if(r==="adult_child_offering"){if(n.has(h)&&i.get(h).has(c)){this.applyBookingEditToSelectedRoom(h,c,a,n,o,e)}}else{this.applyBookingEditToSelectedRoom(h,c,a,n,o,e)}}}}else{this.setSelectedRoomData(h,c,a,n)}this.cleanupEmptyData(h,n);return n}shouldClearData(t){return t==="clearData"||t==="EDIT_BOOKING"}initializeRoomCategoryIfNeeded(t,i){if(!i.has(t)){i.set(t,new Map)}}setSelectedRoomData(t,i,e,s){let o=s.get(t);if(e.totalRooms===0||e.inventory===0){o.delete(i)}else{s.set(t,o.set(i,Object.assign(Object.assign({},e),{selectedUnits:Array(e.totalRooms).fill(-1)})))}}cleanupEmptyData(t,i){if(i.has(t)){let e=i.get(t);if(e.size===0){i.delete(t)}}}applyBookingEditToSelectedRoom(t,i,e,s,o,n){s.clear();let a={};if(n){a=Object.assign(Object.assign({},e),{guestName:o||"",roomId:""})}else{a=Object.assign({},e)}s.set(t,(new Map).set(i,a))}async prepareBookUserServiceParams(t,i,e){try{const s=t.isEventType("EDIT_BOOKING")?t.getArrivalTimeForBooking():t.isEventType("ADD_ROOM")?t.bookingData.ARRIVAL.code:t.isEventType("SPLIT_BOOKING")?t.bookedByInfoData.selectedArrivalTime.code:"";const o=t.isEventType("BAR_BOOKING")?t.bookingData.PR_ID:undefined;const n=t.isEventType("EDIT_BOOKING")||t.isEventType("ADD_ROOM")?t.bookingData.BOOKING_NUMBER:t.isEventType("SPLIT_BOOKING")?t.bookedByInfoData.bookingNumber:undefined;let a=[];if(t.isEventType("ADD_ROOM")){a=t.bookingData.ROOMS}else if(t.isEventType("SPLIT_BOOKING")){a=t.bookedByInfoData.rooms}else if(t.isEventType("EDIT_BOOKING")){a=t.defaultData.ROOMS.filter((i=>i.identifier!==t.bookingData.IDENTIFIER))}console.log("rooms",a);return[t.bookedByInfoData,i,new Date(t.dateRangeData.fromDate),new Date(t.dateRangeData.toDate),t.guestData,t.dateRangeData.dateDifference,e,t.propertyid,a,t.currency,n,t.bookingData.GUEST,s,o,t.bookingData.IDENTIFIER]}catch(t){console.log(t)}}getBookingPreferenceRoomId(t){return t.hasOwnProperty("PR_ID")&&t.PR_ID||null}getRoomCategoryByRoomId(t,i){var e;return(e=i.roomsInfo)===null||e===void 0?void 0:e.find((i=>i.physicalrooms.find((i=>i.id===+t))))}setEditingRoomInfo(t,i){const e=this.getRoomCategoryByRoomId(this.getBookingPreferenceRoomId(t),t);const s=`c_${e.id}`;const o=`p_${t.RATE_PLAN_ID}`;const n={adultCount:t.ADULTS_COUNT,rate:t.RATE,rateType:t.RATE_TYPE,ratePlanId:t.RATE_PLAN_ID,roomCategoryId:e.id,roomCategoryName:e.name,totalRooms:1,ratePlanName:t.RATE_PLAN,roomId:t.PR_ID,guestName:t.NAME,cancelation:t.cancelation,guarantee:t.guarantee,adult_child_offering:t.adult_child_offering};i.set(s,(new Map).set(o,n))}}const _=".sc-igl-book-property-h{position:fixed;top:0;right:0;width:100vw;height:100vh;z-index:99}.card-title.sc-igl-book-property{border-bottom:1px solid #e4e5ec;width:100%}.scrollContent.sc-igl-book-property{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-book-property{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-book-property{height:calc(100% - 79px);overflow:auto}.gap-30.sc-igl-book-property{gap:30px}.block-date.sc-igl-book-property{width:100%}.sideWindow.sc-igl-book-property{position:absolute;top:0;right:0;height:100%;background-color:#ffffff;width:100vw;overflow-y:auto}.card.sc-igl-book-property{top:0;z-index:1000}.close.sc-igl-book-property{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-book-property{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-book-property:not(:disabled),[type='button'].sc-igl-book-property:not(:disabled){cursor:pointer}.row.sc-igl-book-property{padding:0 0 0 15px;margin:0}@media only screen and (min-width: 1200px){.sideWindow.sc-igl-book-property{max-width:70%}}@media only screen and (min-width: 2000px){.sideWindow.sc-igl-book-property{max-width:40%}}@media only screen and (min-width: 768px) and (max-width: 1200px){.sideWindow.sc-igl-book-property{max-width:90%}}@media only screen and (min-width: 600px) and (max-width: 768px){.sideWindow.sc-igl-book-property{max-width:75%}}@media only screen and (min-width: 641px){.block-date.sc-igl-book-property{max-width:450px}}";const D=class{constructor(e){t(this,e);this.closeBookingWindow=i(this,"closeBookingWindow",7);this.bookingCreated=i(this,"bookingCreated",7);this.blockedCreated=i(this,"blockedCreated",7);this.resetBookingData=i(this,"resetBookingData",7);this.initialRoomIds=null;this.message="";this.showSplitBookingOption=false;this.sourceOptions=[];this.guestData=[];this.bookedByInfoData={};this.blockDatesData={};this.ratePricingMode=[];this.selectedUnits=new Map;this.bedPreferenceType=[];this.bookingService=new a;this.bookPropertyService=new x;this.eventsService=new f;this.propertyid=undefined;this.allowedBookingSources=undefined;this.language=undefined;this.countryNodeList=undefined;this.showPaymentDetails=false;this.currency=undefined;this.bookingData=undefined;this.adultChildConstraints=undefined;this.adultChildCount={adult:0,child:0};this.renderAgain=false;this.dateRangeData=undefined;this.defaultData=undefined;this.isLoading=undefined;this.buttonName=""}handleKeyDown(t){if(t.key==="Escape"){this.closeWindow()}else return}componentDidLoad(){document.addEventListener("keydown",this.handleKeyDown)}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}clearBooking(t){if(this.isEventType("SPLIT_BOOKING")){t.stopImmediatePropagation();t.stopPropagation();this.bookedByInfoData={};this.bookPropertyService.resetRoomsInfoAndMessage(this);this.renderPage()}}async handleSpiltBookingSelected(t){t.stopImmediatePropagation();const{key:i,data:e}=t.detail;if(i==="select"){const t=await this.bookingService.getExposedBooking(e.booking_nbr,this.language);this.bookPropertyService.setBookingInfoFromAutoComplete(this,t);this.sourceOption=t.source;this.renderPage()}else if(i==="blur"&&e!==""){const t=await this.bookingService.getExposedBooking(e,this.language);this.bookPropertyService.setBookingInfoFromAutoComplete(this,t);this.sourceOption=t.source;this.renderPage()}}async componentWillLoad(){this.defaultDateRange={from_date:this.bookingData.FROM_DATE,to_date:this.bookingData.TO_DATE};this.handleKeyDown=this.handleKeyDown.bind(this);if(!this.bookingData.defaultDateRange){return}this.defaultData=this.bookingData;this.dateRangeData=Object.assign({},this.defaultData.defaultDateRange);try{const t=await this.fetchSetupEntries();this.setSourceOptions(this.allowedBookingSources);this.setOtherProperties(t);if(this.isEventType("EDIT_BOOKING")){this.adultChildCount={adult:this.defaultData.ADULTS_COUNT,child:this.defaultData.CHILDREN_COUNT};this.initialRoomIds={roomName:this.defaultData.roomName,ratePlanId:this.defaultData.RATE_PLAN_ID,roomId:this.defaultData.PR_ID,roomTypeId:this.defaultData.RATE_TYPE};this.bookPropertyService.setEditingRoomInfo(this.defaultData,this.selectedUnits)}if(!this.isEventType("BAR_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}if(this.defaultData.event_type==="SPLIT_BOOKING"){this.showSplitBookingOption=true;this.page="page_one"}else if(this.defaultData.event_type==="BLOCK_DATES"){this.page="page_block_date"}else{this.page="page_one"}}catch(t){console.error("Error fetching setup entries:",t)}}async fetchSetupEntries(){return await this.bookingService.fetchSetupEntries()}isGuestDataIncomplete(){if(this.guestData.length===0){return true}for(const t of this.guestData){if(t.guestName===""||t.preference===""||t.preference===0){return true}}return false}isButtonDisabled(){const t=(t,i,e)=>{if(!t){return true}if(t===this.guestData){return this.isGuestDataIncomplete()}if(i==="selectedArrivalTime"){if(t[i]!==undefined){return t[i].code===""}else{return true}}return t[i]===e||t[i]===undefined};return t(this.guestData,"guestName","")||t(this.bookedByInfoData,"isdCode","")||t(this.bookedByInfoData,"contactNumber","")||t(this.bookedByInfoData,"firstName","")||t(this.bookedByInfoData,"lastName","")||t(this.bookedByInfoData,"countryId",-1)||t(this.bookedByInfoData,"selectedArrivalTime","")||t(this.bookedByInfoData,"email","")}setSourceOptions(t){this.sourceOptions=t.map((t=>({id:t.code,value:t.description,tag:t.tag,type:t.type})));if(this.isEventType("EDIT_BOOKING")){this.sourceOption=Object.assign({},this.defaultData.SOURCE)}else{this.sourceOption={code:t[0].code,description:t[0].description,tag:t[0].tag}}}setOtherProperties(t){this.ratePricingMode=t.ratePricingMode;this.bookedByInfoData.arrivalTime=t.arrivalTime;this.bedPreferenceType=t.bedPreferenceType}handleAdultChildChange(t){if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.bookPropertyService.resetRoomsInfoAndMessage(this)}this.adultChildCount=Object.assign({},t.detail)}async initializeBookingAvailability(t,i){try{const e=this.defaultData.roomsInfo.map((t=>t.id));const s=await this.bookingService.getBookingAvailability(t,i,this.propertyid,this.adultChildCount,this.language,e,this.currency);this.message="";this.message=s.tax_statement;if(!this.isEventType("EDIT_BOOKING")){this.defaultData.defaultDateRange.fromDate=new Date(this.dateRangeData.fromDate);this.defaultData.defaultDateRange.toDate=new Date(this.dateRangeData.toDate)}this.defaultData=Object.assign(Object.assign({},this.defaultData),{roomsInfo:s.roomtypes})}catch(t){}}getRoomCategoryByRoomId(t){var i;return(i=this.defaultData.roomsInfo)===null||i===void 0?void 0:i.find((i=>i.physicalrooms.find((i=>i.id===+t))))}getSplitBookings(){return this.defaultData.hasOwnProperty("splitBookingEvents")&&this.defaultData.splitBookingEvents||[]}closeWindow(){this.dateRangeData={};this.closeBookingWindow.emit();document.removeEventListener("keydown",this.handleKeyDown)}isEventType(t){return this.defaultData.event_type===t}onDateRangeSelect(t){t.stopImmediatePropagation();t.stopPropagation();const i=t.detail;if(i.key==="selectedDateRange"){this.dateRangeData=i.data;if(this.isEventType("ADD_ROOM")||this.isEventType("SPLIT_BOOKING")){this.defaultData.roomsInfo=[];this.message=""}else if(this.adultChildCount.adult!==0){this.initializeBookingAvailability(h(new Date(this.dateRangeData.fromDate)),h(new Date(this.dateRangeData.toDate)))}}}handleBlockDateUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const i=t.detail;this.blockDatesData=i.data}handleGuestInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const i=t.detail;if(i.guestRefKey){if(this.isEventType("BAR_BOOKING")||this.isEventType("SPLIT_BOOKING")){this.guestData[i.guestRefKey]=Object.assign(Object.assign({},i.data),{roomId:this.defaultData.PR_ID})}else this.guestData[i.guestRefKey]=i.data}}handleBookedByInfoUpdate(t){t.stopImmediatePropagation();t.stopPropagation();const i=t.detail;this.bookedByInfoData=i.value.data}handleSourceDropDown(t){t.stopImmediatePropagation();t.stopPropagation();const i=t.detail;const e=this.sourceOptions.find((t=>t.id===i.toString()));this.sourceOption={code:i,description:e.value||"",tag:e.tag}}renderPage(){this.renderAgain=!this.renderAgain}gotoSplitPageTwo(){this.gotoPage("page_two")}gotoPage(t){this.page=t;this.renderPage()}showSplitBooking(){this.showSplitBookingOption=true;this.gotoPage("page_one")}getPageBlockDatesView(){return e(s,null,e("igl-block-dates-view",{fromDate:this.dateRangeData.fromDateStr,toDate:this.dateRangeData.toDateStr,entryDate:this.defaultData.ENTRY_DATE,onDataUpdateEvent:t=>this.handleBlockDateUpdate(t)}),e("div",{class:"p-0 mb-1 mt-2 gap-30 d-flex align-items-center justify-content-between"},e("button",{class:"btn btn-secondary flex-fill",onClick:()=>this.closeWindow()},c.entries.Lcz_Cancel),e("button",{class:"btn btn-primary flex-fill",onClick:()=>this.handleBlockDate()},c.entries.Lcz_Blockdates)))}handleButtonClicked(t){switch(t.detail.key){case"save":this.bookUser(false);break;case"cancel":t.stopImmediatePropagation();t.stopPropagation();this.closeWindow();break;case"back":t.stopImmediatePropagation();t.stopPropagation();this.gotoPage("page_one");break;case"book":this.bookUser(false);this.buttonName="book";break;case"bookAndCheckIn":this.bookUser(true);this.buttonName="bookAndCheckIn";break;case"next":t.stopImmediatePropagation();t.stopPropagation();this.gotoPage("page_two");case"check":this.initializeBookingAvailability(h(new Date(this.dateRangeData.fromDate)),h(new Date(this.dateRangeData.toDate)))}}handlePageTwoDataUpdateEvent(t){t.stopImmediatePropagation();t.stopPropagation();if(t.detail.key==="propertyBookedBy"){this.handleBookedByInfoUpdate(t)}else{this.handleGuestInfoUpdate(t)}}async handleBlockDate(){const t=d(+this.blockDatesData.RELEASE_AFTER_HOURS);const i=await this.bookingService.blockUnit(Object.assign({from_date:h(this.defaultData.defaultDateRange.fromDate),to_date:h(this.defaultData.defaultDateRange.toDate),NOTES:this.blockDatesData.OPTIONAL_REASON||"",pr_id:this.defaultData.PR_ID.toString(),STAY_STATUS_CODE:this.blockDatesData.OUT_OF_SERVICE?"004":this.blockDatesData.RELEASE_AFTER_HOURS===0?"002":"003",DESCRIPTION:this.blockDatesData.RELEASE_AFTER_HOURS||""},t));const e=await l(i);this.blockedCreated.emit(e);this.closeWindow()}async bookUser(t){this.setLoadingState(t);if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){if(this.isGuestDataIncomplete()){this.isLoading="";return}}else{if(this.isButtonDisabled()){this.isLoading="";return}}try{if(["003","002","004"].includes(this.defaultData.STATUS_CODE)){this.eventsService.deleteEvent(this.defaultData.POOL)}if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.bookedByInfoData.message=this.defaultData.NOTES}const i=await this.bookPropertyService.prepareBookUserServiceParams(this,t,this.sourceOption);await this.bookingService.bookUser(...i);if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.resetBookingData.emit(null)}}catch(t){}finally{this.resetLoadingState()}}setLoadingState(t){if(this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM")){this.isLoading="save"}else{this.isLoading=t?"bookAndCheckIn":"book"}}getArrivalTimeForBooking(){return this.bookedByInfoData.arrivalTime.find((t=>t.CODE_VALUE_EN===this.defaultData.ARRIVAL_TIME)).CODE_NAME}resetLoadingState(){this.isLoading="";setTimeout((()=>{this.closeWindow()}),100)}onRoomDataUpdate(t){const i=this.bookPropertyService.onDataRoomUpdate(t,this.selectedUnits,this.isEventType("EDIT_BOOKING"),this.isEventType("EDIT_BOOKING")||this.isEventType("SPLIT_BOOKING")||this.isEventType("BAR_BOOKING"),this.defaultData.NAME);this.selectedUnits=new Map(i);this.renderPage()}getCurrentPage(t){return this.page===t}render(){return e(o,null,e("div",{class:"background-overlay",onClick:()=>this.closeWindow()}),e("div",{class:"sideWindow "+(this.getCurrentPage("page_block_date")?"block-date":"")},e("div",{class:"card position-sticky mb-0 shadow-none p-0 "},e("div",{class:"d-flex mt-2 align-items-center justify-content-between  "},e("h3",{class:"card-title text-left pb-1 font-medium-2 px-2 px-md-3"},this.getCurrentPage("page_block_date")?this.defaultData.BLOCK_DATES_TITLE:this.defaultData.TITLE),e("ir-icon",{class:"close close-icon",onIconClickHandler:()=>{this.closeWindow()}},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},e("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),e("div",{class:"px-2 px-md-3"},this.getCurrentPage("page_one")&&e("igl-booking-overview-page",{initialRoomIds:this.initialRoomIds,defaultDaterange:this.defaultDateRange,class:"p-0 mb-1",eventType:this.defaultData.event_type,selectedRooms:this.selectedUnits,currency:this.currency,message:this.message,showSplitBookingOption:this.showSplitBookingOption,ratePricingMode:this.ratePricingMode,dateRangeData:this.dateRangeData,bookingData:this.defaultData,adultChildCount:this.adultChildCount,bookedByInfoData:this.bookedByInfoData,adultChildConstraints:this.adultChildConstraints,onRoomsDataUpdate:t=>{this.onRoomDataUpdate(t)},sourceOptions:this.sourceOptions,propertyId:this.propertyid}),this.getCurrentPage("page_two")&&e("igl-pagetwo",{currency:this.currency,propertyId:this.propertyid,showPaymentDetails:this.showPaymentDetails,selectedGuestData:this.guestData,countryNodeList:this.countryNodeList,isLoading:this.isLoading,selectedRooms:this.selectedUnits,bedPreferenceType:this.bedPreferenceType,dateRangeData:this.dateRangeData,bookingData:this.defaultData,showSplitBookingOption:this.showSplitBookingOption,language:this.language,bookedByInfoData:this.bookedByInfoData,defaultGuestData:this.defaultData,isEditOrAddRoomEvent:this.isEventType("EDIT_BOOKING")||this.isEventType("ADD_ROOM"),onDataUpdateEvent:t=>this.handlePageTwoDataUpdateEvent(t)}),this.getCurrentPage("page_block_date")?this.getPageBlockDatesView():null)))}};D.style=_;const O=".sc-igl-booking-overview-page-h{display:block}.sc-igl-booking-overview-page-h>*.sc-igl-booking-overview-page{margin:0;padding:auto}.scrollContent.sc-igl-booking-overview-page{height:calc(100% - 79px);overflow:auto;position:relative}";const C=class{constructor(e){t(this,e);this.roomsDataUpdate=i(this,"roomsDataUpdate",7);this.bookingData=undefined;this.propertyId=undefined;this.message=undefined;this.showSplitBookingOption=undefined;this.eventType=undefined;this.currency=undefined;this.adultChildConstraints=undefined;this.ratePricingMode=undefined;this.dateRangeData=undefined;this.defaultDaterange=undefined;this.selectedRooms=undefined;this.adultChildCount=undefined;this.sourceOptions=undefined;this.bookedByInfoData=undefined;this.initialRoomIds=undefined}getSplitBookings(){return this.bookingData.hasOwnProperty("splitBookingEvents")&&this.bookingData.splitBookingEvents||[]}isEventType(t){return t===this.eventType}render(){var t,i;return e(o,null,e("igl-book-property-header",{bookedByInfoData:this.bookedByInfoData,defaultDaterange:this.defaultDaterange,dateRangeData:this.dateRangeData,adultChildCount:this.adultChildCount,splitBookingId:this.showSplitBookingOption,bookingData:this.bookingData,sourceOptions:this.sourceOptions,message:this.message,bookingDataDefaultDateRange:this.bookingData.defaultDateRange,showSplitBookingOption:this.showSplitBookingOption,adultChildConstraints:this.adultChildConstraints,splitBookings:this.getSplitBookings(),propertyId:this.propertyId}),e("div",{class:" text-left"},(i=(t=this.bookingData)===null||t===void 0?void 0:t.roomsInfo)===null||i===void 0?void 0:i.map((t=>e("igl-booking-rooms",{initialRoomIds:this.initialRoomIds,isBookDisabled:Object.keys(this.bookedByInfoData).length<=1,key:`room-info-${t.id}`,currency:this.currency,ratePricingMode:this.ratePricingMode,dateDifference:this.dateRangeData.dateDifference,bookingType:this.bookingData.event_type,roomTypeData:t,class:"mt-2 mb-1 p-0",roomInfoId:this.selectedRooms.has(`c_${t.id}`)?t.id:null,defaultData:this.selectedRooms.get(`c_${t.id}`),onDataUpdateEvent:t=>this.roomsDataUpdate.emit(t.detail)})))),e("igl-book-property-footer",{class:"p-0 mb-1 mt-3",eventType:this.bookingData.event_type,disabled:this.selectedRooms.size===0}))}};C.style=O;const I=".sc-igl-pagetwo-h{display:block}.card-title.sc-igl-pagetwo{border-bottom:1px solid #e4e5ec}.scrollContent.sc-igl-pagetwo{height:calc(100% - 79px);overflow:auto;position:relative}.background-overlay.sc-igl-pagetwo{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0, 0, 0, 0.25)}.formContainer.sc-igl-pagetwo{height:calc(100% - 79px);overflow:auto}.sideWindow.sc-igl-pagetwo{position:absolute;top:0;right:0;height:100%;background-color:#ffffff}.close.sc-igl-pagetwo{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:0.5;padding:0;background-color:transparent;border:0;appearance:none}.close-icon.sc-igl-pagetwo{position:absolute;top:18px;right:33px;outline:none}button.sc-igl-pagetwo:not(:disabled),[type='button'].sc-igl-pagetwo:not(:disabled){cursor:pointer}.row.sc-igl-pagetwo{padding:0 0 0 15px;margin:0}";const B=class{constructor(e){t(this,e);this.dataUpdateEvent=i(this,"dataUpdateEvent",7);this.buttonClicked=i(this,"buttonClicked",7);this.showPaymentDetails=undefined;this.currency=undefined;this.isEditOrAddRoomEvent=undefined;this.dateRangeData=undefined;this.bookingData=undefined;this.showSplitBookingOption=undefined;this.language=undefined;this.bookedByInfoData=undefined;this.propertyId=undefined;this.bedPreferenceType=undefined;this.selectedRooms=undefined;this.isLoading=undefined;this.countryNodeList=undefined;this.selectedGuestData=undefined;this.defaultGuestData=undefined;this.selectedBookedByData=undefined;this.guestData=undefined;this.selectedUnits={}}componentWillLoad(){this.initializeGuestData();this.selectedBookedByData=this.bookedByInfoData}initializeGuestData(){let t=0;const i=Object.assign({},this.selectedUnits);const e=(t,i,e,s)=>{if(e&&s===2){return t*i}return t};this.selectedUnits=i;this.guestData=[];this.selectedRooms.forEach(((s,o)=>{s.forEach((s=>{i[o]=s.selectedUnits;t+=s.totalRooms*e(s.rate,this.dateRangeData.dateDifference,s.isRateModified,s.rateType);for(let t=1;t<=s.totalRooms;t++){this.guestData.push(Object.assign({guestName:"",roomId:"",preference:""},s))}}))}));this.bookingData.TOTAL_PRICE=t}handleOnApplicationInfoDataUpdateEvent(t,i){const e=t.detail;const s=`c_${e.data.roomCategoryId}`;const o=[...this.selectedUnits[s]||[]];o[i]=e.data.roomId;this.selectedUnits=Object.assign(Object.assign({},this.selectedUnits),{[s]:o});this.dataUpdateEvent.emit({key:"applicationInfoUpdateEvent",value:t.detail})}handleEventData(t,i,e){if(i==="application-info"){this.handleOnApplicationInfoDataUpdateEvent(t,e)}else{this.selectedBookedByData=t.detail.data;this.dataUpdateEvent.emit({key:"propertyBookedBy",value:t.detail})}}isGuestDataIncomplete(){if(this.selectedGuestData.length!==this.guestData.length){return true}for(const t of this.selectedGuestData){if(t.guestName===""||t.preference===""||t.roomId===""){return true}}return false}isButtonDisabled(t){const i=(t,i,e)=>{if(!t){return true}if(t===this.selectedGuestData){return this.isGuestDataIncomplete()}if(i==="selectedArrivalTime"){if(t[i]!==undefined){return t[i].code===""}else{return true}}return t[i]===e||t[i]===undefined};return this.isLoading===t||i(this.selectedGuestData,"guestName","")||i(this.selectedBookedByData,"isdCode","")||i(this.selectedBookedByData,"contactNumber","")||i(this.selectedBookedByData,"firstName","")||i(this.selectedBookedByData,"lastName","")||i(this.selectedBookedByData,"countryId",-1)||i(this.selectedBookedByData,"selectedArrivalTime","")||i(this.selectedBookedByData,"email","")}render(){return e(o,null,e("div",{class:"d-flex flex-wrap"},e("div",{class:"flex-fill text-left p-0"},e("span",{class:"mr-1 font-weight-bold font-medium-1"},u(this.dateRangeData.fromDateStr)," - ",u(this.dateRangeData.toDateStr)),this.dateRangeData.dateDifference," ",+this.dateRangeData.dateDifference>1?` ${c.entries.Lcz_Nights}`:` ${c.entries.Lcz_Night}`),this.guestData.length>1&&e("div",{class:"mt-1 mt-md-0 text-right"},c.entries.Lcz_TotalPrice," ",e("span",{class:"font-weight-bold font-medium-1"},p(this.currency.code)+this.bookingData.TOTAL_PRICE||"$0.00"))),this.guestData.map(((t,i)=>e("igl-application-info",{dateDifference:this.dateRangeData.dateDifference,defaultGuestPreference:this.defaultGuestData.bed_preference,defaultGuestRoomId:this.defaultGuestData.PR_ID,currency:this.currency,bedPreferenceType:this.bedPreferenceType,index:i,selectedUnits:this.selectedUnits[`c_${t.roomCategoryId}`],guestInfo:t,guestRefKey:i,bookingType:this.bookingData.event_type,roomsList:t.physicalRooms,onDataUpdateEvent:t=>this.handleEventData(t,"application-info",i)}))),this.isEditOrAddRoomEvent||this.showSplitBookingOption?null:e("igl-property-booked-by",{propertyId:this.propertyId,countryNodeList:this.countryNodeList,language:this.language,showPaymentDetails:this.showPaymentDetails,defaultData:this.bookedByInfoData,onDataUpdateEvent:t=>this.handleEventData(t,"propertyBookedBy",0)}),this.isEditOrAddRoomEvent?e("div",{class:"d-flex p-0 mb-1 mt-2"},e("div",{class:"flex-fill mr-2"},e("ir-button",{icon:"",text:c.entries.Lcz_Back,class:"full-width",btn_color:"secondary",btn_styles:"justify-content-center",onClickHanlder:()=>this.buttonClicked.emit({key:"back"})})),e("div",{class:"flex-fill"},e("ir-button",{isLoading:this.isLoading==="save",onClickHanlder:()=>this.buttonClicked.emit({key:"save"}),btn_styles:"full-width align-items-center justify-content-center",text:c.entries.Lcz_Save}))):e("div",{class:"d-flex flex-column flex-md-row p-0 mb-1 mt-2 justify-content-md-between align-items-md-center"},e("div",{class:"flex-fill mr-md-1"},e("button",{type:"button",class:"btn btn-secondary full-width",onClick:()=>this.buttonClicked.emit({key:"back"})},e("span",{class:"d-none d-md-inline-flex"}," <<")," ",c.entries.Lcz_Back)),e("div",{class:"mt-1 mt-md-0 flex-fill"},e("ir-button",{isLoading:this.isLoading==="book",btn_styles:"full-width align-items-center justify-content-center",onClickHanlder:()=>this.buttonClicked.emit({key:"book"}),text:c.entries.Lcz_Book}))))}};B.style=I;const T=".input-group-text.sc-ir-guest-info{min-width:10rem;text-align:left}.mobilePrefixSelect.sc-ir-guest-info{border-right-width:0;border-top-right-radius:0;border-bottom-right-radius:0}.mobilePrefixInput.sc-ir-guest-info{border-top-left-radius:0;border-bottom-left-radius:0}.check-container.sc-ir-guest-info{position:relative;cursor:pointer;font-size:14px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;align-items:center}.check-container.sc-ir-guest-info input.sc-ir-guest-info{position:relative;opacity:0;cursor:pointer;height:0;width:0}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info{position:relative;top:0;left:0;height:20px;width:20px;border:1px solid #cacfe7;border-radius:4px;transition:all 0.3s ease}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info{background-color:#1e9ff2;border-color:#1e9ff2}.checkmark.sc-ir-guest-info:after{content:'';position:absolute;display:none}.check-container.sc-ir-guest-info input.sc-ir-guest-info:checked~.checkmark.sc-ir-guest-info:after{display:block}.check-label.sc-ir-guest-info{margin-left:10px !important}.check-container.sc-ir-guest-info .checkmark.sc-ir-guest-info:after{left:6px;top:3px;width:6px;height:10px;border:solid white;border-width:0 2px 2px 0;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}.ir-card-header.sc-ir-guest-info{width:100%;border-bottom:1px solid #e4e5ec}.close-icon.sc-ir-guest-info{margin:0}.border-theme.sc-ir-guest-info{border:1px solid #cacfe7}";const E=class{constructor(e){t(this,e);this.closeSideBar=i(this,"closeSideBar",7);this.bookingService=new m;this.setupDataCountries=null;this.setupDataCountriesCode=null;this.defaultTexts=undefined;this.language=undefined;this.email=undefined;this.booking_nbr=undefined;this.countries=undefined;this.submit=false;this.guest=null;this.isLoading=false}async componentWillLoad(){await this.init()}async init(){try{const[t,i]=await Promise.all([this.bookingService.fetchGuest(this.email),this.bookingService.getCountries(this.language)]);this.countries=i;this.guest=t}catch(t){console.log(t)}}handleInputChange(t,i){this.guest=Object.assign(Object.assign({},this.guest),{[t]:i})}async editGuest(){try{this.isLoading=true;await this.bookingService.editExposedGuest(this.guest,this.booking_nbr);this.closeSideBar.emit(null)}catch(t){console.log(t)}finally{this.isLoading=false;console.log("done")}}render(){var t,i,s,o,n,a;if(!this.guest){return null}return[e("div",{class:"p-0"},e("div",{class:"position-sticky mb-1 shadow-none p-0"},e("div",{class:"d-flex align-items-center justify-content-between ir-card-header py-1 p-0"},e("h3",{class:"card-title text-left font-medium-2 px-1 my-0"},this.defaultTexts.entries.Lcz_GuestDetails),e("ir-icon",{class:"close close-icon px-1",onIconClickHandler:()=>{this.closeSideBar.emit(null)}},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},e("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))))),e("div",{class:"card-content collapse show"},e("div",{class:"card-body pt-0 px-1"},e("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_FirstName,name:"firstName",submited:this.submit,value:(t=this.guest)===null||t===void 0?void 0:t.first_name,required:true,onTextChange:t=>this.handleInputChange("first_name",t.detail)}),e("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_LastName,name:"lastName",submited:this.submit,value:(i=this.guest)===null||i===void 0?void 0:i.last_name,required:true,onTextChange:t=>this.handleInputChange("last_name",t.detail)}),e("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_Email,name:"email",submited:this.submit,value:(s=this.guest)===null||s===void 0?void 0:s.email,required:true,onTextChange:t=>this.handleInputChange("email",t.detail)}),e("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_AlternativeEmail,name:"altEmail",value:(o=this.guest)===null||o===void 0?void 0:o.alternative_email,onTextChange:t=>this.handleInputChange("alternative_email",t.detail)}),e("ir-select",{selectContainerStyle:"mb-1",required:true,name:"country",submited:this.submit,label:this.defaultTexts.entries.Lcz_Country,selectedValue:(a=(n=this.guest.country_id)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:"",data:this.countries.map((t=>({value:t.id.toString(),text:t.name}))),firstOption:"...",onSelectChange:t=>this.handleInputChange("country_id",t.detail)}),e("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_City,name:"city",value:this.guest.city,onTextChange:t=>this.handleInputChange("city",t.detail)}),e("ir-input-text",{placeholder:"",label:this.defaultTexts.entries.Lcz_Address,name:"address",value:this.guest.address,onTextChange:t=>this.handleInputChange("address",t.detail)}),e("div",{class:"form-group mr-0"},e("div",{class:"input-group row m-0 p-0"},e("div",{class:`input-group-prepend col-3 p-0 text-dark border-none`},e("label",{class:`input-group-text  border-theme flex-grow-1 text-dark  `},this.defaultTexts.entries.Lcz_MobilePhone,"*")),e("select",{class:` form-control text-md  col-2 py-0 mobilePrefixSelect`,onInput:t=>this.handleInputChange("country_id",t.target.value),required:true},e("option",{value:null},"..."),this.countries.map((t=>e("option",{selected:this.guest.country_id.toString()===t.id.toString(),value:t.id},t.phone_prefix)))),e("input",{type:"text",required:true,value:this.guest.mobile,class:"form-control flex-fill mobilePrefixInput",onInput:t=>this.handleInputChange("mobile",t.target.value)}))),e("div",{class:"p-0 m-0"},e("label",{class:`check-container m-0 p-0`},e("input",{class:"m-0 p-0",type:"checkbox",name:"newsletter",checked:this.guest.subscribe_to_news_letter,onInput:t=>this.handleInputChange("subscribe_to_news_letter",t.target.checked)}),e("span",{class:"checkmark m-0 p-0"}),e("span",{class:"m-0 p-0  check-label"},this.defaultTexts.entries.Lcz_Newsletter))),e("hr",null),e("ir-button",{isLoading:this.isLoading,btn_disabled:this.isLoading,btn_styles:"d-flex align-items-center justify-content-center",text:this.defaultTexts.entries.Lcz_Save,onClickHanlder:this.editGuest.bind(this),color:"btn-primary"}))))]}};E.style=T;const S="*.sc-ir-label{margin:0;padding:0}.sc-ir-label-h{display:flex;margin-bottom:5px}.icon.sc-ir-label{margin-left:3px;padding:0;margin-top:0;display:flex;align-items:center}p.sc-ir-label{margin:0 3px;padding:0}.icon-container.sc-ir-label{margin:0;padding:0}svg.sc-ir-label{margin:0;padding:0}";const N=class{constructor(e){t(this,e);this.editSidebar=i(this,"editSidebar",7);this.label=undefined;this.value=undefined;this.iconShown=false;this.imageSrc=undefined}openEditSidebar(){this.editSidebar.emit()}render(){if(!this.value){return null}return e(o,null,e("strong",null,this.label),this.imageSrc&&e("img",{src:this.imageSrc}),e("p",null,this.value),this.iconShown&&e("div",{class:"icon-container"},e("ir-icon",{class:"pointer icon",id:"pickup",onIconClickHandler:t=>{t.stopImmediatePropagation();t.stopPropagation();this.openEditSidebar()}},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"15",width:"15",viewBox:"0 0 512 550"},e("path",{fill:"#6b6f82",d:"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"})))))}};N.style=S;class L{async AddPayment(t,i){try{const e=JSON.parse(sessionStorage.getItem("token"));if(e!==null){const{data:s}=await y.post(`/Do_Payment?Ticket=${e}`,{payment:Object.assign(Object.assign({},t),{book_nbr:i})});if(s.ExceptionMsg!==""){throw new Error(s.ExceptionMsg)}return s.My_Result}}catch(t){console.log(t);throw new Error(t)}}async CancelPayment(t){try{const i=JSON.parse(sessionStorage.getItem("token"));if(i!==null){const{data:e}=await y.post(`/Cancel_Payment?Ticket=${i}`,{id:t});if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}return e.My_Result}}catch(t){console.log(t);throw new Error(t)}}}const M=".sm-margin-right.sc-ir-payment-details{margin-right:5px !important;background:#000}.action_icons.sc-ir-payment-details{width:60px}.w-60.sc-ir-payment-details{width:100px;padding:0 5px}.payments-height.sc-ir-payment-details{height:30px}.payment_date.sc-ir-payment-details{width:100px}.iframeHeight.sc-ir-payment-details{height:max-content;height:22.5rem}.designation.sc-ir-payment-details{width:120px}";const R=class{constructor(e){t(this,e);this.resetBookingData=i(this,"resetBookingData",7);this.toast=i(this,"toast",7);this.paymentService=new L;this.bookingDetails=undefined;this.defaultTexts=undefined;this.newTableRow=false;this.collapsedPayment=false;this.collapsedGuarantee=false;this.flag=false;this.confirmModal=false;this.toBeDeletedItem=undefined;this.paymentDetailsUrl="";this.paymentExceptionMessage=""}async componentWillLoad(){try{this.initializeItemToBeAdded()}catch(t){if(!this.bookingDetails.is_direct&&this.bookingDetails.channel_booking_nbr){this.paymentExceptionMessage=t}}}initializeItemToBeAdded(){this.itemToBeAdded={id:-1,date:w().format("YYYY-MM-DD"),amount:null,currency:this.bookingDetails.currency,designation:"",reference:""}}async _handleSave(){try{console.log(this.itemToBeAdded);if(this.itemToBeAdded.amount===null){this.toast.emit({type:"error",title:"",description:"Select an amount",position:"top-right"});return}}catch(t){console.log(t)}}handlePaymentInputChange(t,i,e){if(t==="amount"){if(!isNaN(i)||i===""){if(i===""){this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:null})}else{this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:parseFloat(i)})}}else if(e&&e.target){let t=e.target;let i=t.value;i=i.replace(/[^\d-]|(?<!^)-/g,"");t.value=i}}else{this.itemToBeAdded=Object.assign(Object.assign({},this.itemToBeAdded),{[t]:i})}}async handleConfirmModal(t){t.stopImmediatePropagation();t.stopPropagation();try{await this.paymentService.CancelPayment(this.toBeDeletedItem.id);const t=this.bookingDetails.financial.payments.filter((t=>t.id!==this.toBeDeletedItem.id));this.bookingDetails=Object.assign(Object.assign({},this.bookingDetails),{financial:Object.assign(Object.assign({},this.bookingDetails.financial),{payments:t})});this.confirmModal=!this.confirmModal;this.resetBookingData.emit(null);this.toBeDeletedItem=null}catch(t){console.log(t)}}handleBookingDetails(){if(this.newTableRow){this.newTableRow=false}}handleDateChange(t){this.handlePaymentInputChange("date",t.detail.end.format("YYYY-MM-DD"))}_renderTableRow(t,i="normal"){return e(s,null,e("tr",null,e("td",{class:"border payments-height border-light border-bottom-0 text-center"},i==="normal"?e("span",{class:"sm-padding-left"},g(t.date)):e("ir-date-picker",{minDate:w().add(-2,"months").startOf("month").format("YYYY-MM-DD"),singleDatePicker:true,autoApply:true,onDateChanged:this.handleDateChange.bind(this)})),e("td",{class:"border payments-height border-light border-bottom-0 text-center "},i==="normal"?e("span",{class:"sm-padding-right"},"$",Number(t.amount).toFixed(2)):e("input",{class:"border-0  form-control py-0 m-0 w-100",value:this.itemToBeAdded.amount===null?"":Number(this.itemToBeAdded.amount).toFixed(2),onInput:t=>this.handlePaymentInputChange("amount",+t.target.value,t),type:"text"})),e("td",{class:"border payments-height border-light border-bottom-0 text-center"},i==="normal"?e("span",{class:"sm-padding-left"},t.designation):e("input",{class:"border-0 w-100 form-control py-0 m-0",onInput:t=>this.handlePaymentInputChange("designation",t.target.value),type:"text"})),e("td",{rowSpan:2,class:"border payments-height border-light border-bottom-0 text-center"},e("ir-icon",{icon:"ft-save color-ir-light-blue-hover h5 pointer sm-margin-right",onClick:i==="add"?()=>{this._handleSave()}:()=>{}},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"14.25",viewBox:"0 0 448 512"},e("path",{fill:"#6b6f82",d:"M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V173.3c0-17-6.7-33.3-18.7-45.3L352 50.7C340 38.7 323.7 32 306.7 32H64zm0 96c0-17.7 14.3-32 32-32H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V128zM224 288a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"}))),e("span",null,"  "),e("ir-icon",{icon:"ft-trash-2 danger h5 pointer",onClick:i==="add"?()=>{this.newTableRow=false;this.initializeItemToBeAdded()}:()=>{this.toBeDeletedItem=t;const i=document.querySelector(".delete-record-modal");i.openModal()}},e("svg",{slot:"icon",fill:"#ff2441",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"14.25",viewBox:"0 0 448 512"},e("path",{d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"}))))),e("tr",null,e("td",{colSpan:3,class:"border border-light payments-height border-bottom-0 text-center"},i==="normal"?e("span",{class:"sm-padding-left "},t.reference):e("input",{class:"border-0 w-100  form-control py-0 m-0",onKeyPress:t=>{if(t.key==="Enter"){this.newTableRow=false;this._handleSave()}},onInput:t=>this.handlePaymentInputChange("reference",t.target.value),type:"text"}))))}bookingGuarantee(){var t,i,s,o,n,a,l,r,h,c,d,u,p,f,g,b,v,w,y,k,x,_,D,O,C,I,B,T;if(this.bookingDetails.is_direct&&!this.bookingDetails.guest.cci){return null}return e("div",null,e("div",{class:"d-flex align-items-center"},e("strong",{class:"mr-1"},this.defaultTexts.entries.Lcz_BookingGuarantee),e("ir-icon",{id:"drawer-icon","data-toggle":"collapse","data-target":`.guarrantee`,"aria-expanded":"false","aria-controls":"myCollapse",class:"sm-padding-right pointer",onClick:async()=>{if(!this.bookingDetails.is_direct&&this.bookingDetails.channel_booking_nbr){this.paymentDetailsUrl=await(new m).getPCICardInfoURL(this.bookingDetails.booking_nbr)}this.collapsedGuarantee=!this.collapsedGuarantee}},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"22.5",viewBox:"0 0 576 512"},e("path",{fill:"#104064",d:"M512 80c8.8 0 16 7.2 16 16v32H48V96c0-8.8 7.2-16 16-16H512zm16 144V416c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V224H528zM64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm56 304c-13.3 0-24 10.7-24 24s10.7 24 24 24h48c13.3 0 24-10.7 24-24s-10.7-24-24-24H120zm128 0c-13.3 0-24 10.7-24 24s10.7 24 24 24H360c13.3 0 24-10.7 24-24s-10.7-24-24-24H248z"})))),e("div",{class:"collapse guarrantee "},this.bookingDetails.is_direct?[e("div",null,((i=(t=this.bookingDetails)===null||t===void 0?void 0:t.guest)===null||i===void 0?void 0:i.cci)&&"Card:"," ",e("span",null,((n=(o=(s=this.bookingDetails)===null||s===void 0?void 0:s.guest)===null||o===void 0?void 0:o.cci)===null||n===void 0?void 0:n.nbr)||"")," ",((r=(l=(a=this.bookingDetails)===null||a===void 0?void 0:a.guest)===null||l===void 0?void 0:l.cci)===null||r===void 0?void 0:r.expiry_month)&&"Expiry: ",e("span",null," ",((d=(c=(h=this.bookingDetails)===null||h===void 0?void 0:h.guest)===null||c===void 0?void 0:c.cci)===null||d===void 0?void 0:d.expiry_month)||""," ",((f=(p=(u=this.bookingDetails)===null||u===void 0?void 0:u.guest)===null||p===void 0?void 0:p.cci)===null||f===void 0?void 0:f.expiry_year)&&"/"+((v=(b=(g=this.bookingDetails)===null||g===void 0?void 0:g.guest)===null||b===void 0?void 0:b.cci)===null||v===void 0?void 0:v.expiry_year))),e("div",null,((y=(w=this.bookingDetails)===null||w===void 0?void 0:w.guest)===null||y===void 0?void 0:y.cci.holder_name)&&"Name:"," ",e("span",null,((_=(x=(k=this.bookingDetails)===null||k===void 0?void 0:k.guest)===null||x===void 0?void 0:x.cci)===null||_===void 0?void 0:_.holder_name)||"")," ",((C=(O=(D=this.bookingDetails)===null||D===void 0?void 0:D.guest)===null||O===void 0?void 0:O.cci)===null||C===void 0?void 0:C.cvc)&&"- CVC:"," ",e("span",null," ",((T=(B=(I=this.bookingDetails)===null||I===void 0?void 0:I.guest)===null||B===void 0?void 0:B.cci)===null||T===void 0?void 0:T.cvc)||""))]:this.paymentDetailsUrl?e("iframe",{src:this.paymentDetailsUrl,width:"100%",class:"iframeHeight",frameborder:"0",name:"payment"}):e("div",{class:"text-center"},this.paymentExceptionMessage)))}_renderDueDate(t){return e("tr",null,e("td",{class:"pr-1"},g(t.date)),e("td",{class:"pr-1"},b(t.amount,this.bookingDetails.currency.code)),e("td",{class:"pr-1"},t.description),e("td",{class:"collapse font-size-small roomName"},t.room))}render(){var t,i,o,n;if(!this.bookingDetails.financial){return null}return[e("div",{class:"card m-0"},e("div",{class:"p-1"},e("div",{class:"mb-2 h4"},this.defaultTexts.entries.Lcz_DueBalance,":"," ",e("span",{class:"danger font-weight-bold"},b(this.bookingDetails.financial.due_amount,this.bookingDetails.currency.code))),this.bookingGuarantee(),e("div",{class:"mt-2"},e("div",null,((i=(t=this.bookingDetails.financial)===null||t===void 0?void 0:t.due_dates)===null||i===void 0?void 0:i.length)>0&&e(s,null,e("div",{class:"d-flex align-items-center"},e("strong",{class:"mr-1"},this.defaultTexts.entries.Lcz_PaymentDueDates),e("ir-icon",{id:"drawer-icon","data-toggle":"collapse","data-target":`.roomName`,"aria-expanded":"false","aria-controls":"myCollapse",class:"sm-padding-right pointer",onClick:()=>{this.collapsedPayment=!this.collapsedPayment}},!this.collapsedPayment?e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"22.5",viewBox:"0 0 576 512"},e("path",{fill:"#104064",d:"M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"})):e("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",width:"25",viewBox:"0 0 640 512",slot:"icon"},e("path",{fill:"#104064",d:"M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c8.4-19.3 10.6-41.4 4.8-63.3c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zM373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5L373 389.9z"})))),e("table",null,(o=this.bookingDetails.financial.due_dates)===null||o===void 0?void 0:o.map((t=>this._renderDueDate(t))))))),e("div",{class:"mt-2 d-flex  flex-column rounded payment-container"},e("strong",null,this.defaultTexts.entries.Lcz_Payments),e("table",{class:"mt-1"},e("thead",null,e("tr",null,e("th",{class:"border border-light border-bottom-0 text-center payment_date"},this.defaultTexts.entries.Lcz_Dates),e("th",{class:"border border-light border-bottom-0 text-center w-60"},this.defaultTexts.entries.Lcz_Amount),e("th",{class:"border border-light border-bottom-0 text-center designation"},this.defaultTexts.entries.Lcz_Designation),e("th",{class:"border border-light border-bottom-0 text-center action_icons"},e("span",{class:"sr-only"},"payment actions"),e("ir-icon",{id:"add-payment",icon:"font-weight-bold p-0",onClick:()=>{this.newTableRow=true}},e("svg",{height:14,width:14,slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},e("path",{d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"})))))),e("tbody",null,(n=this.bookingDetails.financial.payments)===null||n===void 0?void 0:n.map((t=>this._renderTableRow(t))),this.newTableRow?this._renderTableRow(null,"add"):null))))),e("ir-modal",{item:this.toBeDeletedItem,class:"delete-record-modal",modalTitle:this.defaultTexts.entries.Lcz_Confirmation,modalBody:"If deleted it will be permnantly lost!",iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:this.defaultTexts.entries.Lcz_Cancel,rightBtnText:this.defaultTexts.entries.Lcz_Delete,leftBtnColor:"secondary",rightBtnColor:"danger",onConfirmModal:this.handleConfirmModal.bind(this)})]}static get watchers(){return{bookingDetails:["handleBookingDetails"]}}};R.style=M;class A{constructor(){this.token=JSON.parse(sessionStorage.getItem("token"))}async savePickup(t,i,e){try{const s=t.arrival_time.split(":");await y.post(`/Do_Pickup?Ticket=${this.token}`,{booking_nbr:i,is_remove:e,currency:t.currency,date:t.arrival_date,details:t.flight_details,hour:s[0],minute:s[1],nbr_of_units:t.number_of_vehicles,selected_option:t.selected_option,total:+t.due_upon_booking})}catch(t){console.log(t)}}transformDefaultPickupData(t){return{arrival_date:t.date,arrival_time:t.hour+":"+t.minute,currency:t.currency,due_upon_booking:t.total.toFixed(2),flight_details:t.details,location:t.selected_option.location.id,number_of_vehicles:t.nbr_of_units,selected_option:t.selected_option,vehicle_type_code:t.selected_option.vehicle.code}}getAvailableLocations(t){let i=[];k.pickup_service.allowed_options.forEach((e=>{if(i.filter((t=>t.value===e.location.id)).length===0){i.push({text:t+" "+e.location.description,value:e.location.id})}}));return i}validateForm(t){if(t.arrival_time.split(":").length!==2){return{error:true,cause:"arrival_time"}}if(t.flight_details===""){return{error:true,cause:"flight_details"}}if(t.vehicle_type_code===""){return{error:true,cause:"vehicle_type_code"}}if(t.number_of_vehicles===0){return{error:true,cause:"number_of_vehicles"}}return{error:false}}getNumberOfVehicles(t,i){let e=Math.ceil(i/t);let s=e>1?e:1;let o=e>1?2:3;return Array.from({length:e+o},((t,i)=>s+i))}getPickUpPersonStatus(t){const i=k.pickup_service.allowed_pricing_models.find((i=>i.code===t));if(!i){return null}return i.description}updateDue(t){const i=this.getPickUpPersonStatus(t.code);if(!i){return}if(i==="Person"){return t.amount*t.numberOfPersons}else{return t.amount*t.number_of_vehicles}}}const j=".sc-ir-pickup-h{display:block}.card-title.sc-ir-pickup{border-bottom:1px solid #e4e5ec;width:100%}.border-theme.sc-ir-pickup{border:1px solid #cacfe7}";const P=class{constructor(e){t(this,e);this.closeModal=i(this,"closeModal",7);this.resetBookingData=i(this,"resetBookingData",7);this.pickupService=new A;this.defaultPickupData=undefined;this.numberOfPersons=0;this.bookingNumber=undefined;this.isLoading=false;this.allowedOptionsByLocation=[];this.pickupData={location:-1,flight_details:"",due_upon_booking:"",number_of_vehicles:1,vehicle_type_code:"",currency:undefined,arrival_time:"",arrival_date:w().format("YYYY-MM-DD"),selected_option:undefined};this.vehicleCapacity=[];this.cause=null}componentWillLoad(){if(this.defaultPickupData){const t=this.pickupService.transformDefaultPickupData(this.defaultPickupData);this.vehicleCapacity=this.pickupService.getNumberOfVehicles(t.selected_option.vehicle.capacity,this.numberOfPersons);this.allowedOptionsByLocation=k.pickup_service.allowed_options.filter((i=>i.location.id===t.location));this.pickupData=Object.assign({},t)}}handleLocationChange(t){t.stopImmediatePropagation();t.stopPropagation();const i=t.detail;if(i===""){this.updatePickupData("location",-1)}if(i!==""){this.allowedOptionsByLocation=k.pickup_service.allowed_options.filter((t=>t.location.id.toString()===i));let t=this.allowedOptionsByLocation[0];if(!t){return}this.vehicleCapacity=this.pickupService.getNumberOfVehicles(t.vehicle.capacity,this.numberOfPersons);this.pickupData=Object.assign(Object.assign({},this.pickupData),{location:i,selected_option:t,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:t.amount,code:t.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:t.vehicle.code,currency:t.currency});const e=this.el.querySelector("#pickup-time");if(!e){setTimeout((()=>{this.initializeInputMask()}),100)}}}initializeInputMask(){const t=this.el.querySelector("#pickup-time");if(t){Inputmask("Hh:mm",{placeholder:"HH:mm",definitions:{H:{validator:"[0-1]"},h:{validator:"[0-9]"},M:{validator:"[0-5]"},m:{validator:"[0-9]"}},insertMode:true,showMaskOnHover:false,inputmode:"numeric",alias:"datetime",oncomplete:()=>{this.updatePickupData("arrival_time",t.value)},oncleared:function(){this.updatePickupData("arrival_time","")},onincomplete:function(){this.updatePickupData("arrival_time",t.value)}}).mask(t)}}handleVehicleQuantityChange(t){if(t.detail===""){return}const i=+t.detail;this.pickupData=Object.assign(Object.assign({},this.pickupData),{number_of_vehicles:i,due_upon_booking:this.pickupService.updateDue({amount:this.pickupData.selected_option.amount,code:this.pickupData.selected_option.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:i}).toFixed(2)})}handleVehicleTypeChange(t){if(t.detail===""){this.pickupData=Object.assign(Object.assign({},this.pickupData),{due_upon_booking:"",vehicle_type_code:""});return}let i=k.pickup_service.allowed_options.find((i=>i.location.id===+this.pickupData.location&&i.vehicle.code===t.detail));if(!i){return}this.vehicleCapacity=[...this.pickupService.getNumberOfVehicles(i.vehicle.capacity,this.numberOfPersons)];this.pickupData=Object.assign(Object.assign({},this.pickupData),{selected_option:i,number_of_vehicles:this.vehicleCapacity[0],due_upon_booking:this.pickupService.updateDue({amount:i.amount,code:i.pricing_model.code,numberOfPersons:this.numberOfPersons,number_of_vehicles:this.vehicleCapacity[0]}).toFixed(2),vehicle_type_code:i.vehicle.code})}updatePickupData(t,i){this.pickupData=Object.assign(Object.assign({},this.pickupData),{[t]:i})}async savePickup(){try{this.isLoading=true;const t=this.pickupService.validateForm(this.pickupData);if(t.error){this.cause=t.cause;return}if(this.cause){this.cause=null}await this.pickupService.savePickup(this.pickupData,this.bookingNumber,this.defaultPickupData!==null&&this.pickupData.location===-1);this.resetBookingData.emit(null);this.closeModal.emit(null)}catch(t){console.error(t)}finally{this.isLoading=false}}render(){return e(o,{class:"p-0"},e("div",{class:"position-sticky mb-0 shadow-none p-0"},e("div",{class:"d-flex mt-2 align-items-center justify-content-between"},e("h3",{class:"card-title text-left pb-1 font-medium-2 px-1"},c.entries.Lcz_Pickup))),e("section",{class:"px-1"},e("ir-select",{selectedValue:this.pickupData.location,selectContainerStyle:"mb-1",onSelectChange:this.handleLocationChange.bind(this),firstOption:c.entries.Lcz_Pickup_NoThankYou,class:"m-0 mb-1",LabelAvailable:false,data:this.pickupService.getAvailableLocations(c.entries.Lcz_Pickup_YesFrom)}),this.pickupData.location>0&&e(s,null,e("div",{class:"d-flex"},e("div",{class:"form-group  mr-1"},e("div",{class:"input-group row m-0"},e("div",{class:`input-group-prepend col-5 p-0 text-dark border-0`},e("label",{class:`input-group-text  flex-grow-1 text-dark border-theme `},c.entries.Lcz_ArrivalDate)),e("div",{class:"form-control form-control-md col-7 d-flex align-items-center pl-0"},e("ir-date-picker",{minDate:w().format("YYYY-MM-DD"),autoApply:true,format:"ddd, DD M YYYY",singleDatePicker:true,onDateChanged:t=>{this.updatePickupData("arrival_date",t.detail.start.format("YYYY-MM-DD"))}})))),e("div",{class:"form-group"},e("div",{class:"input-group  row m-0"},e("div",{class:`input-group-prepend col-4 col-sm-3 p-0 text-dark border-0`},e("label",{htmlFor:"pickup",class:`input-group-text flex-grow-1 text-dark border-theme`},c.entries.Lcz_Time)),e("input",{value:this.pickupData.arrival_time,type:"text",id:"pickup-time",class:`form-control col-8 col-sm-4 ${this.cause==="arrival_time"&&"border-danger"}`})))),e("ir-input-text",{value:this.pickupData.flight_details,label:c.entries.Lcz_FlightDetails,onTextChange:t=>this.updatePickupData("flight_details",t.detail),placeholder:"",inputStyles:this.cause==="flight_details"?"border-danger":""}),e("ir-select",{selectContainerStyle:"mb-1",selectStyles:this.cause==="vehicle_type_code"?"border-danger":"",onSelectChange:this.handleVehicleTypeChange.bind(this),firstOption:c.entries.Lcz_Select,selectedValue:this.pickupData.vehicle_type_code,class:"m-0",LabelAvailable:false,data:this.allowedOptionsByLocation.map((t=>({text:t.vehicle.description,value:t.vehicle.code})))}),e("div",{class:"d-flex flex-column flex-md-row"},e("ir-select",{labelBorder:"theme",selectContainerStyle:"mb-1",onSelectChange:this.handleVehicleQuantityChange.bind(this),selectStyles:this.cause==="number_of_vehicles"?"border-danger":"",selectedValue:this.pickupData.number_of_vehicles,labelWidth:7,class:"m-0  mb-md-0 mr-md-1 flex-fill",label:c.entries.Lcz_NbrOfVehicles,data:this.vehicleCapacity.map((t=>({text:t,value:t})))}),e("ir-input-text",{labelBorder:"theme",readonly:true,value:this.pickupData.due_upon_booking,labelWidth:7,label:`${c.entries.Lcz_DueUponBooking}  ${this.pickupData.currency.symbol}`,placeholder:"",class:""}))),e("div",{class:"d-flex flex-column flex-sm-row mt-3"},e("ir-button",{onClick:()=>this.closeModal.emit(null),btn_styles:"justify-content-center",class:`mb-1 mb-sm-0 flex-fill  ${this.defaultPickupData||this.pickupData.location!==-1?"mr-sm-1":""}`,icon:"",text:c.entries.Lcz_Cancel,btn_color:"secondary"}),(this.defaultPickupData||this.pickupData.location!==-1)&&e("ir-button",{btn_styles:"justify-content-center align-items-center",class:"m-0 flex-fill text-center",icon:"",isLoading:this.isLoading,text:c.entries.Lcz_Save,btn_color:"primary",onClick:this.savePickup.bind(this)}))))}get el(){return n(this)}};P.style=j;const z=".light-blue-bg.sc-ir-room{background:#acecff;padding:0.2rem 0.3rem;border-radius:5px}";const H=class{constructor(e){t(this,e);this.deleteFinished=i(this,"deleteFinished",7);this.pressCheckIn=i(this,"pressCheckIn",7);this.pressCheckOut=i(this,"pressCheckOut",7);this.editInitiated=i(this,"editInitiated",7);this.bookingEvent=undefined;this.bookingIndex=undefined;this.mealCodeName=undefined;this.myRoomTypeFoodCat=undefined;this.currency="USD";this.legendData=undefined;this.roomsInfo=undefined;this.collapsed=false;this.defaultTexts=undefined;this.ticket=undefined;this.hasRoomEdit=false;this.hasRoomDelete=false;this.hasRoomAdd=false;this.hasCheckIn=false;this.hasCheckOut=false;this.item=undefined;this.isLoading=false;this.isModelOpen=false}componentWillLoad(){if(this.bookingEvent){this.item=this.bookingEvent.rooms[this.bookingIndex]}}handleBookingEventChange(){this.item=this.bookingEvent.rooms[this.bookingIndex]}componentDidLoad(){this.modal=this.element.querySelector("ir-modal")}handleClick(t){let i=t.target;if(i.id=="checkin"){this.pressCheckIn.emit(this.item)}else if(i.id=="checkout"){this.pressCheckOut.emit(this.item)}}getDateStr(t,i="default"){return t.getDate()+" "+t.toLocaleString(i,{month:"short"})+" "+t.getFullYear()}handleEditClick(){this.editInitiated.emit({event_type:"EDIT_BOOKING",ID:this.item["assigned_units_pool"],NAME:r(this.item.guest.first_name,this.item.guest.last_name),EMAIL:this.bookingEvent.guest.email,PHONE:this.bookingEvent.guest.mobile,REFERENCE_TYPE:"",FROM_DATE:this.bookingEvent.from_date,TO_DATE:this.bookingEvent.to_date,TITLE:`${this.defaultTexts.entries.Lcz_EditBookingFor} ${this.item.roomtype.name} ${this.item.unit.name}`,defaultDateRange:{dateDifference:this.item.days.length,fromDate:new Date(this.item.from_date+"T00:00:00"),fromDateStr:this.getDateStr(new Date(this.item.from_date+"T00:00:00")),toDate:new Date(this.item.to_date+"T00:00:00"),toDateStr:this.getDateStr(new Date(this.item.to_date+"T00:00:00")),message:""},bed_preference:this.item.bed_preference,adult_child_offering:this.item.rateplan.selected_variation.adult_child_offering,ADULTS_COUNT:this.item.rateplan.selected_variation.adult_nbr,ARRIVAL:this.bookingEvent.arrival,ARRIVAL_TIME:this.bookingEvent.arrival.description,BOOKING_NUMBER:this.bookingEvent.booking_nbr,cancelation:this.item.rateplan.cancelation,channel_booking_nbr:this.bookingEvent.channel_booking_nbr,CHILDREN_COUNT:this.item.rateplan.selected_variation.child_nbr,COUNTRY:this.bookingEvent.guest.country_id,ENTRY_DATE:this.bookingEvent.from_date,FROM_DATE_STR:this.bookingEvent.format.from_date,guarantee:this.item.rateplan.guarantee,GUEST:this.bookingEvent.guest,IDENTIFIER:this.item.identifier,is_direct:this.bookingEvent.is_direct,IS_EDITABLE:this.bookingEvent.is_editable,NO_OF_DAYS:this.item.days.length,NOTES:this.bookingEvent.remark,origin:this.bookingEvent.origin,POOL:this.item["assigned_units_pool"],PR_ID:this.item.unit.id,RATE:this.item.total,RATE_PLAN:this.item.rateplan.name,RATE_PLAN_ID:this.item.rateplan.id,RATE_TYPE:this.item.roomtype.id,ROOMS:this.bookingEvent.rooms,SOURCE:this.bookingEvent.source,SPLIT_BOOKING:false,STATUS:"IN-HOUSE",TO_DATE_STR:this.bookingEvent.format.to_date,TOTAL_PRICE:this.bookingEvent.total,legendData:this.legendData,roomsInfo:this.roomsInfo,roomName:this.item.unit.name})}handleDeleteClick(){this.modal.openModal()}async deleteRoom(){try{this.isLoading=true;let t=[...this.bookingEvent.rooms];t=t.filter((t=>t.identifier!==this.item.identifier));const i={assign_units:true,check_in:true,is_pms:true,is_direct:true,booking:{booking_nbr:this.bookingEvent.booking_nbr,from_date:this.bookingEvent.from_date,to_date:this.bookingEvent.to_date,remark:this.bookingEvent.remark,property:this.bookingEvent.property,source:this.bookingEvent.source,currency:this.bookingEvent.currency,arrival:this.bookingEvent.arrival,guest:this.bookingEvent.guest,rooms:t}};console.log("body:",i);const{data:e}=await y.post(`/DoReservation?Ticket=${this.ticket}`,i);if(e.ExceptionMsg!==""){throw new Error(e.ExceptionMsg)}this.deleteFinished.emit(this.item.identifier)}catch(t){}finally{this.isLoading=false}}render(){return e("div",{class:"p-1 d-flex m-0"},e("ir-icon",{id:"drawer-icon","data-toggle":"collapse","data-target":`#roomCollapse-${this.item.identifier.split(" ").join("")}`,"aria-expanded":"false","aria-controls":"collapseExample",class:"pointer mr-1",onClick:()=>{this.collapsed=!this.collapsed}},!this.collapsed?e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"20",width:"22.5",viewBox:"0 0 576 512"},e("path",{fill:"#104064",d:"M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"})):e("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",width:"25",viewBox:"0 0 640 512",slot:"icon"},e("path",{fill:"#104064",d:"M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c8.4-19.3 10.6-41.4 4.8-63.3c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zM373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5L373 389.9z"}))),e("div",{class:"w-100 m-0"},e("div",{class:"d-flex align-items-end justify-content-between"},e("div",null,e("strong",null,this.myRoomTypeFoodCat||""," ")," ",this.mealCodeName," ",this.item.rateplan.is_non_refundable&&` - ${this.defaultTexts.entries.Lcz_NonRefundable}`," "),e("div",{class:"d-flex"},e("p",{class:"mr-1 p-0 m-0 "},b(this.item.total,this.currency)),this.hasRoomEdit&&e("ir-icon",{id:`roomEdit-${this.item.identifier}`,class:"pointer mr-1",onClick:this.handleEditClick.bind(this)},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"16",viewBox:"0 0 512 512"},e("path",{fill:"#6b6f82",d:"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"}))),this.hasRoomDelete&&e("ir-icon",{onClick:this.handleDeleteClick.bind(this),id:`roomDelete-${this.item.identifier}`,class:"pointer mr-1"},e("svg",{slot:"icon",fill:"#ff2441",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"14.25",viewBox:"0 0 448 512"},e("path",{d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"}))))),e("div",null,e("span",{class:"mr-1"},`${this.item.guest.first_name||""} ${this.item.guest.last_name||""}`),this.item.rateplan.selected_variation.adult_nbr>0&&e("span",null," ",this.item.rateplan.selected_variation.adult_child_offering)),e("div",{class:"d-flex align-items-center"},e("span",{class:" mr-1"},g(this.item.from_date)," - ",g(this.item.to_date)),this.item.unit&&e("span",{class:"light-blue-bg mr-2 "},this.item.unit.name),this.hasCheckIn&&e("ir-button",{id:"checkin",icon:"",class:"mr-1",btn_color:"info",size:"sm",text:"Check in"}),this.hasCheckOut&&e("ir-button",{id:"checkout",icon:"",btn_color:"info",size:"sm",text:"Check out"})),e("div",{class:"collapse",id:`roomCollapse-${this.item.identifier.split(" ").join("")}`},e("div",{class:"d-flex"},e("div",{class:" sm-padding-top"},e("strong",{class:"sm-padding-right"},`${this.defaultTexts.entries.Lcz_Breakdown}:`)),e("div",{class:"flex-fill"},e("table",null,this.item.days.length>0&&this.item.days.map((t=>e("tr",null,e("td",{class:"pr-2"},v(t.date))," ",e("td",null,b(t.amount,this.currency)))))))),e("div",{innerHTML:this.item.rateplan.cancelation||""}),e("ir-label",{label:`${this.defaultTexts.entries.Lcz_MealPlan}:`,value:this.mealCodeName}))),e("ir-modal",{onConfirmModal:this.deleteRoom.bind(this),iconAvailable:true,icon:"ft-alert-triangle danger h1",leftBtnText:this.defaultTexts.entries.Lcz_Cancel,rightBtnText:this.defaultTexts.entries.Lcz_Delete,leftBtnColor:"secondary",rightBtnColor:"danger",modalTitle:this.defaultTexts.entries.Lcz_Confirmation,modalBody:`${this.defaultTexts.entries["Lcz_AreYouSureDoYouWantToRemove "]} ${this.item.roomtype.name} ${this.item.unit&&this.item.unit.name} ${this.defaultTexts.entries.Lcz_FromThisBooking}`}))}get element(){return n(this)}static get watchers(){return{bookingEvent:["handleBookingEventChange"]}}};H.style=z;const V=".backdrop{position:fixed;top:0;left:0;width:100%;height:100vh;cursor:pointer;background:rgba(0, 0, 0, 0.5);z-index:99;transition:all 0.5s;opacity:0;pointer-events:none;transition:all 0.5s}.backdrop.active{opacity:1;pointer-events:all}.sidebar-right{position:fixed;top:0;right:-100%;bottom:0;width:var(--sidebar-width, 40rem);max-width:100%;box-shadow:0 0 10px rgba(0, 0, 0, 0.1);transition:all 0.5s;z-index:100;overflow-y:hidden;color:var(--sidebar-color, #000);background-color:var(--sidebar-backgound, #fff);padding:0.5rem}.sidebar-right.active{right:0;overflow-y:auto}.sidebar-left{position:fixed;top:0;left:-100%;bottom:0;width:var(--sidebar-width, 30rem);max-width:100%;box-shadow:0 0 10px rgba(0, 0, 0, 0.1);transition:all 0.5s;z-index:200;overflow-y:hidden;color:var(--sidebar-color, #000);background:var(--sidebar-backgound, #fff);padding:0.5rem}.sidebar-left.active{left:0;overflow-y:scroll}.close{position:absolute;top:0.5rem;right:1rem;width:1rem;height:1rem;cursor:pointer}";const G=class{constructor(e){t(this,e);this.irSidebarToggle=i(this,"irSidebarToggle",7);this.name=undefined;this.side="right";this.showCloseButton=true;this.open=false;this.sidebarStyles=undefined}applyStyles(){for(const t in this.sidebarStyles){if(this.sidebarStyles.hasOwnProperty(t)){this.sidebarRef.style[t]=this.sidebarStyles[t]}}}handleSidebarStylesChange(){this.applyStyles()}componentWillLoad(){this.handleKeyDown=this.handleKeyDown.bind(this)}componentDidLoad(){this.applyStyles();document.addEventListener("keydown",this.handleKeyDown)}handleKeyDown(t){if(t.key==="Escape"){return this.toggleSidebar()}else{return}}disconnectedCallback(){document.removeEventListener("keydown",this.handleKeyDown)}async toggleSidebar(){this.irSidebarToggle.emit(this.open)}render(){let t="";if(this.open){t="active"}else{t=""}return[e("div",{class:`backdrop ${t}`,onClick:()=>{this.toggleSidebar()}}),e("div",{ref:t=>this.sidebarRef=t,class:`sidebar-${this.side} ${t}`},this.showCloseButton&&e("ir-icon",{class:"close",onIconClickHandler:()=>{this.toggleSidebar()}},e("svg",{slot:"icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",height:20,width:20},e("path",{fill:"#6b6f82",d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"}))),e("slot",null))]}static get watchers(){return{sidebarStyles:["handleSidebarStylesChange"]}}};G.style=V;export{D as igl_book_property,C as igl_booking_overview_page,B as igl_pagetwo,E as ir_guest_info,N as ir_label,R as ir_payment_details,P as ir_pickup,H as ir_room,G as ir_sidebar};
//# sourceMappingURL=p-eea1912c.entry.js.map