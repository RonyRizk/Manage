import{h as i,r as t,F as e,H as s,g as n}from"./p-1da6dd41.js";import{R as a}from"./p-55747d0d.js";import{s as l,u as o,a as r,t as c,r as d,c as h}from"./p-0ee2eadf.js";import{l as p}from"./p-cda0b50c.js";import{a as u}from"./p-d0086f2b.js";import{C as m}from"./p-b7c850d8.js";import{c as v}from"./p-85d94cdd.js";import"./p-58003fb6.js";const g=t=>[{id:"edit",name:t.Lcz_Edit,icon:()=>i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 512 512"},i("path",{d:"M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"})),action:i=>{const t=i.map.find((i=>i.type==="property"));l(i.id,i.is_active);o("hotel_id",t.channel_id);o("hotel_title",i.title);r(i.channel.id.toString());c()}},{id:"remove",name:t===null||t===void 0?void 0:t.Lcz_Delete,icon:()=>i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"12.25",viewBox:"0 0 448 512"},i("path",{d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"})),action:i=>({cause:"remove",action:async()=>{const t=new m;t.setToken(v.token);await t.saveConnectedChannel(i.id,true)},title:"",message:t===null||t===void 0?void 0:t.Lcz_ThisActionWillDelete,main_color:"danger"})}];const f=".sc-ir-channel-h{display:block;--ir-sidebar-padding:0}.dropdown-toggle.sc-ir-channel{color:var(--blue)}.dropdown-toggle.sc-ir-channel::after{content:none;display:none}.dropdown-toggle.sc-ir-channel .caret-icon.sc-ir-channel{transition:transform 0.15s ease-in-out, color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out,\r\n    -webkit-box-shadow 0.15s ease-in-out}.btn.sc-ir-channel:hover .caret-icon.sc-ir-channel path.sc-ir-channel{fill:#6b6f82}.show.sc-ir-channel .caret-icon.sc-ir-channel{transform:rotate(-180deg)}.dropdown-divider.sc-ir-channel{border-color:#e4e5ec}.dropdown-item.sc-ir-channel{padding:10px;display:flex;align-items:center;gap:10px;color:#6b6f82}.dropdown-item.sc-ir-channel svg.sc-ir-channel path.sc-ir-channel{fill:#6b6f82}.danger.sc-ir-channel{color:var(--red)}.danger.sc-ir-channel svg.sc-ir-channel path.sc-ir-channel{fill:var(--red)}.table.sc-ir-channel thead.sc-ir-channel tr.sc-ir-channel{height:50px !important}.table-container.sc-ir-channel{border-radius:30px}.table.sc-ir-channel thead.sc-ir-channel{background:#fafafa;border-top-width:0}.actions-theader.sc-ir-channel{width:35% !important;text-align:end}.dots.sc-ir-channel{display:flex;align-items:center;justify-content:center;margin:0 3px;padding:0}.dot.sc-ir-channel{width:8px;height:8px;margin:0px 4px;background-color:#6b6f82;border-radius:50%;animation:dotFlashing 1s infinite linear alternate}.dot.sc-ir-channel:nth-child(2){animation-delay:0.2s}.h-screen.sc-ir-channel{height:100vh !important}.dot.sc-ir-channel:nth-child(3){animation-delay:0.4s}@keyframes dotFlashing{0%{opacity:0}50%,100%{opacity:1}}@media (min-width: 1024px){.sc-ir-channel-h{--sidebar-width:820px}}";const w=class{constructor(i){t(this,i);this.roomService=new a;this.channelService=new m;this.ticket="";this.propertyid=undefined;this.language=undefined;this.baseurl=undefined;this.channel_status=null;this.modal_cause=null;this.isLoading=false}componentWillLoad(){this.isLoading=true;if(this.baseurl){u.defaults.baseURL=this.baseurl}if(this.ticket!==""){v.token=this.ticket;this.channelService.setToken(this.ticket);this.roomService.setToken(this.ticket);this.initializeApp()}}async handleConfirmClicked(i){i.stopImmediatePropagation();i.stopPropagation();if(!this.modal_cause){return}await this.modal_cause.action();if(this.modal_cause.cause==="remove"){d();await this.refreshChannels()}this.modal_cause=null}openModal(){this.irModalRef.openModal()}async refreshChannels(){await Promise.all([this.channelService.getExposedChannels(),this.channelService.getExposedConnectedChannels(this.propertyid)])}async initializeApp(){try{const[,,,i]=await Promise.all([this.roomService.fetchData(this.propertyid,this.language),this.channelService.getExposedChannels(),this.channelService.getExposedConnectedChannels(this.propertyid),this.roomService.fetchLanguage(this.language,["_CHANNEL_FRONT"])]);h.property_id=this.propertyid;if(!p.entries){p.entries=i.entries;p.direction=i.direction}}catch(i){console.error(i)}finally{this.isLoading=false}}async ticketChanged(){v.token=this.ticket;this.roomService.setToken(this.ticket);this.channelService.setToken(this.ticket);this.initializeApp()}handleCancelModal(i){i.stopImmediatePropagation();i.stopPropagation();this.modal_cause=null}handleSidebarClose(i){var t;i.stopImmediatePropagation();i.stopPropagation();if(h.selectedChannel){this.modal_cause={action:()=>new Promise((i=>{this.resetSideBar();i("")})),cause:"channel",main_color:"primary",message:(t=p.entries)===null||t===void 0?void 0:t.Lcz_UnSavedChangesWillBeLost,title:""};this.openModal()}else{this.resetSideBar()}}resetSideBar(){this.channel_status=null;d()}async handleSaveChange(i){i.stopImmediatePropagation();i.stopPropagation();await this.refreshChannels();this.resetSideBar()}async handleCheckChange(i,t){const e=t.map.find((i=>i.type==="property"));l(t.id,i);o("hotel_id",e.channel_id);o("hotel_title",t.title);r(t.channel.id.toString());c();await this.channelService.saveConnectedChannel(null,false);d();this.refreshChannels()}render(){var t,n,a,l,o,r,c,d,u,m,v,f,w;if(this.isLoading){return i("div",{class:"h-screen bg-white d-flex flex-column align-items-center justify-content-center"},i("ir-loading-screen",null))}return i(s,{class:"h-100 "},i("section",{class:"p-2 px-lg-5 py-0 h-100 d-flex flex-column"},i("div",{class:"d-flex w-100 justify-content-between mb-2 align-items-center"},i("h3",{class:"font-weight-bold m-0 p-0"},(t=p.entries)===null||t===void 0?void 0:t.Lcz_iSWITCH),i("ir-button",{text:(n=p.entries)===null||n===void 0?void 0:n.Lcz_CreateChannel,size:"sm",onClickHanlder:()=>this.channel_status="create"},i("svg",{slot:"icon","stroke-width":3,width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i("path",{d:"M7.49991 0.876892C3.84222 0.876892 0.877075 3.84204 0.877075 7.49972C0.877075 11.1574 3.84222 14.1226 7.49991 14.1226C11.1576 14.1226 14.1227 11.1574 14.1227 7.49972C14.1227 3.84204 11.1576 0.876892 7.49991 0.876892ZM1.82707 7.49972C1.82707 4.36671 4.36689 1.82689 7.49991 1.82689C10.6329 1.82689 13.1727 4.36671 13.1727 7.49972C13.1727 10.6327 10.6329 13.1726 7.49991 13.1726C4.36689 13.1726 1.82707 10.6327 1.82707 7.49972ZM7.50003 4C7.77617 4 8.00003 4.22386 8.00003 4.5V7H10.5C10.7762 7 11 7.22386 11 7.5C11 7.77614 10.7762 8 10.5 8H8.00003V10.5C8.00003 10.7761 7.77617 11 7.50003 11C7.22389 11 7.00003 10.7761 7.00003 10.5V8H4.50003C4.22389 8 4.00003 7.77614 4.00003 7.5C4.00003 7.22386 4.22389 7 4.50003 7H7.00003V4.5C7.00003 4.22386 7.22389 4 7.50003 4Z",fill:"currentColor","fill-rule":"evenodd","clip-rule":"evenodd"})))),i("div",{class:"card p-1 flex-fill m-0"},i("table",{class:"table table-striped table-bordered no-footer dataTable"},i("thead",null,i("tr",null,i("th",{scope:"col",class:"text-left"},(a=p.entries)===null||a===void 0?void 0:a.Lcz_Channel),i("th",{scope:"col"},(l=p.entries)===null||l===void 0?void 0:l.Lcz_Status),i("th",{scope:"col",class:"actions-theader"},(o=p.entries)===null||o===void 0?void 0:o.Lcz_Actions))),i("tbody",{class:""},(r=h.connected_channels)===null||r===void 0?void 0:r.map((t=>{var s;return i("tr",{key:t.channel.id},i("td",{class:"text-left"},t.channel.name," ",t.title?`(${t.title})`:""),i("td",null,i("ir-switch",{checked:t.is_active,onCheckChange:i=>this.handleCheckChange(i.detail,t)})),i("th",null,i("div",{class:"d-flex justify-content-end"},i("div",{class:"btn-group"},i("button",{type:"button",class:"btn  dropdown-toggle px-0","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},i("span",{class:"mr-1"}," ",(s=p.entries)===null||s===void 0?void 0:s.Lcz_Actions),i("svg",{class:"caret-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",height:14,width:14},i("path",{fill:"var(--blue)",d:"M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"}))),i("div",{class:"dropdown-menu dropdown-menu-right"},g(p.entries).map(((s,n)=>i(e,null,i("button",{onClick:()=>{if(s.id==="pull_future_reservation"||s.id==="view_logs"){return}s.action(t);if(s.id==="edit"){setTimeout((()=>{this.channel_status="edit"}),300)}else{this.modal_cause=s.action(t);this.openModal()}},key:s.id+"_item",class:`dropdown-item my-0 ${s.id==="remove"?"danger":""}`,type:"button"},s.icon(),s.name),n<g(p.entries).length-1&&i("div",{key:s.id+"_divider",class:"dropdown-divider my-0"})))))))))})))),h.connected_channels.length===0&&i("p",{class:"text-center"},(c=p.entries)===null||c===void 0?void 0:c.Lcz_NoChannelsAreConnected))),i("ir-sidebar",{sidebarStyles:{padding:"0"},showCloseButton:false,onIrSidebarToggle:this.handleSidebarClose.bind(this),open:this.channel_status!==null},this.channel_status&&i("ir-channel-editor",{slot:"sidebar-body",ticket:this.ticket,channel_status:this.channel_status,onCloseSideBar:this.handleSidebarClose.bind(this)})),i("ir-modal",{modalTitle:(d=this.modal_cause)===null||d===void 0?void 0:d.title,modalBody:(u=this.modal_cause)===null||u===void 0?void 0:u.message,ref:i=>this.irModalRef=i,rightBtnText:(m=p.entries)===null||m===void 0?void 0:m.Lcz_Confirm,leftBtnText:(v=p.entries)===null||v===void 0?void 0:v.Lcz_Cancel,onCancelModal:this.handleCancelModal.bind(this),rightBtnColor:(w=(f=this.modal_cause)===null||f===void 0?void 0:f.main_color)!==null&&w!==void 0?w:"primary",onConfirmModal:this.handleConfirmClicked.bind(this)}))}get el(){return n(this)}static get watchers(){return{ticket:["ticketChanged"]}}};w.style=f;export{w as ir_channel};
//# sourceMappingURL=p-17eb4941.entry.js.map