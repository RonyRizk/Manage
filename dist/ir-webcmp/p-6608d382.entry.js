import{r as t,c as e,h as i,F as s,H as a}from"./p-05195efb.js";import{l as n,o}from"./p-9501b0ae.js";import{v as l}from"./p-d4c9256e.js";import"./p-fe6c3d31.js";const r=".sc-igl-booking-room-rate-plan-h{display:block;margin-bottom:0.5rem}.currency.sc-igl-booking-room-rate-plan{display:block;position:absolute;margin:0;padding:0;height:auto;left:10px}.rate-input.sc-igl-booking-room-rate-plan{font-size:14px;line-height:0;padding:0;height:0}.rate-input-container.sc-igl-booking-room-rate-plan{display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;flex:1}@media only screen and (min-width: 1200px){.rateplan-name-container.sc-igl-booking-room-rate-plan{width:40%}.rateplan-container.sc-igl-booking-room-rate-plan{width:40%}}@media only screen and (min-width: 991px){.max-w-300.sc-igl-booking-room-rate-plan{max-width:200px}.rate-input-container.sc-igl-booking-room-rate-plan{max-width:100px}}@media only screen and (min-width: 991px) and (max-width: 1300px){.rateplan-name-container.sc-igl-booking-room-rate-plan{width:35%}}@media only screen and (max-width: 768px){.booking-btn.sc-igl-booking-room-rate-plan{width:100%}}.total-nights-container.sc-igl-booking-room-rate-plan{width:max-content}.rateInputBorder.sc-igl-booking-room-rate-plan{border-top-left-radius:3px !important;border-bottom-left-radius:3px !important}.nightBorder.sc-igl-booking-room-rate-plan{border-left-width:0;border-top-right-radius:3px !important;border-bottom-right-radius:3px !important}";const h=class{constructor(i){t(this,i);this.dataUpdateEvent=e(this,"dataUpdateEvent",7);this.gotoSplitPageTwoEvent=e(this,"gotoSplitPageTwoEvent",7);this.initialRateValue=0;this.defaultData=undefined;this.ratePlanData=undefined;this.totalAvailableRooms=undefined;this.index=undefined;this.ratePricingMode=[];this.currency=undefined;this.physicalrooms=undefined;this.shouldBeDisabled=undefined;this.dateDifference=undefined;this.bookingType="PLUS_BOOKING";this.fullyBlocked=undefined;this.isBookDisabled=false;this.defaultRoomId=undefined;this.selectedRoom=undefined;this.selectedData=undefined;this.ratePlanChangedState=false}getAvailableRooms(t){let e=[];t.forEach((t=>{if(t.Is_Fully_Available){e.push({name:t.name,id:t.pr_id})}}));return e}componentWillLoad(){console.log("default data",this.defaultData);this.updateSelectedRatePlan(this.ratePlanData)}disableForm(){if(this.bookingType==="EDIT_BOOKING"&&this.shouldBeDisabled){return false}else{return this.selectedData.is_closed||this.totalAvailableRooms===0||this.selectedData.physicalRooms.length===0}}setAvailableRooms(t){let e=this.getAvailableRooms(t);if(this.bookingType==="EDIT_BOOKING"&&this.shouldBeDisabled){if(this.selectedRoom){e.push({id:this.selectedRoom.roomId,name:this.selectedRoom.roomName});e.sort(((t,e)=>{if(t.name<e.name){return-1}if(t.name>e.name){return 1}return 0}))}}return e}getSelectedOffering(t){return this.ratePlanData.variations.find((e=>e.adult_child_offering===t))}updateSelectedRatePlan(t){var e;this.selectedData={ratePlanId:t.id,adult_child_offering:t.variations[t.variations.length-1].adult_child_offering,rateType:1,totalRooms:0,rate:(e=t.variations[t.variations.length-1].amount)!==null&&e!==void 0?e:0,ratePlanName:t.name,adultCount:t.variations[t.variations.length-1].adult_nbr,childrenCount:t.variations[t.variations.length-1].child_nbr,cancelation:t.cancelation,guarantee:t.guarantee,isRateModified:false,defaultSelectedRate:0,index:this.index,is_closed:t.is_closed,physicalRooms:this.setAvailableRooms(this.ratePlanData.assignable_units),dateDifference:this.dateDifference};if(this.defaultData){for(const[t,e]of Object.entries(this.defaultData)){this.selectedData[t]=e}this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:"physicalRooms",data:this.selectedData})}if(this.defaultData&&this.defaultData.isRateModified){console.log("object");if(this.selectedData.rateType===1){console.log("object1");this.initialRateValue=this.selectedData.rate}else{console.log("object2");this.initialRateValue=this.selectedData.rate*this.dateDifference}}else{this.initialRateValue=this.selectedData.rate/this.dateDifference}}async ratePlanDataChanged(t){this.selectedData=Object.assign(Object.assign({},this.selectedData),{adult_child_offering:t.variations[t.variations.length-1].adult_child_offering,adultCount:t.variations[t.variations.length-1].adult_nbr,childrenCount:t.variations[t.variations.length-1].child_nbr,rate:this.handleRateDaysUpdate(),physicalRooms:this.setAvailableRooms(t.assignable_units)});this.initialRateValue=this.selectedData.rateType===2?this.selectedData.rate/this.dateDifference:this.selectedData.rate;this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:"rate",data:this.selectedData})}handleRateDaysUpdate(){if(this.selectedData.isRateModified){return this.selectedData.defaultSelectedRate}const t=this.getSelectedOffering(this.selectedData.adult_child_offering);return t?t.amount:0}handleInput(t){const e=t.target;let i=e.value.replace(/[^0-9.]/g,"");const s=/^\d*\.?\d*$/;if(!s.test(i)){i=i.substring(0,i.length-1)}e.value=i;if(i){this.selectedData.isRateModified=true;this.handleDataChange("rate",t)}else{this.selectedData=Object.assign(Object.assign({},this.selectedData),{rate:-1,totalRooms:0});this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:"rate",data:this.selectedData})}}handleDataChange(t,e){const i=e.target.value;switch(t){case"adult_child_offering":this.updateOffering(i);break;case"rate":this.updateRate(i);break;default:this.updateGenericData(t,i);break}this.dataUpdateEvent.emit({key:"roomRatePlanUpdate",changedKey:t,data:this.selectedData})}updateOffering(t){const e=this.getSelectedOffering(t);if(e){this.selectedData=Object.assign(Object.assign({},this.selectedData),{adult_child_offering:t,adultCount:e.adult_nbr,childrenCount:e.child_nbr,rate:e.amount,isRateModified:false})}}updateRate(t){const e=t===""?0:Number(t);this.selectedData=Object.assign(Object.assign({},this.selectedData),{rate:e,totalRooms:t===""?0:this.selectedData.totalRooms,defaultSelectedRate:this.selectedData.rateType===2?e/this.dateDifference:e})}updateGenericData(t,e){this.selectedData=Object.assign(Object.assign({},this.selectedData),{[t]:e===""?0:parseInt(e)})}bookProperty(){this.dataUpdateEvent.emit({key:"clearData",data:this.selectedData});this.handleDataChange("totalRooms",{target:{value:"1"}});this.gotoSplitPageTwoEvent.emit({key:"gotoSplitPage",data:""})}renderRate(){if(this.selectedData.isRateModified){console.log("selectedData.rate",this.selectedData.rate);return this.selectedData.rate===-1?"":this.selectedData.rate}return this.selectedData.rateType===1?Number(this.selectedData.rate).toFixed(2):Number(this.initialRateValue).toFixed(2)}render(){return i(a,null,i("div",{class:"d-flex flex-column m-0 p-0 flex-lg-row align-items-lg-center justify-content-lg-between "},i("div",{class:"rateplan-name-container"},this.bookingType==="BAR_BOOKING"?i(s,null,i("span",{class:"font-weight-bold\t"},this.ratePlanData.name.split("/")[0]),i("span",null,"/",this.ratePlanData.name.split("/")[1])):i("span",null,this.ratePlanData.name),i("ir-tooltip",{message:this.ratePlanData.cancelation+this.ratePlanData.guarantee})),i("div",{class:"d-md-flex justify-content-md-end  align-items-md-center  flex-fill rateplan-container"},i("div",{class:"mt-1 mt-lg-0 flex-fill max-w-300"},i("fieldset",{class:"position-relative"},i("select",{disabled:this.disableForm(),class:"form-control  input-sm",id:l(),onChange:t=>this.handleDataChange("adult_child_offering",t)},this.ratePlanData.variations.map((t=>i("option",{value:t.adult_child_offering,selected:this.selectedData.adult_child_offering===t.adult_child_offering},t.adult_child_offering)))))),i("div",{class:"m-0 p-0 d-md-flex justify-content-between ml-md-1 "},i("div",{class:" d-flex mt-1  mt-lg-0 m-0 p-0 rate-total-night-view   "},i("fieldset",{class:"position-relative has-icon-left m-0 p-0 rate-input-container  "},i("input",{disabled:this.disableForm(),type:"text",class:"form-control input-sm rate-input py-0 m-0 rounded-0 rateInputBorder",value:this.renderRate(),id:l(),placeholder:n.entries.Lcz_Rate||"Rate",onInput:t=>this.handleInput(t)}),i("span",{class:"currency"},o(this.currency.code))),i("fieldset",{class:"position-relative m-0 total-nights-container p-0 "},i("select",{disabled:this.disableForm(),class:"form-control input-sm m-0 nightBorder rounded-0  py-0",id:l(),onChange:t=>this.handleDataChange("rateType",t)},this.ratePricingMode.map((t=>i("option",{value:t.CODE_NAME,selected:this.selectedData.rateType===+t.CODE_NAME},t.CODE_VALUE_EN)))))),this.bookingType==="PLUS_BOOKING"||this.bookingType==="ADD_ROOM"?i("div",{class:"flex-lg-fill  mt-lg-0 ml-md-2 m-0 mt-1 p-0"},i("fieldset",{class:"position-relative"},i("select",{disabled:this.selectedData.rate===0||this.disableForm(),class:"form-control input-sm",id:l(),onChange:t=>this.handleDataChange("totalRooms",t)},Array.from({length:this.totalAvailableRooms+1},((t,e)=>e)).map((t=>i("option",{value:t,selected:this.selectedData.totalRooms===t},t)))))):null),this.bookingType==="EDIT_BOOKING"?i(s,null,i("div",{class:" m-0 p-0  mt-lg-0  ml-md-1 mt-md-1 d-none d-md-block"},i("fieldset",{class:"position-relative"},i("input",{disabled:this.disableForm(),type:"radio",name:"ratePlanGroup",value:"1",onChange:t=>this.handleDataChange("totalRooms",t),checked:this.selectedData.totalRooms===1}))),i("button",{disabled:this.selectedData.rate===-1||this.disableForm(),type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1  mt-1 d-md-none ",onClick:()=>this.bookProperty()},this.selectedData.totalRooms===1?n.entries.Lcz_Current:n.entries.Lcz_Select)):null,this.bookingType==="BAR_BOOKING"||this.bookingType==="SPLIT_BOOKING"?i("button",{disabled:this.selectedData.rate===-1||this.disableForm()||this.bookingType==="SPLIT_BOOKING"&&this.isBookDisabled,type:"button",class:"btn btn-primary booking-btn mt-lg-0 btn-sm ml-md-1  mt-1 ",onClick:()=>this.bookProperty()},n.entries.Lcz_Book):null)))}static get watchers(){return{ratePlanData:["ratePlanDataChanged"]}}};h.style=r;const d=".sc-igl-date-range-h{display:flex;text-align:left;align-items:center}.date-range-input.sc-igl-date-range{margin:0;padding:0;display:flex;flex:1}.iglRangeNights.sc-igl-date-range{margin:0;padding:0}.iglRangePicker[data-state='disabled'].sc-igl-date-range{border:0;padding-left:0;padding-right:0;width:180px;margin-right:0}.iglRangePicker.sc-igl-date-range{margin:0;border:1px solid #379ff2;box-sizing:border-box;width:220px;display:flex;align-items:center}.calendarPickerContainer.sc-igl-date-range{display:flex}";const c=class{constructor(i){t(this,i);this.dateSelectEvent=e(this,"dateSelectEvent",7);this.toast=e(this,"toast",7);this.totalNights=0;this.fromDateStr="from";this.toDateStr="to";this.defaultData=undefined;this.disabled=false;this.minDate=undefined;this.dateLabel=undefined;this.maxDate=undefined;this.renderAgain=false}getStringDateFormat(t){return t.getFullYear()+"-"+(t.getMonth()<9?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<=9?"0":"")+t.getDate()}componentWillLoad(){let t=new Date;t.setHours(0,0,0,0);t.setDate(t.getDate()+1);if(this.defaultData){if(this.defaultData.fromDate){this.fromDate=new Date(this.defaultData.fromDate);this.fromDate.setHours(0,0,0,0);this.fromDateStr=this.getFormattedDateString(this.fromDate)}if(this.defaultData.toDate){this.toDate=new Date(this.defaultData.toDate);this.toDate.setHours(0,0,0,0);this.toDateStr=this.getFormattedDateString(this.toDate)}}if(this.fromDate&&this.toDate){this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:this.fromDateStr,toDateStr:this.toDateStr,dateDifference:this.totalNights})}}calculateTotalNights(){this.totalNights=Math.floor((this.toDate.getTime()-this.fromDate.getTime())/864e5)}getFormattedDateString(t){return t.getDate()+" "+t.toLocaleString("default",{month:"short"}).toLowerCase()+" "+t.getFullYear()}handleDateSelectEvent(t,e=""){this.dateSelectEvent.emit({key:t,data:e})}handleDateChange(t){const{start:e,end:i}=t.detail;this.fromDate=e.toDate();this.toDate=i.toDate();this.calculateTotalNights();this.handleDateSelectEvent("selectedDateRange",{fromDate:this.fromDate.getTime(),toDate:this.toDate.getTime(),fromDateStr:e.format("DD MMM YYYY"),toDateStr:i.format("DD MMM YYYY"),dateDifference:this.totalNights});this.renderAgain=!this.renderAgain}render(){return i(a,null,i("div",{class:"calendarPickerContainer ml-0 d-flex flex-column flex-lg-row align-items-lg-center "},i("span",{class:"mt-0 mb-1 mb-lg-0 mr-lg-1 text-left"},this.dateLabel,":"),i("div",{class:"d-flex align-items-center mr-lg-1"},i("div",{class:"iglRangePicker form-control input-sm ","data-state":this.disabled?"disabled":"active"},i("ir-date-picker",{maxDate:this.maxDate,class:"date-range-input",disabled:this.disabled,fromDate:this.fromDate,toDate:this.toDate,minDate:this.minDate,autoApply:true,onDateChanged:t=>{this.handleDateChange(t)}})),this.totalNights?i("span",{class:"iglRangeNights ml-1"},"(",this.totalNights+(this.totalNights>1?` ${n.entries.Lcz_Nights}`:` ${n.entries.Lcz_Night}`),")"):"")))}};c.style=d;const m=".sc-ir-tooltip-h{position:relative}.tooltip-icon.sc-ir-tooltip{margin:0 5px;padding:0}";const p=class{constructor(e){t(this,e);this.message=undefined;this.open=undefined}toggleOpen(t){if(this.tooltipTimeout){clearTimeout(this.tooltipTimeout)}if(t){this.tooltipTimeout=setTimeout((()=>{this.open=true}),300)}else{this.open=false}}render(){return i(a,{class:"m-0 p-0"},i("span",{onMouseEnter:()=>this.toggleOpen(true),onMouseLeave:()=>this.toggleOpen(false)},i("svg",{"data-toggle":"tooltip","data-placement":"top","data-original-title":"Info popup",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"16",class:"tooltip-icon",viewBox:"0 0 512 512"},i("path",{fill:"#6b6f82",d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"}))),this.open&&i("div",{class:"tooltip bottom show position-absolute",role:"tooltip"},i("div",{class:"tooltip-arrow"}),i("div",{class:"tooltip-inner fit"},i("span",{innerHTML:this.message}))))}};p.style=m;export{h as igl_booking_room_rate_plan,c as igl_date_range,p as ir_tooltip};
//# sourceMappingURL=p-6608d382.entry.js.map