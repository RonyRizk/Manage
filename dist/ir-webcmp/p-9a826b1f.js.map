{"version":3,"names":["initialState","channels","selectedChannel","mappedChannels","connected_channels","isConnectedToChannel","channel_settings","state","channels_data","onChange","onChannelChange","dispose","createStore","selectChannel","channel_id","find","c","id","toString","setMappedChannel","updateChannelSettings","key","value","hotel_id","hotel_title","selectedChannelMap","channel","map","resetStore","addMapping","ir_id","fr_id","push","removedMapping","filter","testConnection","hotelConnection","properties","property"],"sources":["src/stores/channel.store.ts"],"sourcesContent":["import { IChannel, IExposedChannel, IMap } from '@/models/calendarData';\r\nimport { createStore } from '@stencil/store';\r\nexport interface IChannelSettings {\r\n  hotel_id: string;\r\n  hotel_title: string;\r\n}\r\nexport interface IChannelStore {\r\n  channels: IExposedChannel[];\r\n  connected_channels: IChannel[];\r\n  selectedChannel: IExposedChannel | null;\r\n  mappedChannels: IMap[];\r\n  isConnectedToChannel: boolean;\r\n  channel_settings: IChannelSettings | null;\r\n}\r\nconst initialState: IChannelStore = {\r\n  channels: [],\r\n  selectedChannel: null,\r\n  mappedChannels: [],\r\n  connected_channels: [],\r\n  isConnectedToChannel: false,\r\n  channel_settings: null,\r\n};\r\nexport const { state: channels_data, onChange: onChannelChange, dispose } = createStore<IChannelStore>(initialState);\r\nexport function selectChannel(channel_id: string) {\r\n  if (channel_id === '') {\r\n    channels_data.selectedChannel = null;\r\n    return;\r\n  }\r\n  const selectedChannel = channels_data.channels.find(c => c.id.toString() === channel_id);\r\n  channels_data.selectedChannel = selectedChannel;\r\n  setMappedChannel();\r\n}\r\nexport function updateChannelSettings(key: keyof IChannelSettings, value: string) {\r\n  if (!channels_data.channel_settings) {\r\n    channels_data.channel_settings = {\r\n      hotel_id: '',\r\n      hotel_title: '',\r\n    };\r\n  }\r\n  channels_data.channel_settings[key] = value;\r\n}\r\nexport function setMappedChannel() {\r\n  let selectedChannelMap = channels_data.connected_channels.find(c => c.channel.id === channels_data.selectedChannel.id);\r\n  channels_data.mappedChannels = [...selectedChannelMap.map];\r\n}\r\nexport function resetStore() {\r\n  channels_data.selectedChannel = null;\r\n  channels_data.mappedChannels = [];\r\n  channels_data.isConnectedToChannel = false;\r\n  channels_data.channel_settings = null;\r\n}\r\nexport function addMapping(ir_id: string, fr_id: string) {\r\n  channels_data.mappedChannels.push({\r\n    channel_id: fr_id,\r\n    ir_id,\r\n  });\r\n}\r\nexport function removedMapping(ir_id: string) {\r\n  channels_data.mappedChannels = channels_data.mappedChannels.filter(c => c.ir_id !== ir_id);\r\n}\r\nexport function testConnection() {\r\n  const hotelConnection = channels_data.selectedChannel.properties.find(property => property.id === channels_data.channel_settings.hotel_id);\r\n  if (!hotelConnection) {\r\n    return;\r\n  }\r\n  channels_data.selectedChannel.property = hotelConnection;\r\n  channels_data.isConnectedToChannel = true;\r\n}\r\nexport default channels_data;\r\n"],"mappings":"oCAcA,MAAMA,EAA8B,CAClCC,SAAU,GACVC,gBAAiB,KACjBC,eAAgB,GAChBC,mBAAoB,GACpBC,qBAAsB,MACtBC,iBAAkB,M,MAELC,MAAOC,EAAeC,SAAUC,EAAeC,QAAEA,GAAYC,EAA2BZ,G,SACvFa,EAAcC,GAC5B,GAAIA,IAAe,GAAI,CACrBN,EAAcN,gBAAkB,KAChC,M,CAEF,MAAMA,EAAkBM,EAAcP,SAASc,MAAKC,GAAKA,EAAEC,GAAGC,aAAeJ,IAC7EN,EAAcN,gBAAkBA,EAChCiB,GACF,C,SACgBC,EAAsBC,EAA6BC,GACjE,IAAKd,EAAcF,iBAAkB,CACnCE,EAAcF,iBAAmB,CAC/BiB,SAAU,GACVC,YAAa,G,CAGjBhB,EAAcF,iBAAiBe,GAAOC,CACxC,C,SACgBH,IACd,IAAIM,EAAqBjB,EAAcJ,mBAAmBW,MAAKC,GAAKA,EAAEU,QAAQT,KAAOT,EAAcN,gBAAgBe,KACnHT,EAAcL,eAAiB,IAAIsB,EAAmBE,IACxD,C,SACgBC,IACdpB,EAAcN,gBAAkB,KAChCM,EAAcL,eAAiB,GAC/BK,EAAcH,qBAAuB,MACrCG,EAAcF,iBAAmB,IACnC,C,SACgBuB,EAAWC,EAAeC,GACxCvB,EAAcL,eAAe6B,KAAK,CAChClB,WAAYiB,EACZD,SAEJ,C,SACgBG,EAAeH,GAC7BtB,EAAcL,eAAiBK,EAAcL,eAAe+B,QAAOlB,GAAKA,EAAEc,QAAUA,GACtF,C,SACgBK,IACd,MAAMC,EAAkB5B,EAAcN,gBAAgBmC,WAAWtB,MAAKuB,GAAYA,EAASrB,KAAOT,EAAcF,iBAAiBiB,WACjI,IAAKa,EAAiB,CACpB,M,CAEF5B,EAAcN,gBAAgBoC,SAAWF,EACzC5B,EAAcH,qBAAuB,IACvC,Q"}